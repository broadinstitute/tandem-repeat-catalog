mkdir -p /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
mkdir -p /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
wget -O variant_catalog_without_offtargets.GRCh38.json.tmp -qnc https://raw.githubusercontent.com/broadinstitute/str-analysis/main/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json && mv variant_catalog_without_offtargets.GRCh38.json.tmp variant_catalog_without_offtargets.GRCh38.json
wget -O illumina_variant_catalog.sorted.bed.gz.tmp -qnc https://storage.googleapis.com/str-truth-set/hg38/ref/other/illumina_variant_catalog.sorted.bed.gz && mv illumina_variant_catalog.sorted.bed.gz.tmp illumina_variant_catalog.sorted.bed.gz
wget -O hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz.tmp -qnc https://storage.googleapis.com/str-truth-set/hg38/ref/other/colab-repeat-finder/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz && mv hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz.tmp hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
wget -O combined.51_samples.positive_loci.json.tmp -qnc https://storage.googleapis.com/str-truth-set-v2/filter_vcf/all_repeats_including_homopolymers_keeping_loci_that_have_overlapping_variants/combined/combined.51_samples.positive_loci.json && mv combined.51_samples.positive_loci.json.tmp combined.51_samples.positive_loci.json
python3 -m str_analysis.split_adjacent_loci_in_expansion_hunter_catalog /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.json
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.json
Split 9 loci into 19 output records
Wrote 83 total records to variant_catalog_without_offtargets.GRCh38.split.json
sed -i 's/AARRG/AAAAG/g' /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json
Wrote 63 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json

Filter stats:
        63 total input rows
        63 out of 63 (100%)  passed all filters
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json

Stats for variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json:
           63 total loci
        3,204 base pairs spanned by all loci (0.000% of the genome)
            0 out of         63 (  0.0%) loci define adjacent repeats
           63 total repeat intervals
           62 out of         63 ( 98.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of         63 (  0.0%) repeat intervals are homopolymers
            0 out of         63 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         63 ( 17.5%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 3-24bp
   Locus size range: 15-150bp
   Num repeats range: 2-50x repeats

   Maximum locus size = 150bp               @ chr13:102161574-102161724 (AAG)
   Minimum fraction pure bases = 0.59      @ chr8:118366812-118366918 (AAAAT)
   Minimum fraction pure repeats = 0.00    @ chr13:99985448-99985493 (GCN)

          chrX:          7 out of         63 ( 11.1%) repeat intervals
          chrY:          0 out of         63 (  0.0%) repeat intervals
          chrM:          0 out of         63 (  0.0%) repeat intervals
   alt contigs:          0 out of         63 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of         63 (  0.0%) repeat intervals
          2bp:          0 out of         63 (  0.0%) repeat intervals
          3bp:         46 out of         63 ( 73.0%) repeat intervals
          4bp:          1 out of         63 (  1.6%) repeat intervals
          5bp:         10 out of         63 ( 15.9%) repeat intervals
          6bp:          2 out of         63 (  3.2%) repeat intervals
       7-24bp:          4 out of         63 (  6.3%) repeat intervals
        25+bp:          0 out of         63 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of         63 (  0.0%) repeat intervals
           2x:          1 out of         63 (  1.6%) repeat intervals
           3x:          2 out of         63 (  3.2%) repeat intervals
           4x:          3 out of         63 (  4.8%) repeat intervals
           5x:          2 out of         63 (  3.2%) repeat intervals
           6x:          2 out of         63 (  3.2%) repeat intervals
           7x:          4 out of         63 (  6.3%) repeat intervals
           8x:          1 out of         63 (  1.6%) repeat intervals
           9x:          1 out of         63 (  1.6%) repeat intervals
       10-15x:         26 out of         63 ( 41.3%) repeat intervals
       16-25x:         17 out of         63 ( 27.0%) repeat intervals
       26-35x:          2 out of         63 (  3.2%) repeat intervals
       36-50x:          2 out of         63 (  3.2%) repeat intervals
         51+x:          0 out of         63 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         63 ( 17.5%) repeat intervals
          0.1:          0 out of         63 (  0.0%) repeat intervals
          0.2:          0 out of         63 (  0.0%) repeat intervals
          0.3:          0 out of         63 (  0.0%) repeat intervals
          0.4:          0 out of         63 (  0.0%) repeat intervals
          0.5:          1 out of         63 (  1.6%) repeat intervals
          0.6:          0 out of         63 (  0.0%) repeat intervals
          0.7:          1 out of         63 (  1.6%) repeat intervals
          0.8:          6 out of         63 (  9.5%) repeat intervals
          0.9:          8 out of         63 ( 12.7%) repeat intervals
          1.0:         36 out of         63 ( 57.1%) repeat intervals
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.catalog_stats.tsv
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
mkdir -p 1_to_1000bp
cd 1_to_1000bp
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Wrote 83 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        83 out of 83 (100%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
           83 total loci
        3,770 base pairs spanned by all loci (0.000% of the genome)
            0 out of         83 (  0.0%) loci define adjacent repeats
           83 total repeat intervals
           82 out of         83 ( 98.8%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            1 out of         83 (  1.2%) repeat intervals are homopolymers
            0 out of         83 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         83 ( 13.3%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 1-27bp
   Locus size range: 6-150bp
   Num repeats range: 1-50x repeats

   Maximum locus size = 150bp               @ chr13:102161574-102161724 (AAG)
   Minimum fraction pure bases = 0.59      @ chr8:118366812-118366918 (AAAAT)
   Minimum fraction pure repeats = 0.00    @ chr13:99985448-99985493 (GCN)

          chrX:         11 out of         83 ( 13.3%) repeat intervals
          chrY:          0 out of         83 (  0.0%) repeat intervals
          chrM:          0 out of         83 (  0.0%) repeat intervals
   alt contigs:          0 out of         83 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          1 out of         83 (  1.2%) repeat intervals
          2bp:          1 out of         83 (  1.2%) repeat intervals
          3bp:         60 out of         83 ( 72.3%) repeat intervals
          4bp:          2 out of         83 (  2.4%) repeat intervals
          5bp:         10 out of         83 ( 12.0%) repeat intervals
          6bp:          4 out of         83 (  4.8%) repeat intervals
       7-24bp:          4 out of         83 (  4.8%) repeat intervals
        25+bp:          1 out of         83 (  1.2%) repeat intervals

Num repeats in reference:
           1x:          1 out of         83 (  1.2%) repeat intervals
           2x:          3 out of         83 (  3.6%) repeat intervals
           3x:          3 out of         83 (  3.6%) repeat intervals
           4x:          4 out of         83 (  4.8%) repeat intervals
           5x:          2 out of         83 (  2.4%) repeat intervals
           6x:          2 out of         83 (  2.4%) repeat intervals
           7x:          5 out of         83 (  6.0%) repeat intervals
           8x:          5 out of         83 (  6.0%) repeat intervals
           9x:          2 out of         83 (  2.4%) repeat intervals
       10-15x:         31 out of         83 ( 37.3%) repeat intervals
       16-25x:         21 out of         83 ( 25.3%) repeat intervals
       26-35x:          2 out of         83 (  2.4%) repeat intervals
       36-50x:          2 out of         83 (  2.4%) repeat intervals
         51+x:          0 out of         83 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         83 ( 13.3%) repeat intervals
          0.1:          0 out of         83 (  0.0%) repeat intervals
          0.2:          0 out of         83 (  0.0%) repeat intervals
          0.3:          0 out of         83 (  0.0%) repeat intervals
          0.4:          0 out of         83 (  0.0%) repeat intervals
          0.5:          1 out of         83 (  1.2%) repeat intervals
          0.6:          0 out of         83 (  0.0%) repeat intervals
          0.7:          2 out of         83 (  2.4%) repeat intervals
          0.8:          8 out of         83 (  9.6%) repeat intervals
          0.9:          9 out of         83 ( 10.8%) repeat intervals
          1.0:         52 out of         83 ( 62.7%) repeat intervals
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 174,286 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   174,286 out of 174,286 (100%)  passed all filters

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
      174,286 total loci
    4,623,031 base pairs spanned by all loci (0.150% of the genome)
            0 out of    174,286 (  0.0%) loci define adjacent repeats
      174,286 total repeat intervals
      174,262 out of    174,286 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
          365 out of    174,286 (  0.2%) repeat intervals are homopolymers
            0 out of    174,286 (  0.0%) repeat intervals overlap each other by at least two motif lengths
            1 out of    174,286 (  0.0%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 1-24bp
   Locus size range: 4-532bp
   Num repeats range: 2-133x repeats

   Maximum locus size = 532bp               @ chr7:138621782-138622314 (TATC)
   Minimum fraction pure bases = 0.43      @ chr3:112804380-112804514 (TCT)
   Minimum fraction pure repeats = 0.00    @ chr4:41745972-41746032 (GCN)

          chrX:      8,561 out of    174,286 (  4.9%) repeat intervals
          chrY:          0 out of    174,286 (  0.0%) repeat intervals
          chrM:          0 out of    174,286 (  0.0%) repeat intervals
   alt contigs:          0 out of    174,286 (  0.0%) repeat intervals

Motif size distribution:
          1bp:        365 out of    174,286 (  0.2%) repeat intervals
          2bp:     98,531 out of    174,286 ( 56.5%) repeat intervals
          3bp:     14,442 out of    174,286 (  8.3%) repeat intervals
          4bp:     43,263 out of    174,286 ( 24.8%) repeat intervals
          5bp:     12,551 out of    174,286 (  7.2%) repeat intervals
          6bp:      3,931 out of    174,286 (  2.3%) repeat intervals
       7-24bp:      1,203 out of    174,286 (  0.7%) repeat intervals
        25+bp:          0 out of    174,286 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of    174,286 (  0.0%) repeat intervals
           2x:      8,780 out of    174,286 (  5.0%) repeat intervals
           3x:      6,543 out of    174,286 (  3.8%) repeat intervals
           4x:      8,882 out of    174,286 (  5.1%) repeat intervals
           5x:     11,884 out of    174,286 (  6.8%) repeat intervals
           6x:     13,900 out of    174,286 (  8.0%) repeat intervals
           7x:     14,915 out of    174,286 (  8.6%) repeat intervals
           8x:     13,902 out of    174,286 (  8.0%) repeat intervals
           9x:     12,532 out of    174,286 (  7.2%) repeat intervals
       10-15x:     49,952 out of    174,286 ( 28.7%) repeat intervals
       16-25x:     31,237 out of    174,286 ( 17.9%) repeat intervals
       26-35x:      1,729 out of    174,286 (  1.0%) repeat intervals
       36-50x:         24 out of    174,286 (  0.0%) repeat intervals
         51+x:          6 out of    174,286 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of    174,286 (  0.0%) repeat intervals
          0.1:          0 out of    174,286 (  0.0%) repeat intervals
          0.2:          0 out of    174,286 (  0.0%) repeat intervals
          0.3:          0 out of    174,286 (  0.0%) repeat intervals
          0.4:          0 out of    174,286 (  0.0%) repeat intervals
          0.5:          0 out of    174,286 (  0.0%) repeat intervals
          0.6:         25 out of    174,286 (  0.0%) repeat intervals
          0.7:        566 out of    174,286 (  0.3%) repeat intervals
          0.8:      4,113 out of    174,286 (  2.4%) repeat intervals
          0.9:      3,180 out of    174,286 (  1.8%) repeat intervals
          1.0:    166,401 out of    174,286 ( 95.5%) repeat intervals
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 4,558,281 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 4,558,281 out of 4,558,281 (100%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    4,558,281 total loci
   62,504,037 base pairs spanned by all loci (2.024% of the genome)
            0 out of  4,558,281 (  0.0%) loci define adjacent repeats
    4,558,281 total repeat intervals
    2,799,051 out of  4,558,281 ( 61.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,337,567 out of  4,558,281 ( 29.3%) repeat intervals are homopolymers
            0 out of  4,558,281 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-833bp
   Locus size range: 9-2523bp
   Num repeats range: 3-300x repeats

   Maximum locus size = 2523bp               @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases = 0.75      @ chr9:123405668-123405915 (TCCTGCCCACCCTTTGAGTTTCCAGGACAAGACAGGGAAGGGAAGCAGGCACACACTCCACT)
   Minimum fraction pure repeats = 1.00    @ chrY:56887882-56887891 (TGA)

          chrX:    232,977 out of  4,558,281 (  5.1%) repeat intervals
          chrY:     38,867 out of  4,558,281 (  0.9%) repeat intervals
          chrM:         14 out of  4,558,281 (  0.0%) repeat intervals
   alt contigs:          0 out of  4,558,281 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,337,567 out of  4,558,281 ( 29.3%) repeat intervals
          2bp:    967,389 out of  4,558,281 ( 21.2%) repeat intervals
          3bp:  1,418,341 out of  4,558,281 ( 31.1%) repeat intervals
          4bp:    569,907 out of  4,558,281 ( 12.5%) repeat intervals
          5bp:    172,187 out of  4,558,281 (  3.8%) repeat intervals
          6bp:     52,023 out of  4,558,281 (  1.1%) repeat intervals
       7-24bp:     31,185 out of  4,558,281 (  0.7%) repeat intervals
        25+bp:      9,682 out of  4,558,281 (  0.2%) repeat intervals

Num repeats in reference:
           1x:          0 out of  4,558,281 (  0.0%) repeat intervals
           2x:          0 out of  4,558,281 (  0.0%) repeat intervals
           3x:  1,787,359 out of  4,558,281 ( 39.2%) repeat intervals
           4x:    641,281 out of  4,558,281 ( 14.1%) repeat intervals
           5x:    353,723 out of  4,558,281 (  7.8%) repeat intervals
           6x:    148,753 out of  4,558,281 (  3.3%) repeat intervals
           7x:     76,841 out of  4,558,281 (  1.7%) repeat intervals
           8x:     43,343 out of  4,558,281 (  1.0%) repeat intervals
           9x:    352,151 out of  4,558,281 (  7.7%) repeat intervals
       10-15x:    756,034 out of  4,558,281 ( 16.6%) repeat intervals
       16-25x:    347,635 out of  4,558,281 (  7.6%) repeat intervals
       26-35x:     45,324 out of  4,558,281 (  1.0%) repeat intervals
       36-50x:      5,550 out of  4,558,281 (  0.1%) repeat intervals
         51+x:        287 out of  4,558,281 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.1:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.2:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.3:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.4:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.5:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.6:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.7:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.8:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.9:          0 out of  4,558,281 (  0.0%) repeat intervals
          1.0:  4,558,281 out of  4,558,281 (100.0%) repeat intervals
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Wrote 1,574,803 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz

Filter stats:
 1,575,395 total input rows
 1,574,803 out of 1,575,395 (100%)  passed all filters
       592 out of 1,575,395 ( 0%)  row reference sequence has invalid bases

Modification stats:
    19,510 out of 1,575,395 ( 1%)  replaced 4bp motif with a simplified 2bp motif
     1,944 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 2bp motif
       363 out of 1,575,395 ( 0%)  replaced 8bp motif with a simplified 4bp motif
       277 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        35 out of 1,575,395 ( 0%)  replaced 12bp motif with a simplified 4bp motif
        34 out of 1,575,395 ( 0%)  replaced 9bp motif with a simplified 3bp motif
        34 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 2bp motif
        22 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         3 out of 1,575,395 ( 0%)  replaced 15bp motif with a simplified 5bp motif
         2 out of 1,575,395 ( 0%)  replaced 14bp motif with a simplified 2bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz

Stats for combined.51_samples.positive_loci.filtered.json.gz:
    1,574,803 total loci
   29,774,853 base pairs spanned by all loci (0.964% of the genome)
            0 out of  1,574,803 (  0.0%) loci define adjacent repeats
    1,574,803 total repeat intervals
    1,574,803 out of  1,574,803 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,022,048 out of  1,574,803 ( 64.9%) repeat intervals are homopolymers
      131,935 out of  1,574,803 (  8.4%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr3:185665410-185665578, chr14:45045577-45045617, chr13:76612823-76612836, chr4:113894136-113894180, chr2:104046323-104046367, chr14:74972134-74972194, chr11:133140528-133140576, chr15:47940438-47940454, chr15:67515737-67515777, chr22:46373667-46373685

Ranges:
   Motif size range: 1-833bp
   Locus size range: 1-2499bp
   Num repeats range: 1-301x repeats

   Maximum locus size = 2499bp               @ chrX:71520430-71522929 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases = 0.68      @ chr13:18606767-18606827 (GAG)
   Minimum fraction pure repeats = 0.03    @ chr11:133140745-133140859 (GAG)

          chrX:     70,903 out of  1,574,803 (  4.5%) repeat intervals
          chrY:      4,806 out of  1,574,803 (  0.3%) repeat intervals
          chrM:          0 out of  1,574,803 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,574,803 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,022,048 out of  1,574,803 ( 64.9%) repeat intervals
          2bp:    263,734 out of  1,574,803 ( 16.7%) repeat intervals
          3bp:     65,064 out of  1,574,803 (  4.1%) repeat intervals
          4bp:    141,031 out of  1,574,803 (  9.0%) repeat intervals
          5bp:     34,944 out of  1,574,803 (  2.2%) repeat intervals
          6bp:     13,708 out of  1,574,803 (  0.9%) repeat intervals
       7-24bp:     23,451 out of  1,574,803 (  1.5%) repeat intervals
        25+bp:     10,823 out of  1,574,803 (  0.7%) repeat intervals

Num repeats in reference:
           1x:      9,177 out of  1,574,803 (  0.6%) repeat intervals
           2x:     29,413 out of  1,574,803 (  1.9%) repeat intervals
           3x:     65,534 out of  1,574,803 (  4.2%) repeat intervals
           4x:     52,829 out of  1,574,803 (  3.4%) repeat intervals
           5x:     59,962 out of  1,574,803 (  3.8%) repeat intervals
           6x:     52,271 out of  1,574,803 (  3.3%) repeat intervals
           7x:     44,541 out of  1,574,803 (  2.8%) repeat intervals
           8x:    101,003 out of  1,574,803 (  6.4%) repeat intervals
           9x:    133,773 out of  1,574,803 (  8.5%) repeat intervals
       10-15x:    595,761 out of  1,574,803 ( 37.8%) repeat intervals
       16-25x:    368,077 out of  1,574,803 ( 23.4%) repeat intervals
       26-35x:     53,865 out of  1,574,803 (  3.4%) repeat intervals
       36-50x:      7,882 out of  1,574,803 (  0.5%) repeat intervals
         51+x:        715 out of  1,574,803 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        190 out of  1,574,803 (  0.0%) repeat intervals
          0.1:      1,162 out of  1,574,803 (  0.1%) repeat intervals
          0.2:      1,900 out of  1,574,803 (  0.1%) repeat intervals
          0.3:      2,037 out of  1,574,803 (  0.1%) repeat intervals
          0.4:      1,547 out of  1,574,803 (  0.1%) repeat intervals
          0.5:      6,379 out of  1,574,803 (  0.4%) repeat intervals
          0.6:     12,689 out of  1,574,803 (  0.8%) repeat intervals
          0.7:      7,606 out of  1,574,803 (  0.5%) repeat intervals
          0.8:     13,668 out of  1,574,803 (  0.9%) repeat intervals
          0.9:     36,333 out of  1,574,803 (  2.3%) repeat intervals
          1.0:  1,491,292 out of  1,574,803 ( 94.7%) repeat intervals
Wrote 1 rows to combined.51_samples.positive_loci.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --merge-adjacent-loci-with-same-motif  --add-source-field  --output-format JSON  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
Added 83 out of 83 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 174,244 out of 174,286 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 174,244 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 4,391,201 out of 4,558,281 ( 96.3%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 4,391,201 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 135,470 out of 1,574,803 (  8.6%) records from combined.51_samples.positive_loci.filtered.json.gz to the output catalog
Wrote 135,470 unique loci from combined.51_samples.positive_loci.filtered.json.gz to combined.51_samples.positive_loci.filtered.unique_loci.bed.gz
Merged 77,619 out of 4,700,998 (  1.7%) adjacent loci that were within 1bp of each other and had the same motif after cyclic shift
Done writing 4,623,379 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged.json.gz
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged.json.gz
Wrote 4,623,360 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/combined.51_samples.positive_loci.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Parsed 3,147,421 variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Missing variation clusters for 1,475,969 out of 4,623,360 (31.9%) records from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Used 3,147,391 out of 3,147,421 (100.0%) of variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Wrote 4,623,360 out of 4,623,360 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Wrote 4,623,360 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Wrote 4,623,360 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.TRGT.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.bed.gz.tbi /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.TRGT.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.LongTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.HipSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.GangSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz

Stats for repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz:
    4,623,360 total loci
   64,363,319 base pairs spanned by all loci (2.084% of the genome)
            0 out of  4,623,360 (  0.0%) loci define adjacent repeats
    4,623,360 total repeat intervals
    3,005,968 out of  4,623,360 ( 65.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,395,502 out of  4,623,360 ( 30.2%) repeat intervals are homopolymers
       17,637 out of  4,623,360 (  0.4%) repeat intervals overlap each other by at least two motif lengths
           11 out of  4,623,360 (  0.0%) repeat intervals have non-ACGT motifs
Examples of overlapping repeats: chr4:10997247-10997259, chr17:54429149-54429165, chr7:75324911-75324935, chr10:34074010-34074030, chr1:17191894-17191906, chr6:1512741-1512765, chr14:28801139-28801165, chr6:12921458-12921494, chr6:144337148-144337191, chr1:207100053-207100097

Ranges:
   Motif size range: 1-833bp
   Locus size range: 1-2523bp
   Num repeats range: 1-300x repeats

   Maximum locus size = 2523bp               @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases = 0.17      @ chr8:49294435-49294500 (AGAT)
   Minimum fraction pure repeats = 0.00    @ chr4:41745972-41746032 (GCN)
   Minimum overall mappability = 0.00       @ chrY:56887882-56887891 (TGA)

          chrX:    234,392 out of  4,623,360 (  5.1%) repeat intervals
          chrY:     38,171 out of  4,623,360 (  0.8%) repeat intervals
          chrM:         14 out of  4,623,360 (  0.0%) repeat intervals
   alt contigs:          0 out of  4,623,360 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,395,502 out of  4,623,360 ( 30.2%) repeat intervals
          2bp:    939,879 out of  4,623,360 ( 20.3%) repeat intervals
          3bp:  1,421,178 out of  4,623,360 ( 30.7%) repeat intervals
          4bp:    578,904 out of  4,623,360 ( 12.5%) repeat intervals
          5bp:    175,107 out of  4,623,360 (  3.8%) repeat intervals
          6bp:     55,842 out of  4,623,360 (  1.2%) repeat intervals
       7-24bp:     42,231 out of  4,623,360 (  0.9%) repeat intervals
        25+bp:     14,717 out of  4,623,360 (  0.3%) repeat intervals

Num repeats in reference:
           1x:      7,236 out of  4,623,360 (  0.2%) repeat intervals
           2x:     33,399 out of  4,623,360 (  0.7%) repeat intervals
           3x:  1,775,953 out of  4,623,360 ( 38.4%) repeat intervals
           4x:    621,237 out of  4,623,360 ( 13.4%) repeat intervals
           5x:    332,203 out of  4,623,360 (  7.2%) repeat intervals
           6x:    140,297 out of  4,623,360 (  3.0%) repeat intervals
           7x:     78,379 out of  4,623,360 (  1.7%) repeat intervals
           8x:    108,624 out of  4,623,360 (  2.3%) repeat intervals
           9x:    346,452 out of  4,623,360 (  7.5%) repeat intervals
       10-15x:    756,349 out of  4,623,360 ( 16.4%) repeat intervals
       16-25x:    365,283 out of  4,623,360 (  7.9%) repeat intervals
       26-35x:     51,261 out of  4,623,360 (  1.1%) repeat intervals
       36-50x:      6,312 out of  4,623,360 (  0.1%) repeat intervals
         51+x:        375 out of  4,623,360 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        176 out of  4,623,360 (  0.0%) repeat intervals
          0.1:      1,020 out of  4,623,360 (  0.0%) repeat intervals
          0.2:      1,575 out of  4,623,360 (  0.0%) repeat intervals
          0.3:      1,515 out of  4,623,360 (  0.0%) repeat intervals
          0.4:        977 out of  4,623,360 (  0.0%) repeat intervals
          0.5:      4,769 out of  4,623,360 (  0.1%) repeat intervals
          0.6:      9,805 out of  4,623,360 (  0.2%) repeat intervals
          0.7:      3,718 out of  4,623,360 (  0.1%) repeat intervals
          0.8:     23,714 out of  4,623,360 (  0.5%) repeat intervals
          0.9:     54,214 out of  4,623,360 (  1.2%) repeat intervals
          1.0:  4,521,877 out of  4,623,360 ( 97.8%) repeat intervals

Mappability distribution:
          0.0:    134,451 out of  4,623,360 (  2.9%) loci
          0.1:    154,470 out of  4,623,360 (  3.3%) loci
          0.2:    189,922 out of  4,623,360 (  4.1%) loci
          0.3:    266,520 out of  4,623,360 (  5.8%) loci
          0.4:    399,582 out of  4,623,360 (  8.6%) loci
          0.5:    571,542 out of  4,623,360 ( 12.4%) loci
          0.6:    343,106 out of  4,623,360 (  7.4%) loci
          0.7:    308,318 out of  4,623,360 (  6.7%) loci
          0.8:    334,406 out of  4,623,360 (  7.2%) loci
          0.9:    646,363 out of  4,623,360 ( 14.0%) loci
          1.0:  1,274,680 out of  4,623,360 ( 27.6%) loci
Wrote 1 rows to repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp catalog. Took 1h, 44m, 40s
wget -O hg38_ver17.bed.gz.tmp -qnc https://s3.amazonaws.com/gangstr/hg38/genomewide/hg38_ver17.bed.gz && mv hg38_ver17.bed.gz.tmp hg38_ver17.bed.gz
python3 -u -m str_analysis.convert_gangstr_spec_to_expansion_hunter_variant_catalog --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.bed.gz -o /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.bed.gz
Writing records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.json.gz
Stats: {'total input loci': 1340266, 'trimmed locus': 1340266}
Wrote 1,340,266 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.json.gz
python3 -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --min-motif-size 1  --max-motif-size 1000  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz  --verbose  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.json.gz
   min_motif_size =               1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_motif =  False
   discard_loci_with_non_ACGT_bases_in_reference =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.json.gz
Wrote 1,340,266 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz

Filter stats:
 1,340,266 total input rows
 1,340,266 out of 1,340,266 (100%)  passed all filters
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz

Stats for hg38_ver17.filtered.json.gz:
    1,340,266 total loci
   22,952,364 base pairs spanned by all loci (0.743% of the genome)
            0 out of  1,340,266 (  0.0%) loci define adjacent repeats
    1,340,266 total repeat intervals
    1,340,266 out of  1,340,266 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
      488,668 out of  1,340,266 ( 36.5%) repeat intervals are homopolymers
           16 out of  1,340,266 (  0.0%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr5:123775552-123775596, chr9:27573528-27573546, chr7:84160224-84160276, chr2:1489652-1489684, chr11:2171085-2171113, chr2:1489650-1489682, chr15:96831014-96831039, chr11:2171087-2171115, chr15:96831011-96831036, chr5:123775555-123775599

Ranges:
   Motif size range: 1-20bp
   Locus size range: 10-612bp
   Num repeats range: 3-248x repeats

   Maximum locus size = 612bp               @ chr4:10134483-10135095 (ATCCCAATTGATGGAGA)
   Minimum fraction pure bases = 0.95      @ chr6:170561907-170562021 (CAG)
   Minimum fraction pure repeats = 0.84    @ chr6:170561907-170562021 (CAG)

          chrX:     65,719 out of  1,340,266 (  4.9%) repeat intervals
          chrY:      8,979 out of  1,340,266 (  0.7%) repeat intervals
          chrM:          0 out of  1,340,266 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,340,266 (  0.0%) repeat intervals

Motif size distribution:
          1bp:    488,668 out of  1,340,266 ( 36.5%) repeat intervals
          2bp:    179,518 out of  1,340,266 ( 13.4%) repeat intervals
          3bp:    150,463 out of  1,340,266 ( 11.2%) repeat intervals
          4bp:    377,644 out of  1,340,266 ( 28.2%) repeat intervals
          5bp:    106,135 out of  1,340,266 (  7.9%) repeat intervals
          6bp:     27,654 out of  1,340,266 (  2.1%) repeat intervals
       7-24bp:     10,184 out of  1,340,266 (  0.8%) repeat intervals
        25+bp:          0 out of  1,340,266 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of  1,340,266 (  0.0%) repeat intervals
           2x:          0 out of  1,340,266 (  0.0%) repeat intervals
           3x:    365,043 out of  1,340,266 ( 27.2%) repeat intervals
           4x:    178,164 out of  1,340,266 ( 13.3%) repeat intervals
           5x:     62,042 out of  1,340,266 (  4.6%) repeat intervals
           6x:     81,945 out of  1,340,266 (  6.1%) repeat intervals
           7x:     41,195 out of  1,340,266 (  3.1%) repeat intervals
           8x:     22,799 out of  1,340,266 (  1.7%) repeat intervals
           9x:     15,022 out of  1,340,266 (  1.1%) repeat intervals
       10-15x:    270,718 out of  1,340,266 ( 20.2%) repeat intervals
       16-25x:    260,685 out of  1,340,266 ( 19.5%) repeat intervals
       26-35x:     37,641 out of  1,340,266 (  2.8%) repeat intervals
       36-50x:      4,785 out of  1,340,266 (  0.4%) repeat intervals
         51+x:        227 out of  1,340,266 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.1:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.2:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.3:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.4:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.5:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.6:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.7:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.8:          1 out of  1,340,266 (  0.0%) repeat intervals
          0.9:          3 out of  1,340,266 (  0.0%) repeat intervals
          1.0:  1,340,262 out of  1,340,266 (100.0%) repeat intervals
Wrote 1 rows to hg38_ver17.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --verbose  --output-prefix GangSTR_v17  --write-bed-files-with-new-loci  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz
Added 4,623,360 out of 4,623,360 (100.0%) records from repeat_catalog_v1.hg38.1_to_1000bp.merged_and_annotated.json.gz to the output catalog
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/1_to_1000bp/hg38_ver17.filtered.json.gz
Added 0 out of 1,340,266 (  0.0%) records from hg38_ver17.filtered.json.gz to the output catalog
    Discarded 1,312,664 out of 1,340,266 ( 97.9%) records since they overlapped an exising locus by at least 66.0% and had the exact same LocusStructure
    Discarded  27,602 out of 1,340,266 (  2.1%) records since they overlapped an existing locus by at least 66.0% and had the same canonical motif
Wrote 0 unique loci from hg38_ver17.filtered.json.gz to hg38_ver17.filtered.unique_loci.bed.gz
Writing combined catalog to GangSTR_v17.json.gz
Done writing 4,623,360 output records to GangSTR_v17.json.gz
Writing combined catalog to GangSTR_v17.bed
Done writing 4,623,360 output records to GangSTR_v17.bed.gz
Motif sizes:
   1,421,178 out of 4,623,360 (30.7%) 3bp
   1,395,502 out of 4,623,360 (30.2%) 1bp
     939,879 out of 4,623,360 (20.3%) 2bp
     578,904 out of 4,623,360 (12.5%) 4bp
     175,107 out of 4,623,360 ( 3.8%) 5bp
      56,948 out of 4,623,360 ( 1.2%) 7+bp
      55,842 out of 4,623,360 ( 1.2%) 6bp
Chromsomes:
   4,350,783 out of 4,623,360 (94.1%) are on autosomes
     234,392 out of 4,623,360 ( 5.1%) are on X
      38,171 out of 4,623,360 ( 0.8%) are on Y
          14 out of 4,623,360 ( 0.0%) are on M
Done with comparisons. Took 0h, 29m, 48s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
mkdir -p 2_to_1000bp
cd 2_to_1000bp
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Wrote 82 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        82 out of 83 (99%)  passed all filters
         1 out of 83 ( 1%)  motif size(s) < 2
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
           82 total loci
        3,745 base pairs spanned by all loci (0.000% of the genome)
            0 out of         82 (  0.0%) loci define adjacent repeats
           82 total repeat intervals
           81 out of         82 ( 98.8%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of         82 (  0.0%) repeat intervals are homopolymers
            0 out of         82 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         82 ( 13.4%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-27bp
   Locus size range: 6-150bp
   Num repeats range: 1-50x repeats

   Maximum locus size = 150bp               @ chr13:102161574-102161724 (AAG)
   Minimum fraction pure bases = 0.59      @ chr8:118366812-118366918 (AAAAT)
   Minimum fraction pure repeats = 0.00    @ chr13:99985448-99985493 (GCN)

          chrX:         11 out of         82 ( 13.4%) repeat intervals
          chrY:          0 out of         82 (  0.0%) repeat intervals
          chrM:          0 out of         82 (  0.0%) repeat intervals
   alt contigs:          0 out of         82 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of         82 (  0.0%) repeat intervals
          2bp:          1 out of         82 (  1.2%) repeat intervals
          3bp:         60 out of         82 ( 73.2%) repeat intervals
          4bp:          2 out of         82 (  2.4%) repeat intervals
          5bp:         10 out of         82 ( 12.2%) repeat intervals
          6bp:          4 out of         82 (  4.9%) repeat intervals
       7-24bp:          4 out of         82 (  4.9%) repeat intervals
        25+bp:          1 out of         82 (  1.2%) repeat intervals

Num repeats in reference:
           1x:          1 out of         82 (  1.2%) repeat intervals
           2x:          3 out of         82 (  3.7%) repeat intervals
           3x:          3 out of         82 (  3.7%) repeat intervals
           4x:          4 out of         82 (  4.9%) repeat intervals
           5x:          2 out of         82 (  2.4%) repeat intervals
           6x:          2 out of         82 (  2.4%) repeat intervals
           7x:          5 out of         82 (  6.1%) repeat intervals
           8x:          5 out of         82 (  6.1%) repeat intervals
           9x:          2 out of         82 (  2.4%) repeat intervals
       10-15x:         31 out of         82 ( 37.8%) repeat intervals
       16-25x:         20 out of         82 ( 24.4%) repeat intervals
       26-35x:          2 out of         82 (  2.4%) repeat intervals
       36-50x:          2 out of         82 (  2.4%) repeat intervals
         51+x:          0 out of         82 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         82 ( 13.4%) repeat intervals
          0.1:          0 out of         82 (  0.0%) repeat intervals
          0.2:          0 out of         82 (  0.0%) repeat intervals
          0.3:          0 out of         82 (  0.0%) repeat intervals
          0.4:          0 out of         82 (  0.0%) repeat intervals
          0.5:          1 out of         82 (  1.2%) repeat intervals
          0.6:          0 out of         82 (  0.0%) repeat intervals
          0.7:          2 out of         82 (  2.4%) repeat intervals
          0.8:          8 out of         82 (  9.8%) repeat intervals
          0.9:          8 out of         82 (  9.8%) repeat intervals
          1.0:         52 out of         82 ( 63.4%) repeat intervals
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 173,921 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   173,921 out of 174,286 (100%)  passed all filters
       365 out of 174,286 ( 0%)  motif size(s) < 2

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
      173,921 total loci
    4,615,544 base pairs spanned by all loci (0.149% of the genome)
            0 out of    173,921 (  0.0%) loci define adjacent repeats
      173,921 total repeat intervals
      173,897 out of    173,921 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    173,921 (  0.0%) repeat intervals are homopolymers
            0 out of    173,921 (  0.0%) repeat intervals overlap each other by at least two motif lengths
            1 out of    173,921 (  0.0%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-24bp
   Locus size range: 4-532bp
   Num repeats range: 2-133x repeats

   Maximum locus size = 532bp               @ chr7:138621782-138622314 (TATC)
   Minimum fraction pure bases = 0.43      @ chr3:112804380-112804514 (TCT)
   Minimum fraction pure repeats = 0.00    @ chr4:41745972-41746032 (GCN)

          chrX:      8,555 out of    173,921 (  4.9%) repeat intervals
          chrY:          0 out of    173,921 (  0.0%) repeat intervals
          chrM:          0 out of    173,921 (  0.0%) repeat intervals
   alt contigs:          0 out of    173,921 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    173,921 (  0.0%) repeat intervals
          2bp:     98,531 out of    173,921 ( 56.7%) repeat intervals
          3bp:     14,442 out of    173,921 (  8.3%) repeat intervals
          4bp:     43,263 out of    173,921 ( 24.9%) repeat intervals
          5bp:     12,551 out of    173,921 (  7.2%) repeat intervals
          6bp:      3,931 out of    173,921 (  2.3%) repeat intervals
       7-24bp:      1,203 out of    173,921 (  0.7%) repeat intervals
        25+bp:          0 out of    173,921 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of    173,921 (  0.0%) repeat intervals
           2x:      8,780 out of    173,921 (  5.0%) repeat intervals
           3x:      6,543 out of    173,921 (  3.8%) repeat intervals
           4x:      8,878 out of    173,921 (  5.1%) repeat intervals
           5x:     11,884 out of    173,921 (  6.8%) repeat intervals
           6x:     13,897 out of    173,921 (  8.0%) repeat intervals
           7x:     14,915 out of    173,921 (  8.6%) repeat intervals
           8x:     13,898 out of    173,921 (  8.0%) repeat intervals
           9x:     12,532 out of    173,921 (  7.2%) repeat intervals
       10-15x:     49,892 out of    173,921 ( 28.7%) repeat intervals
       16-25x:     31,022 out of    173,921 ( 17.8%) repeat intervals
       26-35x:      1,651 out of    173,921 (  0.9%) repeat intervals
       36-50x:         23 out of    173,921 (  0.0%) repeat intervals
         51+x:          6 out of    173,921 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of    173,921 (  0.0%) repeat intervals
          0.1:          0 out of    173,921 (  0.0%) repeat intervals
          0.2:          0 out of    173,921 (  0.0%) repeat intervals
          0.3:          0 out of    173,921 (  0.0%) repeat intervals
          0.4:          0 out of    173,921 (  0.0%) repeat intervals
          0.5:          0 out of    173,921 (  0.0%) repeat intervals
          0.6:         25 out of    173,921 (  0.0%) repeat intervals
          0.7:        566 out of    173,921 (  0.3%) repeat intervals
          0.8:      4,113 out of    173,921 (  2.4%) repeat intervals
          0.9:      3,179 out of    173,921 (  1.8%) repeat intervals
          1.0:    166,037 out of    173,921 ( 95.5%) repeat intervals
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 3,220,714 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 3,220,714 out of 4,558,281 (71%)  passed all filters
 1,337,567 out of 4,558,281 (29%)  motif size(s) < 2
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    3,220,714 total loci
   44,504,438 base pairs spanned by all loci (1.441% of the genome)
            0 out of  3,220,714 (  0.0%) loci define adjacent repeats
    3,220,714 total repeat intervals
    1,461,484 out of  3,220,714 ( 45.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,220,714 (  0.0%) repeat intervals are homopolymers
            0 out of  3,220,714 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 2-833bp
   Locus size range: 9-2523bp
   Num repeats range: 3-300x repeats

   Maximum locus size = 2523bp               @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases = 0.75      @ chr9:123405668-123405915 (TCCTGCCCACCCTTTGAGTTTCCAGGACAAGACAGGGAAGGGAAGCAGGCACACACTCCACT)
   Minimum fraction pure repeats = 1.00    @ chrY:56887882-56887891 (TGA)

          chrX:    168,815 out of  3,220,714 (  5.2%) repeat intervals
          chrY:     29,829 out of  3,220,714 (  0.9%) repeat intervals
          chrM:         14 out of  3,220,714 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,220,714 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,220,714 (  0.0%) repeat intervals
          2bp:    967,389 out of  3,220,714 ( 30.0%) repeat intervals
          3bp:  1,418,341 out of  3,220,714 ( 44.0%) repeat intervals
          4bp:    569,907 out of  3,220,714 ( 17.7%) repeat intervals
          5bp:    172,187 out of  3,220,714 (  5.3%) repeat intervals
          6bp:     52,023 out of  3,220,714 (  1.6%) repeat intervals
       7-24bp:     31,185 out of  3,220,714 (  1.0%) repeat intervals
        25+bp:      9,682 out of  3,220,714 (  0.3%) repeat intervals

Num repeats in reference:
           1x:          0 out of  3,220,714 (  0.0%) repeat intervals
           2x:          0 out of  3,220,714 (  0.0%) repeat intervals
           3x:  1,787,359 out of  3,220,714 ( 55.5%) repeat intervals
           4x:    641,281 out of  3,220,714 ( 19.9%) repeat intervals
           5x:    353,723 out of  3,220,714 ( 11.0%) repeat intervals
           6x:    148,753 out of  3,220,714 (  4.6%) repeat intervals
           7x:     76,841 out of  3,220,714 (  2.4%) repeat intervals
           8x:     43,343 out of  3,220,714 (  1.3%) repeat intervals
           9x:     28,678 out of  3,220,714 (  0.9%) repeat intervals
       10-15x:     88,663 out of  3,220,714 (  2.8%) repeat intervals
       16-25x:     48,612 out of  3,220,714 (  1.5%) repeat intervals
       26-35x:      3,317 out of  3,220,714 (  0.1%) repeat intervals
       36-50x:        105 out of  3,220,714 (  0.0%) repeat intervals
         51+x:         39 out of  3,220,714 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.1:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.2:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.3:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.4:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.5:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.6:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.7:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.8:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.9:          0 out of  3,220,714 (  0.0%) repeat intervals
          1.0:  3,220,714 out of  3,220,714 (100.0%) repeat intervals
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Wrote 552,755 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz

Filter stats:
 1,575,395 total input rows
 1,022,431 out of 1,575,395 (65%)  motif size(s) < 2
   552,755 out of 1,575,395 (35%)  passed all filters
       209 out of 1,575,395 ( 0%)  row reference sequence has invalid bases

Modification stats:
    19,510 out of 1,575,395 ( 1%)  replaced 4bp motif with a simplified 2bp motif
     1,944 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 2bp motif
       363 out of 1,575,395 ( 0%)  replaced 8bp motif with a simplified 4bp motif
       277 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        35 out of 1,575,395 ( 0%)  replaced 12bp motif with a simplified 4bp motif
        34 out of 1,575,395 ( 0%)  replaced 9bp motif with a simplified 3bp motif
        34 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 2bp motif
        22 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         3 out of 1,575,395 ( 0%)  replaced 15bp motif with a simplified 5bp motif
         2 out of 1,575,395 ( 0%)  replaced 14bp motif with a simplified 2bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz

Stats for combined.51_samples.positive_loci.filtered.json.gz:
      552,755 total loci
   14,975,667 base pairs spanned by all loci (0.485% of the genome)
            0 out of    552,755 (  0.0%) loci define adjacent repeats
      552,755 total repeat intervals
      552,755 out of    552,755 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    552,755 (  0.0%) repeat intervals are homopolymers
      118,307 out of    552,755 ( 21.4%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chrX:143576443-143576475, chr22:49126210-49126256, chr18:48103114-48103158, chr5:134780098-134780138, chr15:53873923-53873971, chr5:88514465-88514469, chr7:72487890-72487918, chrX:144922980-144922994, chr10:60756905-60756937, chr2:47365478-47365534

Ranges:
   Motif size range: 2-833bp
   Locus size range: 2-2499bp
   Num repeats range: 1-301x repeats

   Maximum locus size = 2499bp               @ chrX:71520430-71522929 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases = 0.68      @ chr13:18606767-18606827 (GAG)
   Minimum fraction pure repeats = 0.03    @ chr11:133140745-133140859 (GAG)

          chrX:     26,191 out of    552,755 (  4.7%) repeat intervals
          chrY:      1,843 out of    552,755 (  0.3%) repeat intervals
          chrM:          0 out of    552,755 (  0.0%) repeat intervals
   alt contigs:          0 out of    552,755 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    552,755 (  0.0%) repeat intervals
          2bp:    263,734 out of    552,755 ( 47.7%) repeat intervals
          3bp:     65,064 out of    552,755 ( 11.8%) repeat intervals
          4bp:    141,031 out of    552,755 ( 25.5%) repeat intervals
          5bp:     34,944 out of    552,755 (  6.3%) repeat intervals
          6bp:     13,708 out of    552,755 (  2.5%) repeat intervals
       7-24bp:     23,451 out of    552,755 (  4.2%) repeat intervals
        25+bp:     10,823 out of    552,755 (  2.0%) repeat intervals

Num repeats in reference:
           1x:      7,707 out of    552,755 (  1.4%) repeat intervals
           2x:     28,914 out of    552,755 (  5.2%) repeat intervals
           3x:     64,921 out of    552,755 ( 11.7%) repeat intervals
           4x:     52,047 out of    552,755 (  9.4%) repeat intervals
           5x:     58,908 out of    552,755 ( 10.7%) repeat intervals
           6x:     50,755 out of    552,755 (  9.2%) repeat intervals
           7x:     40,425 out of    552,755 (  7.3%) repeat intervals
           8x:     33,814 out of    552,755 (  6.1%) repeat intervals
           9x:     26,727 out of    552,755 (  4.8%) repeat intervals
       10-15x:    105,375 out of    552,755 ( 19.1%) repeat intervals
       16-25x:     72,521 out of    552,755 ( 13.1%) repeat intervals
       26-35x:      9,245 out of    552,755 (  1.7%) repeat intervals
       36-50x:      1,047 out of    552,755 (  0.2%) repeat intervals
         51+x:        349 out of    552,755 (  0.1%) repeat intervals

Fraction pure bases distribution:
          0.0:        190 out of    552,755 (  0.0%) repeat intervals
          0.1:      1,162 out of    552,755 (  0.2%) repeat intervals
          0.2:      1,900 out of    552,755 (  0.3%) repeat intervals
          0.3:      2,037 out of    552,755 (  0.4%) repeat intervals
          0.4:      1,547 out of    552,755 (  0.3%) repeat intervals
          0.5:      6,379 out of    552,755 (  1.2%) repeat intervals
          0.6:     12,689 out of    552,755 (  2.3%) repeat intervals
          0.7:      7,606 out of    552,755 (  1.4%) repeat intervals
          0.8:     13,668 out of    552,755 (  2.5%) repeat intervals
          0.9:     28,968 out of    552,755 (  5.2%) repeat intervals
          1.0:    476,609 out of    552,755 ( 86.2%) repeat intervals
Wrote 1 rows to combined.51_samples.positive_loci.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --merge-adjacent-loci-with-same-motif  --add-source-field  --output-format JSON  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
Added 82 out of 82 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 173,879 out of 173,921 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 173,879 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 3,053,992 out of 3,220,714 ( 94.8%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 3,053,992 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 58,119 out of 552,755 ( 10.5%) records from combined.51_samples.positive_loci.filtered.json.gz to the output catalog
Wrote 58,119 unique loci from combined.51_samples.positive_loci.filtered.json.gz to combined.51_samples.positive_loci.filtered.unique_loci.bed.gz
Merged 58,226 out of 3,286,072 (  1.8%) adjacent loci that were within 1bp of each other and had the same motif after cyclic shift
Done writing 3,227,846 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged.json.gz
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged.json.gz
Wrote 3,227,828 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/combined.51_samples.positive_loci.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Parsed 3,147,421 variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Missing variation clusters for 80,407 out of 3,227,828 (2.5%) records from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Used 3,147,421 out of 3,147,421 (100.0%) of variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Wrote 3,227,828 out of 3,227,828 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Wrote 3,227,828 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Wrote 3,227,828 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.TRGT.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.bed.gz.tbi /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.TRGT.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.LongTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.HipSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.GangSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz

Stats for repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.json.gz:
    3,227,828 total loci
   45,754,784 base pairs spanned by all loci (1.482% of the genome)
            0 out of  3,227,828 (  0.0%) loci define adjacent repeats
    3,227,828 total repeat intervals
    1,610,453 out of  3,227,828 ( 49.9%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,227,828 (  0.0%) repeat intervals are homopolymers
       17,061 out of  3,227,828 (  0.5%) repeat intervals overlap each other by at least two motif lengths
           11 out of  3,227,828 (  0.0%) repeat intervals have non-ACGT motifs
Examples of overlapping repeats: chr19:17410555-17410586, chr14:32482987-32483015, chr16:82267665-82267727, chr19:15050309-15050322, chrX:112310595-112310626, chr2:861135-861248, chr6:155047706-155047745, chr6:87323266-87323286, chr13:80981294-80981307, chr9:86368590-86368609

Ranges:
   Motif size range: 2-833bp
   Locus size range: 2-2523bp
   Num repeats range: 1-300x repeats

   Maximum locus size = 2523bp               @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases = 0.17      @ chr8:49294435-49294500 (AGAT)
   Minimum fraction pure repeats = 0.00    @ chr4:41745972-41746032 (GCN)
   Minimum overall mappability = 0.00       @ chrY:56887882-56887891 (TGA)

          chrX:    167,667 out of  3,227,828 (  5.2%) repeat intervals
          chrY:     29,107 out of  3,227,828 (  0.9%) repeat intervals
          chrM:         14 out of  3,227,828 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,227,828 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,227,828 (  0.0%) repeat intervals
          2bp:    939,869 out of  3,227,828 ( 29.1%) repeat intervals
          3bp:  1,421,176 out of  3,227,828 ( 44.0%) repeat intervals
          4bp:    578,898 out of  3,227,828 ( 17.9%) repeat intervals
          5bp:    175,096 out of  3,227,828 (  5.4%) repeat intervals
          6bp:     55,842 out of  3,227,828 (  1.7%) repeat intervals
       7-24bp:     42,231 out of  3,227,828 (  1.3%) repeat intervals
        25+bp:     14,716 out of  3,227,828 (  0.5%) repeat intervals

Num repeats in reference:
           1x:      6,840 out of  3,227,828 (  0.2%) repeat intervals
           2x:     33,264 out of  3,227,828 (  1.0%) repeat intervals
           3x:  1,775,635 out of  3,227,828 ( 55.0%) repeat intervals
           4x:    620,843 out of  3,227,828 ( 19.2%) repeat intervals
           5x:    331,430 out of  3,227,828 ( 10.3%) repeat intervals
           6x:    139,178 out of  3,227,828 (  4.3%) repeat intervals
           7x:     74,654 out of  3,227,828 (  2.3%) repeat intervals
           8x:     43,180 out of  3,227,828 (  1.3%) repeat intervals
           9x:     31,615 out of  3,227,828 (  1.0%) repeat intervals
       10-15x:    108,397 out of  3,227,828 (  3.4%) repeat intervals
       16-25x:     57,478 out of  3,227,828 (  1.8%) repeat intervals
       26-35x:      4,839 out of  3,227,828 (  0.1%) repeat intervals
       36-50x:        362 out of  3,227,828 (  0.0%) repeat intervals
         51+x:        113 out of  3,227,828 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        176 out of  3,227,828 (  0.0%) repeat intervals
          0.1:      1,020 out of  3,227,828 (  0.0%) repeat intervals
          0.2:      1,575 out of  3,227,828 (  0.0%) repeat intervals
          0.3:      1,515 out of  3,227,828 (  0.0%) repeat intervals
          0.4:        977 out of  3,227,828 (  0.0%) repeat intervals
          0.5:      4,746 out of  3,227,828 (  0.1%) repeat intervals
          0.6:      9,714 out of  3,227,828 (  0.3%) repeat intervals
          0.7:      3,706 out of  3,227,828 (  0.1%) repeat intervals
          0.8:     23,602 out of  3,227,828 (  0.7%) repeat intervals
          0.9:     35,956 out of  3,227,828 (  1.1%) repeat intervals
          1.0:  3,144,841 out of  3,227,828 ( 97.4%) repeat intervals

Mappability distribution:
          0.0:    102,868 out of  3,227,828 (  3.2%) loci
          0.1:     99,509 out of  3,227,828 (  3.1%) loci
          0.2:    121,832 out of  3,227,828 (  3.8%) loci
          0.3:    175,517 out of  3,227,828 (  5.4%) loci
          0.4:    230,667 out of  3,227,828 (  7.1%) loci
          0.5:    309,570 out of  3,227,828 (  9.6%) loci
          0.6:    227,112 out of  3,227,828 (  7.0%) loci
          0.7:    222,580 out of  3,227,828 (  6.9%) loci
          0.8:    258,585 out of  3,227,828 (  8.0%) loci
          0.9:    513,917 out of  3,227,828 ( 15.9%) loci
          1.0:    965,671 out of  3,227,828 ( 29.9%) loci
Wrote 1 rows to repeat_catalog_v1.hg38.2_to_1000bp.merged_and_annotated.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_1000bp/repeat_catalog_v1.hg38.2_to_1000bp catalog. Took 2h, 26m, 43s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
mkdir -p homopolymers
cd homopolymers
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Wrote 1 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        82 out of 83 (99%)  motif size(s) > 1
         1 out of 83 ( 1%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
            1 total loci
           25 base pairs spanned by all loci (0.000% of the genome)
            0 out of          1 (  0.0%) loci define adjacent repeats
            1 total repeat intervals
            1 out of          1 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            1 out of          1 (100.0%) repeat intervals are homopolymers
            0 out of          1 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 25-25bp
   Num repeats range: 25-25x repeats

   Maximum locus size = 25bp               @ chr9:69037261-69037286 (A)
   Minimum fraction pure bases = 0.92      @ chr9:69037261-69037286 (A)
   Minimum fraction pure repeats = 0.92    @ chr9:69037261-69037286 (A)

          chrX:          0 out of          1 (  0.0%) repeat intervals
          chrY:          0 out of          1 (  0.0%) repeat intervals
          chrM:          0 out of          1 (  0.0%) repeat intervals
   alt contigs:          0 out of          1 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          1 out of          1 (100.0%) repeat intervals
          2bp:          0 out of          1 (  0.0%) repeat intervals
          3bp:          0 out of          1 (  0.0%) repeat intervals
          4bp:          0 out of          1 (  0.0%) repeat intervals
          5bp:          0 out of          1 (  0.0%) repeat intervals
          6bp:          0 out of          1 (  0.0%) repeat intervals
       7-24bp:          0 out of          1 (  0.0%) repeat intervals
        25+bp:          0 out of          1 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of          1 (  0.0%) repeat intervals
           2x:          0 out of          1 (  0.0%) repeat intervals
           3x:          0 out of          1 (  0.0%) repeat intervals
           4x:          0 out of          1 (  0.0%) repeat intervals
           5x:          0 out of          1 (  0.0%) repeat intervals
           6x:          0 out of          1 (  0.0%) repeat intervals
           7x:          0 out of          1 (  0.0%) repeat intervals
           8x:          0 out of          1 (  0.0%) repeat intervals
           9x:          0 out of          1 (  0.0%) repeat intervals
       10-15x:          0 out of          1 (  0.0%) repeat intervals
       16-25x:          1 out of          1 (100.0%) repeat intervals
       26-35x:          0 out of          1 (  0.0%) repeat intervals
       36-50x:          0 out of          1 (  0.0%) repeat intervals
         51+x:          0 out of          1 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of          1 (  0.0%) repeat intervals
          0.1:          0 out of          1 (  0.0%) repeat intervals
          0.2:          0 out of          1 (  0.0%) repeat intervals
          0.3:          0 out of          1 (  0.0%) repeat intervals
          0.4:          0 out of          1 (  0.0%) repeat intervals
          0.5:          0 out of          1 (  0.0%) repeat intervals
          0.6:          0 out of          1 (  0.0%) repeat intervals
          0.7:          0 out of          1 (  0.0%) repeat intervals
          0.8:          0 out of          1 (  0.0%) repeat intervals
          0.9:          1 out of          1 (100.0%) repeat intervals
          1.0:          0 out of          1 (  0.0%) repeat intervals
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 365 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   173,921 out of 174,286 (100%)  motif size(s) > 1
       365 out of 174,286 ( 0%)  passed all filters

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
          365 total loci
        7,487 base pairs spanned by all loci (0.000% of the genome)
            0 out of        365 (  0.0%) loci define adjacent repeats
          365 total repeat intervals
          365 out of        365 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
          365 out of        365 (100.0%) repeat intervals are homopolymers
            0 out of        365 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 4-36bp
   Num repeats range: 4-36x repeats

   Maximum locus size = 36bp               @ chr7:11459665-11459701 (T)
   Minimum fraction pure bases = 0.97      @ chr2:132591257-132591287 (A)
   Minimum fraction pure repeats = 0.97    @ chr2:132591257-132591287 (A)

          chrX:          6 out of        365 (  1.6%) repeat intervals
          chrY:          0 out of        365 (  0.0%) repeat intervals
          chrM:          0 out of        365 (  0.0%) repeat intervals
   alt contigs:          0 out of        365 (  0.0%) repeat intervals

Motif size distribution:
          1bp:        365 out of        365 (100.0%) repeat intervals
          2bp:          0 out of        365 (  0.0%) repeat intervals
          3bp:          0 out of        365 (  0.0%) repeat intervals
          4bp:          0 out of        365 (  0.0%) repeat intervals
          5bp:          0 out of        365 (  0.0%) repeat intervals
          6bp:          0 out of        365 (  0.0%) repeat intervals
       7-24bp:          0 out of        365 (  0.0%) repeat intervals
        25+bp:          0 out of        365 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of        365 (  0.0%) repeat intervals
           2x:          0 out of        365 (  0.0%) repeat intervals
           3x:          0 out of        365 (  0.0%) repeat intervals
           4x:          4 out of        365 (  1.1%) repeat intervals
           5x:          0 out of        365 (  0.0%) repeat intervals
           6x:          3 out of        365 (  0.8%) repeat intervals
           7x:          0 out of        365 (  0.0%) repeat intervals
           8x:          4 out of        365 (  1.1%) repeat intervals
           9x:          0 out of        365 (  0.0%) repeat intervals
       10-15x:         60 out of        365 ( 16.4%) repeat intervals
       16-25x:        215 out of        365 ( 58.9%) repeat intervals
       26-35x:         78 out of        365 ( 21.4%) repeat intervals
       36-50x:          1 out of        365 (  0.3%) repeat intervals
         51+x:          0 out of        365 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of        365 (  0.0%) repeat intervals
          0.1:          0 out of        365 (  0.0%) repeat intervals
          0.2:          0 out of        365 (  0.0%) repeat intervals
          0.3:          0 out of        365 (  0.0%) repeat intervals
          0.4:          0 out of        365 (  0.0%) repeat intervals
          0.5:          0 out of        365 (  0.0%) repeat intervals
          0.6:          0 out of        365 (  0.0%) repeat intervals
          0.7:          0 out of        365 (  0.0%) repeat intervals
          0.8:          0 out of        365 (  0.0%) repeat intervals
          0.9:          1 out of        365 (  0.3%) repeat intervals
          1.0:        364 out of        365 ( 99.7%) repeat intervals
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 1,337,567 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 3,220,714 out of 4,558,281 (71%)  motif size(s) > 1
 1,337,567 out of 4,558,281 (29%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    1,337,567 total loci
   17,999,599 base pairs spanned by all loci (0.583% of the genome)
            0 out of  1,337,567 (  0.0%) loci define adjacent repeats
    1,337,567 total repeat intervals
    1,337,567 out of  1,337,567 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,337,567 out of  1,337,567 (100.0%) repeat intervals are homopolymers
            0 out of  1,337,567 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 9-90bp
   Num repeats range: 9-90x repeats

   Maximum locus size =    90bp             @ chr12:66057592-66057682 (T)
   Minimum fraction pure bases =  1.00      @ chrY:56886790-56886799 (T)
   Minimum fraction pure repeats =  1.00    @ chrY:56886790-56886799 (T)

          chrX:     64,162 out of  1,337,567 (  4.8%) repeat intervals
          chrY:      9,038 out of  1,337,567 (  0.7%) repeat intervals
          chrM:          0 out of  1,337,567 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,337,567 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,337,567 out of  1,337,567 (100.0%) repeat intervals
          2bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          3bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          4bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          5bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          6bp:          0 out of  1,337,567 (  0.0%) repeat intervals
       7-24bp:          0 out of  1,337,567 (  0.0%) repeat intervals
        25+bp:          0 out of  1,337,567 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of  1,337,567 (  0.0%) repeat intervals
           2x:          0 out of  1,337,567 (  0.0%) repeat intervals
           3x:          0 out of  1,337,567 (  0.0%) repeat intervals
           4x:          0 out of  1,337,567 (  0.0%) repeat intervals
           5x:          0 out of  1,337,567 (  0.0%) repeat intervals
           6x:          0 out of  1,337,567 (  0.0%) repeat intervals
           7x:          0 out of  1,337,567 (  0.0%) repeat intervals
           8x:          0 out of  1,337,567 (  0.0%) repeat intervals
           9x:    323,473 out of  1,337,567 ( 24.2%) repeat intervals
       10-15x:    667,371 out of  1,337,567 ( 49.9%) repeat intervals
       16-25x:    299,023 out of  1,337,567 ( 22.4%) repeat intervals
       26-35x:     42,007 out of  1,337,567 (  3.1%) repeat intervals
       36-50x:      5,445 out of  1,337,567 (  0.4%) repeat intervals
         51+x:        248 out of  1,337,567 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.1:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.2:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.3:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.4:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.5:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.6:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.7:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.8:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.9:          0 out of  1,337,567 (  0.0%) repeat intervals
          1.0:  1,337,567 out of  1,337,567 (100.0%) repeat intervals
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/combined.51_samples.positive_loci.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/combined.51_samples.positive_loci.filtered.json.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Wrote 1,022,048 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/combined.51_samples.positive_loci.filtered.json.gz

Filter stats:
 1,575,395 total input rows
 1,022,048 out of 1,575,395 (65%)  passed all filters
   552,964 out of 1,575,395 (35%)  motif size(s) > 1
       383 out of 1,575,395 ( 0%)  row reference sequence has invalid bases

Modification stats:
    19,510 out of 1,575,395 ( 1%)  replaced 4bp motif with a simplified 2bp motif
     1,944 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 2bp motif
       363 out of 1,575,395 ( 0%)  replaced 8bp motif with a simplified 4bp motif
       277 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        35 out of 1,575,395 ( 0%)  replaced 12bp motif with a simplified 4bp motif
        34 out of 1,575,395 ( 0%)  replaced 9bp motif with a simplified 3bp motif
        34 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 2bp motif
        22 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         3 out of 1,575,395 ( 0%)  replaced 15bp motif with a simplified 5bp motif
         2 out of 1,575,395 ( 0%)  replaced 14bp motif with a simplified 2bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/combined.51_samples.positive_loci.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/combined.51_samples.positive_loci.filtered.json.gz

Stats for combined.51_samples.positive_loci.filtered.json.gz:
    1,022,048 total loci
   14,799,186 base pairs spanned by all loci (0.479% of the genome)
            0 out of  1,022,048 (  0.0%) loci define adjacent repeats
    1,022,048 total repeat intervals
    1,022,048 out of  1,022,048 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,022,048 out of  1,022,048 (100.0%) repeat intervals are homopolymers
       13,584 out of  1,022,048 (  1.3%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr12:113642329-113642347, chr13:65949854-65949875, chr6:31274092-31274132, chr14:56976611-56976625, chr16:83646692-83646715, chr4:185375455-185375490, chr3:195300034-195300064, chr1:78623389-78623426, chr1:11036538-11036548, chr11:40495813-40495849

Ranges:
   Motif size range: 1-1bp
   Locus size range: 1-90bp
   Num repeats range: 1-90x repeats

   Maximum locus size =    90bp             @ chr12:66057592-66057682 (T)
   Minimum fraction pure bases =  0.90      @ chr10:74595392-74595402 (G)
   Minimum fraction pure repeats =  0.90    @ chr10:74595392-74595402 (G)

          chrX:     44,712 out of  1,022,048 (  4.4%) repeat intervals
          chrY:      2,963 out of  1,022,048 (  0.3%) repeat intervals
          chrM:          0 out of  1,022,048 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,022,048 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,022,048 out of  1,022,048 (100.0%) repeat intervals
          2bp:          0 out of  1,022,048 (  0.0%) repeat intervals
          3bp:          0 out of  1,022,048 (  0.0%) repeat intervals
          4bp:          0 out of  1,022,048 (  0.0%) repeat intervals
          5bp:          0 out of  1,022,048 (  0.0%) repeat intervals
          6bp:          0 out of  1,022,048 (  0.0%) repeat intervals
       7-24bp:          0 out of  1,022,048 (  0.0%) repeat intervals
        25+bp:          0 out of  1,022,048 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      1,470 out of  1,022,048 (  0.1%) repeat intervals
           2x:        499 out of  1,022,048 (  0.0%) repeat intervals
           3x:        613 out of  1,022,048 (  0.1%) repeat intervals
           4x:        782 out of  1,022,048 (  0.1%) repeat intervals
           5x:      1,054 out of  1,022,048 (  0.1%) repeat intervals
           6x:      1,516 out of  1,022,048 (  0.1%) repeat intervals
           7x:      4,116 out of  1,022,048 (  0.4%) repeat intervals
           8x:     67,189 out of  1,022,048 (  6.6%) repeat intervals
           9x:    107,046 out of  1,022,048 ( 10.5%) repeat intervals
       10-15x:    490,386 out of  1,022,048 ( 48.0%) repeat intervals
       16-25x:    295,556 out of  1,022,048 ( 28.9%) repeat intervals
       26-35x:     44,620 out of  1,022,048 (  4.4%) repeat intervals
       36-50x:      6,835 out of  1,022,048 (  0.7%) repeat intervals
         51+x:        366 out of  1,022,048 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.1:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.2:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.3:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.4:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.5:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.6:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.7:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.8:          0 out of  1,022,048 (  0.0%) repeat intervals
          0.9:      7,365 out of  1,022,048 (  0.7%) repeat intervals
          1.0:  1,014,683 out of  1,022,048 ( 99.3%) repeat intervals
Wrote 1 rows to combined.51_samples.positive_loci.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --merge-adjacent-loci-with-same-motif  --add-source-field  --output-format JSON  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/combined.51_samples.positive_loci.filtered.json.gz
Added 1 out of 1 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 365 out of 365 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 365 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 1,337,209 out of 1,337,567 (100.0%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 1,337,209 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 77,351 out of 1,022,048 (  7.6%) records from combined.51_samples.positive_loci.filtered.json.gz to the output catalog
Wrote 77,351 unique loci from combined.51_samples.positive_loci.filtered.json.gz to combined.51_samples.positive_loci.filtered.unique_loci.bed.gz
Merged 19,574 out of 1,414,926 (  1.4%) adjacent loci that were within 1bp of each other and had the same motif after cyclic shift
Done writing 1,395,352 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged.json.gz
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged.json.gz
Wrote 1,395,351 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/combined.51_samples.positive_loci.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
Wrote 1,395,351 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
Wrote 1,395,351 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.TRGT.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.bed.gz.tbi /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.TRGT.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.LongTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.HipSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.GangSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz

Stats for repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.json.gz:
    1,395,351 total loci
   18,608,716 base pairs spanned by all loci (0.603% of the genome)
            0 out of  1,395,351 (  0.0%) loci define adjacent repeats
    1,395,351 total repeat intervals
    1,395,351 out of  1,395,351 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,395,351 out of  1,395,351 (100.0%) repeat intervals are homopolymers
            0 out of  1,395,351 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 1-229bp
   Num repeats range: 1-229x repeats

   Maximum locus size =   229bp             @ chr2:32916351-32916580 (G)
   Minimum fraction pure bases =  0.55      @ chr14:58180973-58180984 (T)
   Minimum fraction pure repeats =  0.55    @ chr14:58180973-58180984 (T)
   Minimum overall mappability =  0.00       @ chrY:26345156-26345198 (A)

          chrX:     66,718 out of  1,395,351 (  4.8%) repeat intervals
          chrY:      9,064 out of  1,395,351 (  0.6%) repeat intervals
          chrM:          0 out of  1,395,351 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,395,351 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,395,351 out of  1,395,351 (100.0%) repeat intervals
          2bp:          0 out of  1,395,351 (  0.0%) repeat intervals
          3bp:          0 out of  1,395,351 (  0.0%) repeat intervals
          4bp:          0 out of  1,395,351 (  0.0%) repeat intervals
          5bp:          0 out of  1,395,351 (  0.0%) repeat intervals
          6bp:          0 out of  1,395,351 (  0.0%) repeat intervals
       7-24bp:          0 out of  1,395,351 (  0.0%) repeat intervals
        25+bp:          0 out of  1,395,351 (  0.0%) repeat intervals

Num repeats in reference:
           1x:        387 out of  1,395,351 (  0.0%) repeat intervals
           2x:        132 out of  1,395,351 (  0.0%) repeat intervals
           3x:        295 out of  1,395,351 (  0.0%) repeat intervals
           4x:        374 out of  1,395,351 (  0.0%) repeat intervals
           5x:        757 out of  1,395,351 (  0.1%) repeat intervals
           6x:      1,107 out of  1,395,351 (  0.1%) repeat intervals
           7x:      3,709 out of  1,395,351 (  0.3%) repeat intervals
           8x:     65,422 out of  1,395,351 (  4.7%) repeat intervals
           9x:    314,806 out of  1,395,351 ( 22.6%) repeat intervals
       10-15x:    647,879 out of  1,395,351 ( 46.4%) repeat intervals
       16-25x:    307,786 out of  1,395,351 ( 22.1%) repeat intervals
       26-35x:     46,459 out of  1,395,351 (  3.3%) repeat intervals
       36-50x:      5,975 out of  1,395,351 (  0.4%) repeat intervals
         51+x:        263 out of  1,395,351 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,395,351 (  0.0%) repeat intervals
          0.1:          0 out of  1,395,351 (  0.0%) repeat intervals
          0.2:          0 out of  1,395,351 (  0.0%) repeat intervals
          0.3:          0 out of  1,395,351 (  0.0%) repeat intervals
          0.4:          0 out of  1,395,351 (  0.0%) repeat intervals
          0.5:         23 out of  1,395,351 (  0.0%) repeat intervals
          0.6:         91 out of  1,395,351 (  0.0%) repeat intervals
          0.7:         12 out of  1,395,351 (  0.0%) repeat intervals
          0.8:        126 out of  1,395,351 (  0.0%) repeat intervals
          0.9:     18,343 out of  1,395,351 (  1.3%) repeat intervals
          1.0:  1,376,756 out of  1,395,351 ( 98.7%) repeat intervals

Mappability distribution:
          0.0:     31,577 out of  1,395,351 (  2.3%) loci
          0.1:     54,953 out of  1,395,351 (  3.9%) loci
          0.2:     68,082 out of  1,395,351 (  4.9%) loci
          0.3:     90,987 out of  1,395,351 (  6.5%) loci
          0.4:    168,882 out of  1,395,351 ( 12.1%) loci
          0.5:    261,929 out of  1,395,351 ( 18.8%) loci
          0.6:    115,981 out of  1,395,351 (  8.3%) loci
          0.7:     85,726 out of  1,395,351 (  6.1%) loci
          0.8:     75,810 out of  1,395,351 (  5.4%) loci
          0.9:    132,421 out of  1,395,351 (  9.5%) loci
          1.0:    309,003 out of  1,395,351 ( 22.1%) loci
Wrote 1 rows to repeat_catalog_v1.hg38.homopolymers.merged_and_annotated.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/homopolymers/repeat_catalog_v1.hg38.homopolymers catalog. Took 3h, 25m, 7s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
mkdir -p 2_to_6bp
cd 2_to_6bp
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Wrote 77 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        77 out of 83 (93%)  passed all filters
         5 out of 83 ( 6%)  motif size(s) > 6
         1 out of 83 ( 1%)  motif size(s) < 2
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
           77 total loci
        3,486 base pairs spanned by all loci (0.000% of the genome)
            0 out of         77 (  0.0%) loci define adjacent repeats
           77 total repeat intervals
           76 out of         77 ( 98.7%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of         77 (  0.0%) repeat intervals are homopolymers
            0 out of         77 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         77 ( 14.3%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-6bp
   Locus size range: 6-150bp
   Num repeats range: 2-50x repeats

   Maximum locus size =   150bp             @ chr13:102161574-102161724 (AAG)
   Minimum fraction pure bases =  0.59      @ chr8:118366812-118366918 (AAAAT)
   Minimum fraction pure repeats =  0.00    @ chr13:99985448-99985493 (GCN)

          chrX:         11 out of         77 ( 14.3%) repeat intervals
          chrY:          0 out of         77 (  0.0%) repeat intervals
          chrM:          0 out of         77 (  0.0%) repeat intervals
   alt contigs:          0 out of         77 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of         77 (  0.0%) repeat intervals
          2bp:          1 out of         77 (  1.3%) repeat intervals
          3bp:         60 out of         77 ( 77.9%) repeat intervals
          4bp:          2 out of         77 (  2.6%) repeat intervals
          5bp:         10 out of         77 ( 13.0%) repeat intervals
          6bp:          4 out of         77 (  5.2%) repeat intervals
       7-24bp:          0 out of         77 (  0.0%) repeat intervals
        25+bp:          0 out of         77 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of         77 (  0.0%) repeat intervals
           2x:          2 out of         77 (  2.6%) repeat intervals
           3x:          2 out of         77 (  2.6%) repeat intervals
           4x:          2 out of         77 (  2.6%) repeat intervals
           5x:          2 out of         77 (  2.6%) repeat intervals
           6x:          2 out of         77 (  2.6%) repeat intervals
           7x:          5 out of         77 (  6.5%) repeat intervals
           8x:          5 out of         77 (  6.5%) repeat intervals
           9x:          2 out of         77 (  2.6%) repeat intervals
       10-15x:         31 out of         77 ( 40.3%) repeat intervals
       16-25x:         20 out of         77 ( 26.0%) repeat intervals
       26-35x:          2 out of         77 (  2.6%) repeat intervals
       36-50x:          2 out of         77 (  2.6%) repeat intervals
         51+x:          0 out of         77 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         77 ( 14.3%) repeat intervals
          0.1:          0 out of         77 (  0.0%) repeat intervals
          0.2:          0 out of         77 (  0.0%) repeat intervals
          0.3:          0 out of         77 (  0.0%) repeat intervals
          0.4:          0 out of         77 (  0.0%) repeat intervals
          0.5:          0 out of         77 (  0.0%) repeat intervals
          0.6:          0 out of         77 (  0.0%) repeat intervals
          0.7:          2 out of         77 (  2.6%) repeat intervals
          0.8:          8 out of         77 ( 10.4%) repeat intervals
          0.9:          8 out of         77 ( 10.4%) repeat intervals
          1.0:         48 out of         77 ( 62.3%) repeat intervals
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 172,718 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   172,718 out of 174,286 (99%)  passed all filters
     1,203 out of 174,286 ( 1%)  motif size(s) > 6
       365 out of 174,286 ( 0%)  motif size(s) < 2

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
      172,718 total loci
    4,587,342 base pairs spanned by all loci (0.149% of the genome)
            0 out of    172,718 (  0.0%) loci define adjacent repeats
      172,718 total repeat intervals
      172,694 out of    172,718 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    172,718 (  0.0%) repeat intervals are homopolymers
            0 out of    172,718 (  0.0%) repeat intervals overlap each other by at least two motif lengths
            1 out of    172,718 (  0.0%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-6bp
   Locus size range: 4-532bp
   Num repeats range: 2-133x repeats

   Maximum locus size =   532bp             @ chr7:138621782-138622314 (TATC)
   Minimum fraction pure bases =  0.43      @ chr3:112804380-112804514 (TCT)
   Minimum fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)

          chrX:      8,520 out of    172,718 (  4.9%) repeat intervals
          chrY:          0 out of    172,718 (  0.0%) repeat intervals
          chrM:          0 out of    172,718 (  0.0%) repeat intervals
   alt contigs:          0 out of    172,718 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    172,718 (  0.0%) repeat intervals
          2bp:     98,531 out of    172,718 ( 57.0%) repeat intervals
          3bp:     14,442 out of    172,718 (  8.4%) repeat intervals
          4bp:     43,263 out of    172,718 ( 25.0%) repeat intervals
          5bp:     12,551 out of    172,718 (  7.3%) repeat intervals
          6bp:      3,931 out of    172,718 (  2.3%) repeat intervals
       7-24bp:          0 out of    172,718 (  0.0%) repeat intervals
        25+bp:          0 out of    172,718 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of    172,718 (  0.0%) repeat intervals
           2x:      8,153 out of    172,718 (  4.7%) repeat intervals
           3x:      6,210 out of    172,718 (  3.6%) repeat intervals
           4x:      8,731 out of    172,718 (  5.1%) repeat intervals
           5x:     11,825 out of    172,718 (  6.8%) repeat intervals
           6x:     13,874 out of    172,718 (  8.0%) repeat intervals
           7x:     14,907 out of    172,718 (  8.6%) repeat intervals
           8x:     13,896 out of    172,718 (  8.0%) repeat intervals
           9x:     12,530 out of    172,718 (  7.3%) repeat intervals
       10-15x:     49,890 out of    172,718 ( 28.9%) repeat intervals
       16-25x:     31,022 out of    172,718 ( 18.0%) repeat intervals
       26-35x:      1,651 out of    172,718 (  1.0%) repeat intervals
       36-50x:         23 out of    172,718 (  0.0%) repeat intervals
         51+x:          6 out of    172,718 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of    172,718 (  0.0%) repeat intervals
          0.1:          0 out of    172,718 (  0.0%) repeat intervals
          0.2:          0 out of    172,718 (  0.0%) repeat intervals
          0.3:          0 out of    172,718 (  0.0%) repeat intervals
          0.4:          0 out of    172,718 (  0.0%) repeat intervals
          0.5:          0 out of    172,718 (  0.0%) repeat intervals
          0.6:         25 out of    172,718 (  0.0%) repeat intervals
          0.7:        555 out of    172,718 (  0.3%) repeat intervals
          0.8:      4,096 out of    172,718 (  2.4%) repeat intervals
          0.9:      3,178 out of    172,718 (  1.8%) repeat intervals
          1.0:    164,863 out of    172,718 ( 95.5%) repeat intervals
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 3,179,847 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 3,179,847 out of 4,558,281 (70%)  passed all filters
 1,337,567 out of 4,558,281 (29%)  motif size(s) < 2
    40,867 out of 4,558,281 ( 1%)  motif size(s) > 6
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    3,179,847 total loci
   41,615,061 base pairs spanned by all loci (1.348% of the genome)
            0 out of  3,179,847 (  0.0%) loci define adjacent repeats
    3,179,847 total repeat intervals
    1,453,291 out of  3,179,847 ( 45.7%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,179,847 (  0.0%) repeat intervals are homopolymers
            0 out of  3,179,847 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 2-6bp
   Locus size range: 9-1103bp
   Num repeats range: 3-300x repeats

   Maximum locus size =  1103bp             @ chr5:10478-11581 (CCTAAC)
   Minimum fraction pure bases =  0.78      @ chrY:26599292-26599315 (TATGTG)
   Minimum fraction pure repeats =  1.00    @ chrY:56887882-56887891 (TGA)

          chrX:    166,273 out of  3,179,847 (  5.2%) repeat intervals
          chrY:     29,581 out of  3,179,847 (  0.9%) repeat intervals
          chrM:         14 out of  3,179,847 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,179,847 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,179,847 (  0.0%) repeat intervals
          2bp:    967,389 out of  3,179,847 ( 30.4%) repeat intervals
          3bp:  1,418,341 out of  3,179,847 ( 44.6%) repeat intervals
          4bp:    569,907 out of  3,179,847 ( 17.9%) repeat intervals
          5bp:    172,187 out of  3,179,847 (  5.4%) repeat intervals
          6bp:     52,023 out of  3,179,847 (  1.6%) repeat intervals
       7-24bp:          0 out of  3,179,847 (  0.0%) repeat intervals
        25+bp:          0 out of  3,179,847 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of  3,179,847 (  0.0%) repeat intervals
           2x:          0 out of  3,179,847 (  0.0%) repeat intervals
           3x:  1,755,512 out of  3,179,847 ( 55.2%) repeat intervals
           4x:    636,383 out of  3,179,847 ( 20.0%) repeat intervals
           5x:    352,003 out of  3,179,847 ( 11.1%) repeat intervals
           6x:    147,914 out of  3,179,847 (  4.7%) repeat intervals
           7x:     76,379 out of  3,179,847 (  2.4%) repeat intervals
           8x:     43,044 out of  3,179,847 (  1.4%) repeat intervals
           9x:     28,490 out of  3,179,847 (  0.9%) repeat intervals
       10-15x:     88,185 out of  3,179,847 (  2.8%) repeat intervals
       16-25x:     48,491 out of  3,179,847 (  1.5%) repeat intervals
       26-35x:      3,305 out of  3,179,847 (  0.1%) repeat intervals
       36-50x:        103 out of  3,179,847 (  0.0%) repeat intervals
         51+x:         38 out of  3,179,847 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.1:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.2:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.3:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.4:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.5:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.6:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.7:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.8:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.9:          0 out of  3,179,847 (  0.0%) repeat intervals
          1.0:  3,179,847 out of  3,179,847 (100.0%) repeat intervals
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/combined.51_samples.positive_loci.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/combined.51_samples.positive_loci.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Wrote 518,481 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/combined.51_samples.positive_loci.filtered.json.gz

Filter stats:
 1,575,395 total input rows
 1,022,431 out of 1,575,395 (65%)  motif size(s) < 2
   518,481 out of 1,575,395 (33%)  passed all filters
    34,299 out of 1,575,395 ( 2%)  motif size(s) > 6
       184 out of 1,575,395 ( 0%)  row reference sequence has invalid bases

Modification stats:
    19,510 out of 1,575,395 ( 1%)  replaced 4bp motif with a simplified 2bp motif
     1,944 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 2bp motif
       363 out of 1,575,395 ( 0%)  replaced 8bp motif with a simplified 4bp motif
       277 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        35 out of 1,575,395 ( 0%)  replaced 12bp motif with a simplified 4bp motif
        34 out of 1,575,395 ( 0%)  replaced 9bp motif with a simplified 3bp motif
        34 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 2bp motif
        22 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         3 out of 1,575,395 ( 0%)  replaced 15bp motif with a simplified 5bp motif
         2 out of 1,575,395 ( 0%)  replaced 14bp motif with a simplified 2bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/combined.51_samples.positive_loci.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/combined.51_samples.positive_loci.filtered.json.gz

Stats for combined.51_samples.positive_loci.filtered.json.gz:
      518,481 total loci
   12,727,849 base pairs spanned by all loci (0.412% of the genome)
            0 out of    518,481 (  0.0%) loci define adjacent repeats
      518,481 total repeat intervals
      518,481 out of    518,481 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    518,481 (  0.0%) repeat intervals are homopolymers
      114,543 out of    518,481 ( 22.1%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr17:34099706-34099802, chr9:105228101-105228115, chr3:30399707-30399747, chr2:31245531-31245555, chr8:76596639-76596675, chr4:62593671-62593717, chr7:1642743-1642751, chr18:77391501-77391513, chr10:57543055-57543079, chrX:104476318-104476364

Ranges:
   Motif size range: 2-6bp
   Locus size range: 2-602bp
   Num repeats range: 1-301x repeats

   Maximum locus size =   602bp             @ chr3:144799029-144799631 (TA)
   Minimum fraction pure bases =  0.68      @ chr13:18606767-18606827 (GAG)
   Minimum fraction pure repeats =  0.03    @ chr11:133140745-133140859 (GAG)

          chrX:     24,654 out of    518,481 (  4.8%) repeat intervals
          chrY:      1,794 out of    518,481 (  0.3%) repeat intervals
          chrM:          0 out of    518,481 (  0.0%) repeat intervals
   alt contigs:          0 out of    518,481 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    518,481 (  0.0%) repeat intervals
          2bp:    263,734 out of    518,481 ( 50.9%) repeat intervals
          3bp:     65,064 out of    518,481 ( 12.5%) repeat intervals
          4bp:    141,031 out of    518,481 ( 27.2%) repeat intervals
          5bp:     34,944 out of    518,481 (  6.7%) repeat intervals
          6bp:     13,708 out of    518,481 (  2.6%) repeat intervals
       7-24bp:          0 out of    518,481 (  0.0%) repeat intervals
        25+bp:          0 out of    518,481 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      4,607 out of    518,481 (  0.9%) repeat intervals
           2x:     17,581 out of    518,481 (  3.4%) repeat intervals
           3x:     52,985 out of    518,481 ( 10.2%) repeat intervals
           4x:     48,377 out of    518,481 (  9.3%) repeat intervals
           5x:     57,320 out of    518,481 ( 11.1%) repeat intervals
           6x:     49,932 out of    518,481 (  9.6%) repeat intervals
           7x:     39,955 out of    518,481 (  7.7%) repeat intervals
           8x:     33,476 out of    518,481 (  6.5%) repeat intervals
           9x:     26,492 out of    518,481 (  5.1%) repeat intervals
       10-15x:    104,789 out of    518,481 ( 20.2%) repeat intervals
       16-25x:     72,362 out of    518,481 ( 14.0%) repeat intervals
       26-35x:      9,216 out of    518,481 (  1.8%) repeat intervals
       36-50x:      1,042 out of    518,481 (  0.2%) repeat intervals
         51+x:        347 out of    518,481 (  0.1%) repeat intervals

Fraction pure bases distribution:
          0.0:        189 out of    518,481 (  0.0%) repeat intervals
          0.1:      1,148 out of    518,481 (  0.2%) repeat intervals
          0.2:      1,844 out of    518,481 (  0.4%) repeat intervals
          0.3:      1,917 out of    518,481 (  0.4%) repeat intervals
          0.4:      1,447 out of    518,481 (  0.3%) repeat intervals
          0.5:      5,631 out of    518,481 (  1.1%) repeat intervals
          0.6:     11,237 out of    518,481 (  2.2%) repeat intervals
          0.7:      7,015 out of    518,481 (  1.4%) repeat intervals
          0.8:     13,312 out of    518,481 (  2.6%) repeat intervals
          0.9:     28,930 out of    518,481 (  5.6%) repeat intervals
          1.0:    445,811 out of    518,481 ( 86.0%) repeat intervals
Wrote 1 rows to combined.51_samples.positive_loci.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --merge-adjacent-loci-with-same-motif  --add-source-field  --output-format JSON  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/combined.51_samples.positive_loci.filtered.json.gz
Added 77 out of 77 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 172,677 out of 172,718 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 172,677 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 3,013,699 out of 3,179,847 ( 94.8%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 3,013,699 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 42,332 out of 518,481 (  8.2%) records from combined.51_samples.positive_loci.filtered.json.gz to the output catalog
Wrote 42,332 unique loci from combined.51_samples.positive_loci.filtered.json.gz to combined.51_samples.positive_loci.filtered.unique_loci.bed.gz
Merged 59,030 out of 3,228,785 (  1.8%) adjacent loci that were within 1bp of each other and had the same motif after cyclic shift
Done writing 3,169,755 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged.json.gz
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged.json.gz
Wrote 3,169,738 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/combined.51_samples.positive_loci.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.with_variation_clusters.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Parsed 3,147,421 variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Missing variation clusters for 79,754 out of 3,169,738 (2.5%) records from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Used 3,089,984 out of 3,147,421 (98.2%) of variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Wrote 3,169,738 out of 3,169,738 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Wrote 3,169,738 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Wrote 3,169,738 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.TRGT.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.bed.gz.tbi /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.TRGT.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.LongTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.HipSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.GangSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz

Stats for repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.json.gz:
    3,169,738 total loci
   42,177,523 base pairs spanned by all loci (1.366% of the genome)
            0 out of  3,169,738 (  0.0%) loci define adjacent repeats
    3,169,738 total repeat intervals
    1,585,237 out of  3,169,738 ( 50.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,169,738 (  0.0%) repeat intervals are homopolymers
       13,365 out of  3,169,738 (  0.4%) repeat intervals overlap each other by at least two motif lengths
           11 out of  3,169,738 (  0.0%) repeat intervals have non-ACGT motifs
Examples of overlapping repeats: chr5:69013999-69014074, chr2:233627608-233627680, chr18:7197304-7197320, chr4:24194622-24194631, chr19:50592772-50592785, chr20:50858925-50858946, chr2:119073523-119073551, chr11:69837313-69837357, chr17:5659391-5659465, chr9:69340666-69340677

Ranges:
   Motif size range: 2-6bp
   Locus size range: 2-1581bp
   Num repeats range: 1-300x repeats

   Maximum locus size =  1581bp             @ chr5:10000-11581 (TAACCC)
   Minimum fraction pure bases =  0.09      @ chr9:122391336-122391446 (TA)
   Minimum fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)
   Minimum overall mappability =  0.00       @ chrY:56887882-56887891 (TGA)

          chrX:    164,329 out of  3,169,738 (  5.2%) repeat intervals
          chrY:     28,844 out of  3,169,738 (  0.9%) repeat intervals
          chrM:         14 out of  3,169,738 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,169,738 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,169,738 (  0.0%) repeat intervals
          2bp:    939,016 out of  3,169,738 ( 29.6%) repeat intervals
          3bp:  1,421,048 out of  3,169,738 ( 44.8%) repeat intervals
          4bp:    578,783 out of  3,169,738 ( 18.3%) repeat intervals
          5bp:    175,071 out of  3,169,738 (  5.5%) repeat intervals
          6bp:     55,820 out of  3,169,738 (  1.8%) repeat intervals
       7-24bp:          0 out of  3,169,738 (  0.0%) repeat intervals
        25+bp:          0 out of  3,169,738 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      3,851 out of  3,169,738 (  0.1%) repeat intervals
           2x:     21,828 out of  3,169,738 (  0.7%) repeat intervals
           3x:  1,742,912 out of  3,169,738 ( 55.0%) repeat intervals
           4x:    615,213 out of  3,169,738 ( 19.4%) repeat intervals
           5x:    329,189 out of  3,169,738 ( 10.4%) repeat intervals
           6x:    138,090 out of  3,169,738 (  4.4%) repeat intervals
           7x:     74,023 out of  3,169,738 (  2.3%) repeat intervals
           8x:     42,793 out of  3,169,738 (  1.4%) repeat intervals
           9x:     31,282 out of  3,169,738 (  1.0%) repeat intervals
       10-15x:    107,785 out of  3,169,738 (  3.4%) repeat intervals
       16-25x:     57,340 out of  3,169,738 (  1.8%) repeat intervals
       26-35x:      4,848 out of  3,169,738 (  0.2%) repeat intervals
       36-50x:        413 out of  3,169,738 (  0.0%) repeat intervals
         51+x:        171 out of  3,169,738 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        176 out of  3,169,738 (  0.0%) repeat intervals
          0.1:      1,011 out of  3,169,738 (  0.0%) repeat intervals
          0.2:      1,529 out of  3,169,738 (  0.0%) repeat intervals
          0.3:      1,421 out of  3,169,738 (  0.0%) repeat intervals
          0.4:        901 out of  3,169,738 (  0.0%) repeat intervals
          0.5:      4,118 out of  3,169,738 (  0.1%) repeat intervals
          0.6:      8,536 out of  3,169,738 (  0.3%) repeat intervals
          0.7:      3,394 out of  3,169,738 (  0.1%) repeat intervals
          0.8:     23,468 out of  3,169,738 (  0.7%) repeat intervals
          0.9:     35,935 out of  3,169,738 (  1.1%) repeat intervals
          1.0:  3,089,249 out of  3,169,738 ( 97.5%) repeat intervals

Mappability distribution:
          0.0:     98,513 out of  3,169,738 (  3.1%) loci
          0.1:     94,886 out of  3,169,738 (  3.0%) loci
          0.2:    116,777 out of  3,169,738 (  3.7%) loci
          0.3:    169,793 out of  3,169,738 (  5.4%) loci
          0.4:    223,407 out of  3,169,738 (  7.0%) loci
          0.5:    301,754 out of  3,169,738 (  9.5%) loci
          0.6:    221,879 out of  3,169,738 (  7.0%) loci
          0.7:    218,147 out of  3,169,738 (  6.9%) loci
          0.8:    254,347 out of  3,169,738 (  8.0%) loci
          0.9:    508,640 out of  3,169,738 ( 16.0%) loci
          1.0:    961,595 out of  3,169,738 ( 30.3%) loci
Wrote 1 rows to repeat_catalog_v1.hg38.2_to_6bp.merged_and_annotated.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/2_to_6bp/repeat_catalog_v1.hg38.2_to_6bp catalog. Took 7h, 27m, 33s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14
mkdir -p 7_to_1000bp
cd 7_to_1000bp
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
Wrote 5 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        78 out of 83 (94%)  motif size(s) < 7
         5 out of 83 ( 6%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/variant_catalog_without_offtargets.GRCh38.split.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
            5 total loci
          259 base pairs spanned by all loci (0.000% of the genome)
            0 out of          5 (  0.0%) loci define adjacent repeats
            5 total repeat intervals
            5 out of          5 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of          5 (  0.0%) repeat intervals are homopolymers
            0 out of          5 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 10-27bp
   Locus size range: 20-96bp
   Num repeats range: 1-4x repeats

   Maximum locus size =    96bp             @ chr20:4699397-4699493 (CCTCATGGTGGTGGCTGGGGGCAG)
   Minimum fraction pure bases =  0.96      @ chr20:4699397-4699493 (CCTCATGGTGGTGGCTGGGGGCAG)
   Minimum fraction pure repeats =  0.50    @ chr20:4699397-4699493 (CCTCATGGTGGTGGCTGGGGGCAG)

          chrX:          0 out of          5 (  0.0%) repeat intervals
          chrY:          0 out of          5 (  0.0%) repeat intervals
          chrM:          0 out of          5 (  0.0%) repeat intervals
   alt contigs:          0 out of          5 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of          5 (  0.0%) repeat intervals
          2bp:          0 out of          5 (  0.0%) repeat intervals
          3bp:          0 out of          5 (  0.0%) repeat intervals
          4bp:          0 out of          5 (  0.0%) repeat intervals
          5bp:          0 out of          5 (  0.0%) repeat intervals
          6bp:          0 out of          5 (  0.0%) repeat intervals
       7-24bp:          4 out of          5 ( 80.0%) repeat intervals
        25+bp:          1 out of          5 ( 20.0%) repeat intervals

Num repeats in reference:
           1x:          1 out of          5 ( 20.0%) repeat intervals
           2x:          1 out of          5 ( 20.0%) repeat intervals
           3x:          1 out of          5 ( 20.0%) repeat intervals
           4x:          2 out of          5 ( 40.0%) repeat intervals
           5x:          0 out of          5 (  0.0%) repeat intervals
           6x:          0 out of          5 (  0.0%) repeat intervals
           7x:          0 out of          5 (  0.0%) repeat intervals
           8x:          0 out of          5 (  0.0%) repeat intervals
           9x:          0 out of          5 (  0.0%) repeat intervals
       10-15x:          0 out of          5 (  0.0%) repeat intervals
       16-25x:          0 out of          5 (  0.0%) repeat intervals
       26-35x:          0 out of          5 (  0.0%) repeat intervals
       36-50x:          0 out of          5 (  0.0%) repeat intervals
         51+x:          0 out of          5 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of          5 (  0.0%) repeat intervals
          0.1:          0 out of          5 (  0.0%) repeat intervals
          0.2:          0 out of          5 (  0.0%) repeat intervals
          0.3:          0 out of          5 (  0.0%) repeat intervals
          0.4:          0 out of          5 (  0.0%) repeat intervals
          0.5:          1 out of          5 ( 20.0%) repeat intervals
          0.6:          0 out of          5 (  0.0%) repeat intervals
          0.7:          0 out of          5 (  0.0%) repeat intervals
          0.8:          0 out of          5 (  0.0%) repeat intervals
          0.9:          0 out of          5 (  0.0%) repeat intervals
          1.0:          4 out of          5 ( 80.0%) repeat intervals
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 1,203 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   173,083 out of 174,286 (99%)  motif size(s) < 7
     1,203 out of 174,286 ( 1%)  passed all filters

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
        1,203 total loci
       28,202 base pairs spanned by all loci (0.001% of the genome)
            0 out of      1,203 (  0.0%) loci define adjacent repeats
        1,203 total repeat intervals
        1,203 out of      1,203 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of      1,203 (  0.0%) repeat intervals are homopolymers
            0 out of      1,203 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 7-24bp
   Locus size range: 14-96bp
   Num repeats range: 2-10x repeats

   Maximum locus size =    96bp             @ chr18:72692161-72692257 (TGGGAGGGGTGCGCGC)
   Minimum fraction pure bases =  0.96      @ chr9:134945691-134945740 (AGGGCAG)
   Minimum fraction pure repeats =  0.71    @ chr12:588162-588225 (GGGACGGAA)

          chrX:         35 out of      1,203 (  2.9%) repeat intervals
          chrY:          0 out of      1,203 (  0.0%) repeat intervals
          chrM:          0 out of      1,203 (  0.0%) repeat intervals
   alt contigs:          0 out of      1,203 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of      1,203 (  0.0%) repeat intervals
          2bp:          0 out of      1,203 (  0.0%) repeat intervals
          3bp:          0 out of      1,203 (  0.0%) repeat intervals
          4bp:          0 out of      1,203 (  0.0%) repeat intervals
          5bp:          0 out of      1,203 (  0.0%) repeat intervals
          6bp:          0 out of      1,203 (  0.0%) repeat intervals
       7-24bp:      1,203 out of      1,203 (100.0%) repeat intervals
        25+bp:          0 out of      1,203 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of      1,203 (  0.0%) repeat intervals
           2x:        627 out of      1,203 ( 52.1%) repeat intervals
           3x:        333 out of      1,203 ( 27.7%) repeat intervals
           4x:        147 out of      1,203 ( 12.2%) repeat intervals
           5x:         59 out of      1,203 (  4.9%) repeat intervals
           6x:         23 out of      1,203 (  1.9%) repeat intervals
           7x:          8 out of      1,203 (  0.7%) repeat intervals
           8x:          2 out of      1,203 (  0.2%) repeat intervals
           9x:          2 out of      1,203 (  0.2%) repeat intervals
       10-15x:          2 out of      1,203 (  0.2%) repeat intervals
       16-25x:          0 out of      1,203 (  0.0%) repeat intervals
       26-35x:          0 out of      1,203 (  0.0%) repeat intervals
       36-50x:          0 out of      1,203 (  0.0%) repeat intervals
         51+x:          0 out of      1,203 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of      1,203 (  0.0%) repeat intervals
          0.1:          0 out of      1,203 (  0.0%) repeat intervals
          0.2:          0 out of      1,203 (  0.0%) repeat intervals
          0.3:          0 out of      1,203 (  0.0%) repeat intervals
          0.4:          0 out of      1,203 (  0.0%) repeat intervals
          0.5:          0 out of      1,203 (  0.0%) repeat intervals
          0.6:          0 out of      1,203 (  0.0%) repeat intervals
          0.7:         11 out of      1,203 (  0.9%) repeat intervals
          0.8:         17 out of      1,203 (  1.4%) repeat intervals
          0.9:          1 out of      1,203 (  0.1%) repeat intervals
          1.0:      1,174 out of      1,203 ( 97.6%) repeat intervals
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 40,867 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 4,517,414 out of 4,558,281 (99%)  motif size(s) < 7
    40,867 out of 4,558,281 ( 1%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
       40,867 total loci
    2,889,377 base pairs spanned by all loci (0.094% of the genome)
            0 out of     40,867 (  0.0%) loci define adjacent repeats
       40,867 total repeat intervals
        8,193 out of     40,867 ( 20.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of     40,867 (  0.0%) repeat intervals are homopolymers
            0 out of     40,867 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 7-833bp
   Locus size range: 21-2523bp
   Num repeats range: 3-70x repeats

   Maximum locus size =  2523bp             @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases =  0.75      @ chr9:123405668-123405915 (TCCTGCCCACCCTTTGAGTTTCCAGGACAAGACAGGGAAGGGAAGCAGGCACACACTCCACT)
   Minimum fraction pure repeats =  1.00    @ chrY:56858432-56858475 (GAAAGAAG)

          chrX:      2,542 out of     40,867 (  6.2%) repeat intervals
          chrY:        248 out of     40,867 (  0.6%) repeat intervals
          chrM:          0 out of     40,867 (  0.0%) repeat intervals
   alt contigs:          0 out of     40,867 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of     40,867 (  0.0%) repeat intervals
          2bp:          0 out of     40,867 (  0.0%) repeat intervals
          3bp:          0 out of     40,867 (  0.0%) repeat intervals
          4bp:          0 out of     40,867 (  0.0%) repeat intervals
          5bp:          0 out of     40,867 (  0.0%) repeat intervals
          6bp:          0 out of     40,867 (  0.0%) repeat intervals
       7-24bp:     31,185 out of     40,867 ( 76.3%) repeat intervals
        25+bp:      9,682 out of     40,867 ( 23.7%) repeat intervals

Num repeats in reference:
           1x:          0 out of     40,867 (  0.0%) repeat intervals
           2x:          0 out of     40,867 (  0.0%) repeat intervals
           3x:     31,847 out of     40,867 ( 77.9%) repeat intervals
           4x:      4,898 out of     40,867 ( 12.0%) repeat intervals
           5x:      1,720 out of     40,867 (  4.2%) repeat intervals
           6x:        839 out of     40,867 (  2.1%) repeat intervals
           7x:        462 out of     40,867 (  1.1%) repeat intervals
           8x:        299 out of     40,867 (  0.7%) repeat intervals
           9x:        188 out of     40,867 (  0.5%) repeat intervals
       10-15x:        478 out of     40,867 (  1.2%) repeat intervals
       16-25x:        121 out of     40,867 (  0.3%) repeat intervals
       26-35x:         12 out of     40,867 (  0.0%) repeat intervals
       36-50x:          2 out of     40,867 (  0.0%) repeat intervals
         51+x:          1 out of     40,867 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of     40,867 (  0.0%) repeat intervals
          0.1:          0 out of     40,867 (  0.0%) repeat intervals
          0.2:          0 out of     40,867 (  0.0%) repeat intervals
          0.3:          0 out of     40,867 (  0.0%) repeat intervals
          0.4:          0 out of     40,867 (  0.0%) repeat intervals
          0.5:          0 out of     40,867 (  0.0%) repeat intervals
          0.6:          0 out of     40,867 (  0.0%) repeat intervals
          0.7:          0 out of     40,867 (  0.0%) repeat intervals
          0.8:          0 out of     40,867 (  0.0%) repeat intervals
          0.9:          0 out of     40,867 (  0.0%) repeat intervals
          1.0:     40,867 out of     40,867 (100.0%) repeat intervals
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
Wrote 34,274 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz

Filter stats:
 1,575,395 total input rows
 1,541,096 out of 1,575,395 (98%)  motif size(s) < 7
    34,274 out of 1,575,395 ( 2%)  passed all filters
        25 out of 1,575,395 ( 0%)  row reference sequence has invalid bases

Modification stats:
    19,510 out of 1,575,395 ( 1%)  replaced 4bp motif with a simplified 2bp motif
     1,944 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 2bp motif
       363 out of 1,575,395 ( 0%)  replaced 8bp motif with a simplified 4bp motif
       277 out of 1,575,395 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        35 out of 1,575,395 ( 0%)  replaced 12bp motif with a simplified 4bp motif
        34 out of 1,575,395 ( 0%)  replaced 9bp motif with a simplified 3bp motif
        34 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 2bp motif
        22 out of 1,575,395 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         3 out of 1,575,395 ( 0%)  replaced 15bp motif with a simplified 5bp motif
         2 out of 1,575,395 ( 0%)  replaced 14bp motif with a simplified 2bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/combined.51_samples.positive_loci.json
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz

Stats for combined.51_samples.positive_loci.filtered.json.gz:
       34,274 total loci
    2,247,818 base pairs spanned by all loci (0.073% of the genome)
            0 out of     34,274 (  0.0%) loci define adjacent repeats
       34,274 total repeat intervals
       34,274 out of     34,274 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of     34,274 (  0.0%) repeat intervals are homopolymers
        2,624 out of     34,274 (  7.7%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr20:61985902-61985968, chr2:10043222-10043267, chr5:487313-487358, chr20:64042791-64042917, chr8:320063-320105, chr18:78916478-78916550, chr11:375092-375152, chr17:81022741-81022781, chr16:1025262-1025382, chr15:56007279-56007387

Ranges:
   Motif size range: 7-833bp
   Locus size range: 7-2499bp
   Num repeats range: 1-78x repeats

   Maximum locus size =  2499bp             @ chrX:71520430-71522929 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases =  0.89      @ chr22:41544420-41544448 (CGCGCAC)
   Minimum fraction pure repeats =  0.08    @ chr11:126065050-126065258 (TAGTATTAAGAGGTGG)

          chrX:      1,537 out of     34,274 (  4.5%) repeat intervals
          chrY:         49 out of     34,274 (  0.1%) repeat intervals
          chrM:          0 out of     34,274 (  0.0%) repeat intervals
   alt contigs:          0 out of     34,274 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of     34,274 (  0.0%) repeat intervals
          2bp:          0 out of     34,274 (  0.0%) repeat intervals
          3bp:          0 out of     34,274 (  0.0%) repeat intervals
          4bp:          0 out of     34,274 (  0.0%) repeat intervals
          5bp:          0 out of     34,274 (  0.0%) repeat intervals
          6bp:          0 out of     34,274 (  0.0%) repeat intervals
       7-24bp:     23,451 out of     34,274 ( 68.4%) repeat intervals
        25+bp:     10,823 out of     34,274 ( 31.6%) repeat intervals

Num repeats in reference:
           1x:      3,100 out of     34,274 (  9.0%) repeat intervals
           2x:     11,333 out of     34,274 ( 33.1%) repeat intervals
           3x:     11,936 out of     34,274 ( 34.8%) repeat intervals
           4x:      3,670 out of     34,274 ( 10.7%) repeat intervals
           5x:      1,588 out of     34,274 (  4.6%) repeat intervals
           6x:        823 out of     34,274 (  2.4%) repeat intervals
           7x:        470 out of     34,274 (  1.4%) repeat intervals
           8x:        338 out of     34,274 (  1.0%) repeat intervals
           9x:        235 out of     34,274 (  0.7%) repeat intervals
       10-15x:        586 out of     34,274 (  1.7%) repeat intervals
       16-25x:        159 out of     34,274 (  0.5%) repeat intervals
       26-35x:         29 out of     34,274 (  0.1%) repeat intervals
       36-50x:          5 out of     34,274 (  0.0%) repeat intervals
         51+x:          2 out of     34,274 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of     34,274 (  0.0%) repeat intervals
          0.1:         14 out of     34,274 (  0.0%) repeat intervals
          0.2:         56 out of     34,274 (  0.2%) repeat intervals
          0.3:        120 out of     34,274 (  0.4%) repeat intervals
          0.4:        100 out of     34,274 (  0.3%) repeat intervals
          0.5:        748 out of     34,274 (  2.2%) repeat intervals
          0.6:      1,452 out of     34,274 (  4.2%) repeat intervals
          0.7:        591 out of     34,274 (  1.7%) repeat intervals
          0.8:        356 out of     34,274 (  1.0%) repeat intervals
          0.9:         38 out of     34,274 (  0.1%) repeat intervals
          1.0:     30,798 out of     34,274 ( 89.9%) repeat intervals
Wrote 1 rows to combined.51_samples.positive_loci.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --merge-adjacent-loci-with-same-motif  --add-source-field  --output-format JSON  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/combined.51_samples.positive_loci.filtered.json.gz
Added 5 out of 5 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 1,202 out of 1,203 ( 99.9%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 1,202 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 40,293 out of 40,867 ( 98.6%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 40,293 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 15,787 out of 34,274 ( 46.1%) records from combined.51_samples.positive_loci.filtered.json.gz to the output catalog
Wrote 15,787 unique loci from combined.51_samples.positive_loci.filtered.json.gz to combined.51_samples.positive_loci.filtered.unique_loci.bed.gz
Merged 414 out of 57,287 (  0.7%) adjacent loci that were within 1bp of each other and had the same motif after cyclic shift
Done writing 56,873 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged.json.gz
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged.json.gz
Wrote 56,872 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/combined.51_samples.positive_loci.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Parsed 3,147,421 variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Missing variation clusters for 1,684 out of 56,872 (3.0%) records from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Used 55,188 out of 3,147,421 (1.8%) of variation clusters from /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Wrote 56,872 out of 56,872 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Wrote 56,872 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Wrote 56,872 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.TRGT.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.bed.gz.tbi /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.TRGT.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.LongTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.HipSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.GangSTR.bed /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/release_draft_2024-08-14
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz

Stats for repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.json.gz:
       56,872 total loci
    3,578,479 base pairs spanned by all loci (0.116% of the genome)
            0 out of     56,872 (  0.0%) loci define adjacent repeats
       56,872 total repeat intervals
       24,968 out of     56,872 ( 43.9%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of     56,872 (  0.0%) repeat intervals are homopolymers
          855 out of     56,872 (  1.5%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr9:122110581-122110669, chr13:29559319-29559476, chr12:132787618-132787860, chr16:7229816-7229852, chr11:585280-585671, chr19:55851012-55851091, chr19:55851172-55851232, chrX:5303282-5303607, chrX:5303282-5303616, chr13:19885875-19886001

Ranges:
   Motif size range: 7-833bp
   Locus size range: 7-2523bp
   Num repeats range: 1-70x repeats

   Maximum locus size =  2523bp             @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Minimum fraction pure bases =  0.38      @ chr2:120391563-120391677 (GACATGA)
   Minimum fraction pure repeats =  0.10    @ chr15:26417267-26417397 (TTCTATATATAGG)
   Minimum overall mappability =  0.00       @ chrX:152241307-152241328 (TCAGGGG)

          chrX:      3,235 out of     56,872 (  5.7%) repeat intervals
          chrY:        261 out of     56,872 (  0.5%) repeat intervals
          chrM:          0 out of     56,872 (  0.0%) repeat intervals
   alt contigs:          0 out of     56,872 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of     56,872 (  0.0%) repeat intervals
          2bp:          0 out of     56,872 (  0.0%) repeat intervals
          3bp:          0 out of     56,872 (  0.0%) repeat intervals
          4bp:          0 out of     56,872 (  0.0%) repeat intervals
          5bp:          0 out of     56,872 (  0.0%) repeat intervals
          6bp:          0 out of     56,872 (  0.0%) repeat intervals
       7-24bp:     42,172 out of     56,872 ( 74.2%) repeat intervals
        25+bp:     14,700 out of     56,872 ( 25.8%) repeat intervals

Num repeats in reference:
           1x:      2,984 out of     56,872 (  5.2%) repeat intervals
           2x:     11,409 out of     56,872 ( 20.1%) repeat intervals
           3x:     32,488 out of     56,872 ( 57.1%) repeat intervals
           4x:      5,196 out of     56,872 (  9.1%) repeat intervals
           5x:      1,883 out of     56,872 (  3.3%) repeat intervals
           6x:        970 out of     56,872 (  1.7%) repeat intervals
           7x:        557 out of     56,872 (  1.0%) repeat intervals
           8x:        369 out of     56,872 (  0.6%) repeat intervals
           9x:        236 out of     56,872 (  0.4%) repeat intervals
       10-15x:        603 out of     56,872 (  1.1%) repeat intervals
       16-25x:        153 out of     56,872 (  0.3%) repeat intervals
       26-35x:         20 out of     56,872 (  0.0%) repeat intervals
       36-50x:          3 out of     56,872 (  0.0%) repeat intervals
         51+x:          1 out of     56,872 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of     56,872 (  0.0%) repeat intervals
          0.1:          9 out of     56,872 (  0.0%) repeat intervals
          0.2:         46 out of     56,872 (  0.1%) repeat intervals
          0.3:         94 out of     56,872 (  0.2%) repeat intervals
          0.4:         76 out of     56,872 (  0.1%) repeat intervals
          0.5:        628 out of     56,872 (  1.1%) repeat intervals
          0.6:      1,179 out of     56,872 (  2.1%) repeat intervals
          0.7:        327 out of     56,872 (  0.6%) repeat intervals
          0.8:        256 out of     56,872 (  0.5%) repeat intervals
          0.9:         84 out of     56,872 (  0.1%) repeat intervals
          1.0:     54,173 out of     56,872 ( 95.3%) repeat intervals

Mappability distribution:
          0.0:      4,217 out of     56,872 (  7.4%) loci
          0.1:      4,474 out of     56,872 (  7.9%) loci
          0.2:      4,920 out of     56,872 (  8.7%) loci
          0.3:      5,587 out of     56,872 (  9.8%) loci
          0.4:      7,059 out of     56,872 ( 12.4%) loci
          0.5:      7,692 out of     56,872 ( 13.5%) loci
          0.6:      5,105 out of     56,872 (  9.0%) loci
          0.7:      4,366 out of     56,872 (  7.7%) loci
          0.8:      4,157 out of     56,872 (  7.3%) loci
          0.9:      5,220 out of     56,872 (  9.2%) loci
          1.0:      4,075 out of     56,872 (  7.2%) loci
Wrote 1 rows to repeat_catalog_v1.hg38.7_to_1000bp.merged_and_annotated.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-14/7_to_1000bp/repeat_catalog_v1.hg38.7_to_1000bp catalog. Took 7h, 38m, 42s
