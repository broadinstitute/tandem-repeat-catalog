mkdir -p /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
mkdir -p /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
python3 -m str_analysis.split_adjacent_loci_in_expansion_hunter_catalog /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.json
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.json
Split 9 loci into 19 output records
Wrote 83 total records to variant_catalog_without_offtargets.GRCh38.split.json
sed -i 's/AARRG/AAAAG/g' /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json
gzip -f /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz
Wrote 63 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz

Filter stats:
        63 total input rows
        63 out of 63 (100%)  passed all filters
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.json.gz:
           63 total loci
        3,204 base pairs spanned by all loci (0.000% of the genome)
            0 out of         63 (  0.0%) loci define adjacent repeats
           63 total repeat intervals
           62 out of         63 ( 98.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of         63 (  0.0%) repeat intervals are homopolymers
            0 out of         63 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         63 ( 17.5%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 3-24bp
   Locus size range: 15-150bp
   Num repeats range: 2-50x repeats

   Max locus size =     150bp           @ chr13:102161574-102161724 (AAG)
   Min fraction pure bases   =  0.60    @ chr8:118366812-118366918 (AAAAT)
   Min fraction pure repeats =  0.00    @ chr13:99985448-99985493 (GCN)

          chrX:          7 out of         63 ( 11.1%) repeat intervals
          chrY:          0 out of         63 (  0.0%) repeat intervals
          chrM:          0 out of         63 (  0.0%) repeat intervals
   alt contigs:          0 out of         63 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of         63 (  0.0%) repeat intervals
          2bp:          0 out of         63 (  0.0%) repeat intervals
          3bp:         46 out of         63 ( 73.0%) repeat intervals
          4bp:          1 out of         63 (  1.6%) repeat intervals
          5bp:         10 out of         63 ( 15.9%) repeat intervals
          6bp:          2 out of         63 (  3.2%) repeat intervals
       7-24bp:          4 out of         63 (  6.3%) repeat intervals
        25+bp:          0 out of         63 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of         63 (  0.0%) repeat intervals
           2x:          1 out of         63 (  1.6%) repeat intervals
           3x:          2 out of         63 (  3.2%) repeat intervals
           4x:          3 out of         63 (  4.8%) repeat intervals
           5x:          2 out of         63 (  3.2%) repeat intervals
           6x:          2 out of         63 (  3.2%) repeat intervals
           7x:          4 out of         63 (  6.3%) repeat intervals
           8x:          1 out of         63 (  1.6%) repeat intervals
           9x:          1 out of         63 (  1.6%) repeat intervals
       10-15x:         26 out of         63 ( 41.3%) repeat intervals
       16-25x:         17 out of         63 ( 27.0%) repeat intervals
       26-35x:          2 out of         63 (  3.2%) repeat intervals
       36-50x:          2 out of         63 (  3.2%) repeat intervals
         51+x:          0 out of         63 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         63 ( 17.5%) repeat intervals
          0.1:          0 out of         63 (  0.0%) repeat intervals
          0.2:          0 out of         63 (  0.0%) repeat intervals
          0.3:          0 out of         63 (  0.0%) repeat intervals
          0.4:          0 out of         63 (  0.0%) repeat intervals
          0.5:          1 out of         63 (  1.6%) repeat intervals
          0.6:          0 out of         63 (  0.0%) repeat intervals
          0.7:          1 out of         63 (  1.6%) repeat intervals
          0.8:          6 out of         63 (  9.5%) repeat intervals
          0.9:          8 out of         63 ( 12.7%) repeat intervals
          1.0:         36 out of         63 ( 57.1%) repeat intervals

Locus sizes at each motif size:
     3bp motifs: locus size range:     15 bp to     150 bp  (median:   42 bp) based on         46 loci. Mean base purity: 0.91, mean repeat purity: 0.73.  
     4bp motifs: locus size range:     80 bp to      80 bp  (median:   80 bp) based on          1 loci. Mean base purity: 0.96, mean repeat purity: 0.85.  
     5bp motifs: locus size range:     35 bp to     106 bp  (median:   67 bp) based on         10 loci. Mean base purity: 0.96, mean repeat purity: 0.98.  
     6bp motifs: locus size range:     18 bp to      24 bp  (median:   21 bp) based on          2 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     20 bp to      20 bp  (median:   20 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    12bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    20bp motifs: locus size range:     80 bp to      80 bp  (median:   80 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    24bp motifs: locus size range:     96 bp to      96 bp  (median:   96 bp) based on          1 loci. Mean base purity: 0.96, mean repeat purity: 0.50.  
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.primary_disease_associated_loci.catalog_stats.tsv
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
mkdir -p 1_to_1000bp_motifs
cd 1_to_1000bp_motifs
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Wrote 83 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        83 out of 83 (100%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
           83 total loci
        3,770 base pairs spanned by all loci (0.000% of the genome)
            0 out of         83 (  0.0%) loci define adjacent repeats
           83 total repeat intervals
           82 out of         83 ( 98.8%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            1 out of         83 (  1.2%) repeat intervals are homopolymers
            0 out of         83 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         83 ( 13.3%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 1-27bp
   Locus size range: 6-150bp
   Num repeats range: 1-50x repeats

   Max locus size =     150bp           @ chr13:102161574-102161724 (AAG)
   Min fraction pure bases   =  0.60    @ chr8:118366812-118366918 (AAAAT)
   Min fraction pure repeats =  0.00    @ chr13:99985448-99985493 (GCN)

          chrX:         11 out of         83 ( 13.3%) repeat intervals
          chrY:          0 out of         83 (  0.0%) repeat intervals
          chrM:          0 out of         83 (  0.0%) repeat intervals
   alt contigs:          0 out of         83 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          1 out of         83 (  1.2%) repeat intervals
          2bp:          1 out of         83 (  1.2%) repeat intervals
          3bp:         60 out of         83 ( 72.3%) repeat intervals
          4bp:          2 out of         83 (  2.4%) repeat intervals
          5bp:         10 out of         83 ( 12.0%) repeat intervals
          6bp:          4 out of         83 (  4.8%) repeat intervals
       7-24bp:          4 out of         83 (  4.8%) repeat intervals
        25+bp:          1 out of         83 (  1.2%) repeat intervals

Num repeats in reference:
           1x:          1 out of         83 (  1.2%) repeat intervals
           2x:          3 out of         83 (  3.6%) repeat intervals
           3x:          3 out of         83 (  3.6%) repeat intervals
           4x:          4 out of         83 (  4.8%) repeat intervals
           5x:          2 out of         83 (  2.4%) repeat intervals
           6x:          2 out of         83 (  2.4%) repeat intervals
           7x:          5 out of         83 (  6.0%) repeat intervals
           8x:          5 out of         83 (  6.0%) repeat intervals
           9x:          2 out of         83 (  2.4%) repeat intervals
       10-15x:         31 out of         83 ( 37.3%) repeat intervals
       16-25x:         21 out of         83 ( 25.3%) repeat intervals
       26-35x:          2 out of         83 (  2.4%) repeat intervals
       36-50x:          2 out of         83 (  2.4%) repeat intervals
         51+x:          0 out of         83 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         83 ( 13.3%) repeat intervals
          0.1:          0 out of         83 (  0.0%) repeat intervals
          0.2:          0 out of         83 (  0.0%) repeat intervals
          0.3:          0 out of         83 (  0.0%) repeat intervals
          0.4:          0 out of         83 (  0.0%) repeat intervals
          0.5:          1 out of         83 (  1.2%) repeat intervals
          0.6:          0 out of         83 (  0.0%) repeat intervals
          0.7:          2 out of         83 (  2.4%) repeat intervals
          0.8:          8 out of         83 (  9.6%) repeat intervals
          0.9:          9 out of         83 ( 10.8%) repeat intervals
          1.0:         52 out of         83 ( 62.7%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:     25 bp to      25 bp  (median:   25 bp) based on          1 loci. Mean base purity: 0.92, mean repeat purity: 0.92.  
     2bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      6 bp to     150 bp  (median:   39 bp) based on         60 loci. Mean base purity: 0.93, mean repeat purity: 0.78.  
     4bp motifs: locus size range:     40 bp to      80 bp  (median:   60 bp) based on          2 loci. Mean base purity: 0.98, mean repeat purity: 0.93.  
     5bp motifs: locus size range:     35 bp to     106 bp  (median:   67 bp) based on         10 loci. Mean base purity: 0.96, mean repeat purity: 0.98.  
     6bp motifs: locus size range:     12 bp to      24 bp  (median:   18 bp) based on          4 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     20 bp to      20 bp  (median:   20 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    12bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    20bp motifs: locus size range:     80 bp to      80 bp  (median:   80 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    24bp motifs: locus size range:     96 bp to      96 bp  (median:   96 bp) based on          1 loci. Mean base purity: 0.96, mean repeat purity: 0.50.  
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 174,286 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   174,286 out of 174,286 (100%)  passed all filters

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
      174,286 total loci
    4,623,031 base pairs spanned by all loci (0.150% of the genome)
            0 out of    174,286 (  0.0%) loci define adjacent repeats
      174,286 total repeat intervals
      174,262 out of    174,286 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
          365 out of    174,286 (  0.2%) repeat intervals are homopolymers
            0 out of    174,286 (  0.0%) repeat intervals overlap each other by at least two motif lengths
            1 out of    174,286 (  0.0%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 1-24bp
   Locus size range: 4-532bp
   Num repeats range: 2-133x repeats

   Max locus size =     532bp           @ chr7:138621782-138622314 (TATC)
   Min fraction pure bases   =  0.43    @ chr3:112804380-112804514 (TCT)
   Min fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)

          chrX:      8,561 out of    174,286 (  4.9%) repeat intervals
          chrY:          0 out of    174,286 (  0.0%) repeat intervals
          chrM:          0 out of    174,286 (  0.0%) repeat intervals
   alt contigs:          0 out of    174,286 (  0.0%) repeat intervals

Motif size distribution:
          1bp:        365 out of    174,286 (  0.2%) repeat intervals
          2bp:     98,531 out of    174,286 ( 56.5%) repeat intervals
          3bp:     14,442 out of    174,286 (  8.3%) repeat intervals
          4bp:     43,263 out of    174,286 ( 24.8%) repeat intervals
          5bp:     12,551 out of    174,286 (  7.2%) repeat intervals
          6bp:      3,931 out of    174,286 (  2.3%) repeat intervals
       7-24bp:      1,203 out of    174,286 (  0.7%) repeat intervals
        25+bp:          0 out of    174,286 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of    174,286 (  0.0%) repeat intervals
           2x:      8,780 out of    174,286 (  5.0%) repeat intervals
           3x:      6,543 out of    174,286 (  3.8%) repeat intervals
           4x:      8,882 out of    174,286 (  5.1%) repeat intervals
           5x:     11,884 out of    174,286 (  6.8%) repeat intervals
           6x:     13,900 out of    174,286 (  8.0%) repeat intervals
           7x:     14,915 out of    174,286 (  8.6%) repeat intervals
           8x:     13,902 out of    174,286 (  8.0%) repeat intervals
           9x:     12,532 out of    174,286 (  7.2%) repeat intervals
       10-15x:     49,952 out of    174,286 ( 28.7%) repeat intervals
       16-25x:     31,237 out of    174,286 ( 17.9%) repeat intervals
       26-35x:      1,729 out of    174,286 (  1.0%) repeat intervals
       36-50x:         24 out of    174,286 (  0.0%) repeat intervals
         51+x:          6 out of    174,286 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of    174,286 (  0.0%) repeat intervals
          0.1:          0 out of    174,286 (  0.0%) repeat intervals
          0.2:          0 out of    174,286 (  0.0%) repeat intervals
          0.3:          0 out of    174,286 (  0.0%) repeat intervals
          0.4:          0 out of    174,286 (  0.0%) repeat intervals
          0.5:          0 out of    174,286 (  0.0%) repeat intervals
          0.6:         25 out of    174,286 (  0.0%) repeat intervals
          0.7:        566 out of    174,286 (  0.3%) repeat intervals
          0.8:      4,113 out of    174,286 (  2.4%) repeat intervals
          0.9:      3,180 out of    174,286 (  1.8%) repeat intervals
          1.0:    166,401 out of    174,286 ( 95.5%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      4 bp to      36 bp  (median:   22 bp) based on        365 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     2bp motifs: locus size range:      4 bp to      82 bp  (median:   24 bp) based on     98,531 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      6 bp to     240 bp  (median:   27 bp) based on     14,442 loci. Mean base purity: 0.99, mean repeat purity: 0.98.  
     4bp motifs: locus size range:      8 bp to     532 bp  (median:   24 bp) based on     43,263 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     5bp motifs: locus size range:     10 bp to     220 bp  (median:   25 bp) based on     12,551 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     6bp motifs: locus size range:     12 bp to     106 bp  (median:   24 bp) based on      3,931 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     7bp motifs: locus size range:     14 bp to      70 bp  (median:   14 bp) based on        630 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     16 bp to      72 bp  (median:   16 bp) based on        428 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     18 bp to      90 bp  (median:   27 bp) based on         34 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
    10bp motifs: locus size range:     20 bp to      60 bp  (median:   30 bp) based on         15 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 4,558,281 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 4,558,281 out of 4,558,281 (100%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    4,558,281 total loci
   62,504,037 base pairs spanned by all loci (2.024% of the genome)
            0 out of  4,558,281 (  0.0%) loci define adjacent repeats
    4,558,281 total repeat intervals
    2,799,051 out of  4,558,281 ( 61.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,337,567 out of  4,558,281 ( 29.3%) repeat intervals are homopolymers
            0 out of  4,558,281 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-833bp
   Locus size range: 9-2523bp
   Num repeats range: 3-300x repeats

   Max locus size =   2,523bp           @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  1.00    @ chrY:56887882-56887891 (TGA)
   Min fraction pure repeats =  1.00    @ chrY:56887882-56887891 (TGA)

          chrX:    232,977 out of  4,558,281 (  5.1%) repeat intervals
          chrY:     38,867 out of  4,558,281 (  0.9%) repeat intervals
          chrM:         14 out of  4,558,281 (  0.0%) repeat intervals
   alt contigs:          0 out of  4,558,281 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,337,567 out of  4,558,281 ( 29.3%) repeat intervals
          2bp:    967,389 out of  4,558,281 ( 21.2%) repeat intervals
          3bp:  1,418,341 out of  4,558,281 ( 31.1%) repeat intervals
          4bp:    569,907 out of  4,558,281 ( 12.5%) repeat intervals
          5bp:    172,187 out of  4,558,281 (  3.8%) repeat intervals
          6bp:     52,023 out of  4,558,281 (  1.1%) repeat intervals
       7-24bp:     31,185 out of  4,558,281 (  0.7%) repeat intervals
        25+bp:      9,682 out of  4,558,281 (  0.2%) repeat intervals

Num repeats in reference:
           1x:          0 out of  4,558,281 (  0.0%) repeat intervals
           2x:          0 out of  4,558,281 (  0.0%) repeat intervals
           3x:  1,787,359 out of  4,558,281 ( 39.2%) repeat intervals
           4x:    641,281 out of  4,558,281 ( 14.1%) repeat intervals
           5x:    353,723 out of  4,558,281 (  7.8%) repeat intervals
           6x:    148,753 out of  4,558,281 (  3.3%) repeat intervals
           7x:     76,841 out of  4,558,281 (  1.7%) repeat intervals
           8x:     43,343 out of  4,558,281 (  1.0%) repeat intervals
           9x:    352,151 out of  4,558,281 (  7.7%) repeat intervals
       10-15x:    756,034 out of  4,558,281 ( 16.6%) repeat intervals
       16-25x:    347,635 out of  4,558,281 (  7.6%) repeat intervals
       26-35x:     45,324 out of  4,558,281 (  1.0%) repeat intervals
       36-50x:      5,550 out of  4,558,281 (  0.1%) repeat intervals
         51+x:        287 out of  4,558,281 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.1:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.2:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.3:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.4:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.5:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.6:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.7:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.8:          0 out of  4,558,281 (  0.0%) repeat intervals
          0.9:          0 out of  4,558,281 (  0.0%) repeat intervals
          1.0:  4,558,281 out of  4,558,281 (100.0%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      9 bp to      90 bp  (median:   12 bp) based on  1,337,567 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     2bp motifs: locus size range:      9 bp to     600 bp  (median:   10 bp) based on    967,389 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      9 bp to     632 bp  (median:    9 bp) based on  1,418,341 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     4bp motifs: locus size range:     12 bp to     533 bp  (median:   15 bp) based on    569,907 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     5bp motifs: locus size range:     15 bp to     341 bp  (median:   18 bp) based on    172,187 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     6bp motifs: locus size range:     18 bp to   1,103 bp  (median:   21 bp) based on     52,023 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     7bp motifs: locus size range:     21 bp to     151 bp  (median:   23 bp) based on     13,079 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     24 bp to     149 bp  (median:   26 bp) based on      5,531 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     27 bp to     116 bp  (median:   29 bp) based on      2,284 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     30 bp to     111 bp  (median:   34 bp) based on      1,693 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
   min_motif_size =               1
   min_interval_size_bp =         1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Wrote 1,937,160 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Filter stats:
 1,937,805 total input rows
 1,937,160 out of 1,937,805 (100%)  passed all filters
       645 out of 1,937,805 ( 0%)  row reference sequence has invalid bases

Modification stats:
     4,879 out of 1,937,805 ( 0%)  replaced 4bp motif with a simplified 2bp motif
       235 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 2bp motif
        79 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        69 out of 1,937,805 ( 0%)  replaced 8bp motif with a simplified 4bp motif
         4 out of 1,937,805 ( 0%)  replaced 9bp motif with a simplified 3bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 2bp motif
         2 out of 1,937,805 ( 0%)  replaced 12bp motif with a simplified 4bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         1 out of 1,937,805 ( 0%)  replaced 15bp motif with a simplified 5bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Stats for merged_expansion_hunter_catalog.78_samples.filtered.json.gz:
    1,937,160 total loci
   31,350,936 base pairs spanned by all loci (1.015% of the genome)
            0 out of  1,937,160 (  0.0%) loci define adjacent repeats
    1,937,160 total repeat intervals
    1,937,160 out of  1,937,160 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,400,310 out of  1,937,160 ( 72.3%) repeat intervals are homopolymers
       20,352 out of  1,937,160 (  1.1%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr10:121171881-121171976, chr4:156620010-156620034, chr2:104519289-104519337, chr19:57137842-57138082, chr10:128648776-128648830, chr4:6336725-6336825, chr2:100520022-100520062, chr14:64859718-64859736, chr19:53521327-53521363, chr4:89380965-89381001

Ranges:
   Motif size range: 1-833bp
   Locus size range: 1-2499bp
   Num repeats range: 1-300x repeats

   Max locus size =   2,499bp           @ chrX:71520430-71522929 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  0.68    @ chr20:22538965-22539037 (CCT)
   Min fraction pure repeats =  0.03    @ chr11:133140745-133140859 (GAG)

          chrX:     83,664 out of  1,937,160 (  4.3%) repeat intervals
          chrY:      5,755 out of  1,937,160 (  0.3%) repeat intervals
          chrM:          0 out of  1,937,160 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,937,160 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,400,310 out of  1,937,160 ( 72.3%) repeat intervals
          2bp:    249,968 out of  1,937,160 ( 12.9%) repeat intervals
          3bp:     68,910 out of  1,937,160 (  3.6%) repeat intervals
          4bp:    131,029 out of  1,937,160 (  6.8%) repeat intervals
          5bp:     35,605 out of  1,937,160 (  1.8%) repeat intervals
          6bp:     14,601 out of  1,937,160 (  0.8%) repeat intervals
       7-24bp:     24,757 out of  1,937,160 (  1.3%) repeat intervals
        25+bp:     11,980 out of  1,937,160 (  0.6%) repeat intervals

Num repeats in reference:
           1x:     10,584 out of  1,937,160 (  0.5%) repeat intervals
           2x:     33,359 out of  1,937,160 (  1.7%) repeat intervals
           3x:     72,960 out of  1,937,160 (  3.8%) repeat intervals
           4x:     58,053 out of  1,937,160 (  3.0%) repeat intervals
           5x:     66,750 out of  1,937,160 (  3.4%) repeat intervals
           6x:     57,218 out of  1,937,160 (  3.0%) repeat intervals
           7x:     51,632 out of  1,937,160 (  2.7%) repeat intervals
           8x:    246,878 out of  1,937,160 ( 12.7%) repeat intervals
           9x:    240,065 out of  1,937,160 ( 12.4%) repeat intervals
       10-15x:    700,636 out of  1,937,160 ( 36.2%) repeat intervals
       16-25x:    346,599 out of  1,937,160 ( 17.9%) repeat intervals
       26-35x:     46,087 out of  1,937,160 (  2.4%) repeat intervals
       36-50x:      5,925 out of  1,937,160 (  0.3%) repeat intervals
         51+x:        414 out of  1,937,160 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        200 out of  1,937,160 (  0.0%) repeat intervals
          0.1:      1,212 out of  1,937,160 (  0.1%) repeat intervals
          0.2:      1,939 out of  1,937,160 (  0.1%) repeat intervals
          0.3:      1,955 out of  1,937,160 (  0.1%) repeat intervals
          0.4:      1,402 out of  1,937,160 (  0.1%) repeat intervals
          0.5:      6,214 out of  1,937,160 (  0.3%) repeat intervals
          0.6:     12,675 out of  1,937,160 (  0.7%) repeat intervals
          0.7:      5,833 out of  1,937,160 (  0.3%) repeat intervals
          0.8:      7,232 out of  1,937,160 (  0.4%) repeat intervals
          0.9:      8,118 out of  1,937,160 (  0.4%) repeat intervals
          1.0:  1,890,380 out of  1,937,160 ( 97.6%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      1 bp to      90 bp  (median:   11 bp) based on  1,400,310 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     2bp motifs: locus size range:      2 bp to     600 bp  (median:   18 bp) based on    249,968 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      3 bp to     561 bp  (median:   12 bp) based on     68,910 loci. Mean base purity: 0.98, mean repeat purity: 0.95.  
     4bp motifs: locus size range:      4 bp to     472 bp  (median:   20 bp) based on    131,029 loci. Mean base purity: 0.99, mean repeat purity: 0.94.  
     5bp motifs: locus size range:      5 bp to     400 bp  (median:   20 bp) based on     35,605 loci. Mean base purity: 1.00, mean repeat purity: 0.98.  
     6bp motifs: locus size range:      6 bp to     498 bp  (median:   18 bp) based on     14,601 loci. Mean base purity: 0.99, mean repeat purity: 0.93.  
     7bp motifs: locus size range:      7 bp to     546 bp  (median:   21 bp) based on      4,996 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
     8bp motifs: locus size range:      8 bp to     312 bp  (median:   24 bp) based on      3,579 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
     9bp motifs: locus size range:      9 bp to     243 bp  (median:   27 bp) based on      1,880 loci. Mean base purity: 0.99, mean repeat purity: 0.95.  
    10bp motifs: locus size range:     10 bp to     260 bp  (median:   30 bp) based on      1,886 loci. Mean base purity: 0.99, mean repeat purity: 0.93.  
Wrote 1 rows to merged_expansion_hunter_catalog.78_samples.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --write-merge-stats-tsv  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
Added 83 out of 83 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 174,244 out of 174,286 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 174,244 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 4,391,201 out of 4,558,281 ( 96.3%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 4,391,201 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 297,532 out of 1,937,160 ( 15.4%) records from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to the output catalog
Wrote 297,532 unique loci from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to merged_expansion_hunter_catalog.78_samples.filtered.unique_loci.bed.gz
Done writing 4,863,060 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.merged.json.gz
Wrote 4 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.merged.merge_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 1  --max-motif-size 1000  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.merged.json.gz
Wrote 4,863,043 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
python3 << EOF
import gzip, ijson, json

f = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz", "rt")
out = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.json.gz", "wt")
out.write("[")
for record in ijson.items(f, "item", use_float=True): 
	out.write(json.dumps({ 
  k: v for k, v in record.items() if k not in {"LocusId", "ReferenceRegion", "VariantType", "LocusStructure"} 
	}, indent=4))
out.write("]")
EOF

cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/merged_expansion_hunter_catalog.78_samples.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-catalog-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz  --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz  --output-variation-clusters-bed-path variation_clusters_v1.hg38.TRGT.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Found 727,553 out of 3,147,421 (23.1%) locus IDs in the input catalog were in variation clusters
Found 2,419,868 out of 2,724,345 (88.8%) variation clusters did not change the original locus boundaries by 5 bases or more
Wrote 307,659 out of 2,724,345 (11.3%) variation clusters to variation_clusters_v1.hg38.TRGT.bed.gz
Found 307,659 out of 2,724,345 (11.3%) variation clusters that differed from locus definitions in the input catalog /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
4,828,462 out of 4,863,043 (99.3%) loci from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz are not in variation clusters
Wrote 4,863,043 out of 4,863,043 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote 4,863,043 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote 4,863,043 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.TRGT.bed
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/validate_catalog.py --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz --check-for-presence-of-annotations --check-for-presence-of-all-known-loci /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Done. Catalog passed validation.
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.bed.gz.tbi /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
bgzip -f /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.TRGT.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.TRGT.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
bgzip -f /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.LongTR.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.LongTR.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
bgzip -f /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.HipSTR.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.HipSTR.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
bgzip -f /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.GangSTR.bed
cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.GangSTR.bed.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz

Stats for simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz:
    4,863,043 total loci
   65,678,129 base pairs spanned by all loci (2.127% of the genome)
            0 out of  4,863,043 (  0.0%) loci define adjacent repeats
    4,863,043 total repeat intervals
    3,210,117 out of  4,863,043 ( 66.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,567,337 out of  4,863,043 ( 32.2%) repeat intervals are homopolymers
       18,340 out of  4,863,043 (  0.4%) repeat intervals overlap each other by at least two motif lengths
           11 out of  4,863,043 (  0.0%) repeat intervals have non-ACGT motifs
Examples of overlapping repeats: chr6:157039646-157039697, chr6:136309907-136309923, chr16:22663061-22663108, chr10:118053197-118053242, chr9:72024653-72024669, chr1:193880089-193880107, chr11:68644599-68644607, chr8:112342983-112342999, chr12:100569922-100569982, chr16:53171861-53171902

Ranges:
   Motif size range: 1-833bp
   Locus size range: 1-2523bp
   Num repeats range: 1-300x repeats

   Max locus size =   2,523bp           @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  0.43    @ chr3:112804380-112804514 (TCT)
   Min fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)
   Min overall mappability   =  0.00    @ chrY:56887882-56887891 (TGA)

          chrX:    244,192 out of  4,863,043 (  5.0%) repeat intervals
          chrY:     39,257 out of  4,863,043 (  0.8%) repeat intervals
          chrM:         14 out of  4,863,043 (  0.0%) repeat intervals
   alt contigs:          0 out of  4,863,043 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,567,337 out of  4,863,043 ( 32.2%) repeat intervals
          2bp:    978,973 out of  4,863,043 ( 20.1%) repeat intervals
          3bp:  1,432,118 out of  4,863,043 ( 29.4%) repeat intervals
          4bp:    590,787 out of  4,863,043 ( 12.1%) repeat intervals
          5bp:    177,422 out of  4,863,043 (  3.6%) repeat intervals
          6bp:     56,731 out of  4,863,043 (  1.2%) repeat intervals
       7-24bp:     43,996 out of  4,863,043 (  0.9%) repeat intervals
        25+bp:     15,679 out of  4,863,043 (  0.3%) repeat intervals

Num repeats in reference:
           1x:     10,444 out of  4,863,043 (  0.2%) repeat intervals
           2x:     38,922 out of  4,863,043 (  0.8%) repeat intervals
           3x:  1,799,189 out of  4,863,043 ( 37.0%) repeat intervals
           4x:    650,397 out of  4,863,043 ( 13.4%) repeat intervals
           5x:    356,525 out of  4,863,043 (  7.3%) repeat intervals
           6x:    151,893 out of  4,863,043 (  3.1%) repeat intervals
           7x:     85,761 out of  4,863,043 (  1.8%) repeat intervals
           8x:    257,475 out of  4,863,043 (  5.3%) repeat intervals
           9x:    352,993 out of  4,863,043 (  7.3%) repeat intervals
       10-15x:    759,188 out of  4,863,043 ( 15.6%) repeat intervals
       16-25x:    348,837 out of  4,863,043 (  7.2%) repeat intervals
       26-35x:     45,478 out of  4,863,043 (  0.9%) repeat intervals
       36-50x:      5,610 out of  4,863,043 (  0.1%) repeat intervals
         51+x:        331 out of  4,863,043 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        211 out of  4,863,043 (  0.0%) repeat intervals
          0.1:      1,200 out of  4,863,043 (  0.0%) repeat intervals
          0.2:      1,842 out of  4,863,043 (  0.0%) repeat intervals
          0.3:      1,711 out of  4,863,043 (  0.0%) repeat intervals
          0.4:      1,112 out of  4,863,043 (  0.0%) repeat intervals
          0.5:      5,536 out of  4,863,043 (  0.1%) repeat intervals
          0.6:     11,194 out of  4,863,043 (  0.2%) repeat intervals
          0.7:      3,902 out of  4,863,043 (  0.1%) repeat intervals
          0.8:      5,041 out of  4,863,043 (  0.1%) repeat intervals
          0.9:      3,330 out of  4,863,043 (  0.1%) repeat intervals
          1.0:  4,827,964 out of  4,863,043 ( 99.3%) repeat intervals

Mappability distribution:
          0.0:    154,279 out of  4,863,043 (  3.2%) loci
          0.1:    214,471 out of  4,863,043 (  4.4%) loci
          0.2:    246,877 out of  4,863,043 (  5.1%) loci
          0.3:    236,856 out of  4,863,043 (  4.9%) loci
          0.4:    391,389 out of  4,863,043 (  8.0%) loci
          0.5:    561,639 out of  4,863,043 ( 11.5%) loci
          0.6:    352,273 out of  4,863,043 (  7.2%) loci
          0.7:    306,208 out of  4,863,043 (  6.3%) loci
          0.8:    337,715 out of  4,863,043 (  6.9%) loci
          0.9:    626,048 out of  4,863,043 ( 12.9%) loci
          1.0:  1,435,288 out of  4,863,043 ( 29.5%) loci

Locus sizes at each motif size:
     1bp motifs: locus size range:      1 bp to      90 bp  (median:   11 bp) based on  1,567,337 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.66
     2bp motifs: locus size range:      2 bp to     600 bp  (median:   10 bp) based on    978,973 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.76
     3bp motifs: locus size range:      3 bp to     632 bp  (median:    9 bp) based on  1,432,118 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.75
     4bp motifs: locus size range:      4 bp to     533 bp  (median:   14 bp) based on    590,787 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.68
     5bp motifs: locus size range:      5 bp to     400 bp  (median:   18 bp) based on    177,422 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.61
     6bp motifs: locus size range:      6 bp to   1,103 bp  (median:   20 bp) based on     56,731 loci. Mean base purity: 1.00, mean repeat purity: 0.98.  Mean mappability: 0.62
     7bp motifs: locus size range:      7 bp to     151 bp  (median:   22 bp) based on     15,083 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.58
     8bp motifs: locus size range:      8 bp to     312 bp  (median:   25 bp) based on      7,107 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.57
     9bp motifs: locus size range:      9 bp to     153 bp  (median:   28 bp) based on      3,231 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  Mean mappability: 0.51
    10bp motifs: locus size range:     10 bp to     150 bp  (median:   31 bp) based on      2,713 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.50
Wrote 1 rows to simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs catalog. Took 1h, 38m, 60s
wget -O hg38_ver17.bed.gz.tmp -qnc https://s3.amazonaws.com/gangstr/hg38/genomewide/hg38_ver17.bed.gz && mv hg38_ver17.bed.gz.tmp hg38_ver17.bed.gz
wget -O vamos_catalog.v2.1.bed.gz.tmp -qnc https://storage.googleapis.com/str-truth-set/hg38/ref/other/vamos_catalog.v2.1.bed.gz && mv vamos_catalog.v2.1.bed.gz.tmp vamos_catalog.v2.1.bed.gz
python3 -u -m str_analysis.convert_gangstr_spec_to_expansion_hunter_variant_catalog --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.bed.gz -o /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.bed.gz
Writing records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.json.gz
Stats: {'total input loci': 1340266, 'trimmed locus': 1340266}
Wrote 1,340,266 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.json.gz
python3 -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --min-motif-size 1  --max-motif-size 1000  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz  --verbose  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.json.gz
   min_motif_size =               1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_motif =  False
   discard_loci_with_non_ACGT_bases_in_reference =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.json.gz
Wrote 1,340,266 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz

Filter stats:
 1,340,266 total input rows
 1,340,266 out of 1,340,266 (100%)  passed all filters
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz

Stats for hg38_ver17.filtered.json.gz:
    1,340,266 total loci
   22,952,364 base pairs spanned by all loci (0.743% of the genome)
            0 out of  1,340,266 (  0.0%) loci define adjacent repeats
    1,340,266 total repeat intervals
    1,340,266 out of  1,340,266 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
      488,668 out of  1,340,266 ( 36.5%) repeat intervals are homopolymers
           16 out of  1,340,266 (  0.0%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr9:27573523-27573541, chr5:146878728-146878758, chr11:2171085-2171113, chr2:1489650-1489682, chr2:1489652-1489684, chr11:2171087-2171115, chr5:123775555-123775599, chr15:96831014-96831039, chr5:146878727-146878757, chr7:84160224-84160276

Ranges:
   Motif size range: 1-20bp
   Locus size range: 10-612bp
   Num repeats range: 3-248x repeats

   Max locus size =     612bp           @ chr4:10134483-10135095 (ATCCCAATTGATGGAGA)
   Min fraction pure bases   =  0.95    @ chr6:170561907-170562021 (CAG)
   Min fraction pure repeats =  0.84    @ chr6:170561907-170562021 (CAG)

          chrX:     65,719 out of  1,340,266 (  4.9%) repeat intervals
          chrY:      8,979 out of  1,340,266 (  0.7%) repeat intervals
          chrM:          0 out of  1,340,266 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,340,266 (  0.0%) repeat intervals

Motif size distribution:
          1bp:    488,668 out of  1,340,266 ( 36.5%) repeat intervals
          2bp:    179,518 out of  1,340,266 ( 13.4%) repeat intervals
          3bp:    150,463 out of  1,340,266 ( 11.2%) repeat intervals
          4bp:    377,644 out of  1,340,266 ( 28.2%) repeat intervals
          5bp:    106,135 out of  1,340,266 (  7.9%) repeat intervals
          6bp:     27,654 out of  1,340,266 (  2.1%) repeat intervals
       7-24bp:     10,184 out of  1,340,266 (  0.8%) repeat intervals
        25+bp:          0 out of  1,340,266 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of  1,340,266 (  0.0%) repeat intervals
           2x:          0 out of  1,340,266 (  0.0%) repeat intervals
           3x:    365,043 out of  1,340,266 ( 27.2%) repeat intervals
           4x:    178,164 out of  1,340,266 ( 13.3%) repeat intervals
           5x:     62,042 out of  1,340,266 (  4.6%) repeat intervals
           6x:     81,945 out of  1,340,266 (  6.1%) repeat intervals
           7x:     41,195 out of  1,340,266 (  3.1%) repeat intervals
           8x:     22,799 out of  1,340,266 (  1.7%) repeat intervals
           9x:     15,022 out of  1,340,266 (  1.1%) repeat intervals
       10-15x:    270,718 out of  1,340,266 ( 20.2%) repeat intervals
       16-25x:    260,685 out of  1,340,266 ( 19.5%) repeat intervals
       26-35x:     37,641 out of  1,340,266 (  2.8%) repeat intervals
       36-50x:      4,785 out of  1,340,266 (  0.4%) repeat intervals
         51+x:        227 out of  1,340,266 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.1:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.2:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.3:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.4:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.5:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.6:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.7:          0 out of  1,340,266 (  0.0%) repeat intervals
          0.8:          1 out of  1,340,266 (  0.0%) repeat intervals
          0.9:          3 out of  1,340,266 (  0.0%) repeat intervals
          1.0:  1,340,262 out of  1,340,266 (100.0%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:     12 bp to      90 bp  (median:   16 bp) based on    488,668 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     2bp motifs: locus size range:     10 bp to     496 bp  (median:   16 bp) based on    179,518 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:     12 bp to     180 bp  (median:   12 bp) based on    150,463 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     4bp motifs: locus size range:     12 bp to     332 bp  (median:   12 bp) based on    377,644 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     5bp motifs: locus size range:     15 bp to     305 bp  (median:   15 bp) based on    106,135 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     6bp motifs: locus size range:     18 bp to     372 bp  (median:   18 bp) based on     27,654 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     7bp motifs: locus size range:     21 bp to     119 bp  (median:   21 bp) based on      5,708 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     24 bp to     144 bp  (median:   24 bp) based on      1,707 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     27 bp to     108 bp  (median:   27 bp) based on        760 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     30 bp to     110 bp  (median:   30 bp) based on        344 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to hg38_ver17.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --output-prefix GangSTR_v17  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --verbose  --write-merge-stats-tsv  --write-bed-files-with-new-loci  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Added 4,863,043 out of 4,863,043 (100.0%) records from simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz to the output catalog
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/hg38_ver17.filtered.json.gz
Added 0 out of 1,340,266 (  0.0%) records from hg38_ver17.filtered.json.gz to the output catalog
    Discarded 1,312,872 out of 1,340,266 ( 98.0%) records since they overlapped an existing locus by at least 66.0% and had the exact same LocusStructure
    Discarded  27,394 out of 1,340,266 (  2.0%) records since they overlapped an existing locus by at least 66.0% and had the same canonical motif
Wrote 0 unique loci from hg38_ver17.filtered.json.gz to hg38_ver17.filtered.unique_loci.bed.gz
Writing combined catalog to GangSTR_v17.json.gz
Done writing 4,863,043 output records to GangSTR_v17.json.gz
Source of loci in output catalog:
   4,863,043 out of 4,863,043 (100.0%) simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Motif sizes:
   1,567,337 out of 4,863,043 (32.2%) 1bp
   1,432,118 out of 4,863,043 (29.4%) 3bp
     978,973 out of 4,863,043 (20.1%) 2bp
     590,787 out of 4,863,043 (12.1%) 4bp
     177,422 out of 4,863,043 ( 3.6%) 5bp
      59,675 out of 4,863,043 ( 1.2%) 7+bp
      56,731 out of 4,863,043 ( 1.2%) 6bp
Chromsomes:
   4,579,580 out of 4,863,043 (94.2%) are on autosomes
     244,192 out of 4,863,043 ( 5.0%) are on X
      39,257 out of 4,863,043 ( 0.8%) are on Y
          14 out of 4,863,043 ( 0.0%) are on M
Wrote 2 rows to GangSTR_v17.merge_stats.tsv
python3 -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --min-motif-size 1  --max-motif-size 1000  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz  --verbose  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.bed.gz
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz
   min_motif_size =               1
   max_motif_size =               1000
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_motif =  False
   discard_loci_with_non_ACGT_bases_in_reference =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.bed.gz
Wrote 1,243,954 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz

Filter stats:
 1,243,954 total input rows
 1,243,954 out of 1,243,954 (100%)  passed all filters

Modification stats:
    12,221 out of 1,243,954 ( 1%)  replaced 4bp motif with a simplified 2bp motif
     3,535 out of 1,243,954 ( 0%)  replaced 6bp motif with a simplified 2bp motif
     3,149 out of 1,243,954 ( 0%)  replaced 6bp motif with a simplified 3bp motif
     3,046 out of 1,243,954 ( 0%)  replaced 4bp motif with a simplified 1bp motif
     2,153 out of 1,243,954 ( 0%)  replaced 3bp motif with a simplified 1bp motif
     2,057 out of 1,243,954 ( 0%)  replaced 5bp motif with a simplified 1bp motif
     1,899 out of 1,243,954 ( 0%)  replaced 2bp motif with a simplified 1bp motif
     1,214 out of 1,243,954 ( 0%)  replaced 6bp motif with a simplified 1bp motif
       901 out of 1,243,954 ( 0%)  replaced 10bp motif with a simplified 1bp motif
       794 out of 1,243,954 ( 0%)  replaced 8bp motif with a simplified 4bp motif
       736 out of 1,243,954 ( 0%)  replaced 12bp motif with a simplified 4bp motif
       725 out of 1,243,954 ( 0%)  replaced 11bp motif with a simplified 1bp motif
       647 out of 1,243,954 ( 0%)  replaced 7bp motif with a simplified 1bp motif
       596 out of 1,243,954 ( 0%)  replaced 10bp motif with a simplified 5bp motif
       567 out of 1,243,954 ( 0%)  replaced 12bp motif with a simplified 1bp motif
       482 out of 1,243,954 ( 0%)  replaced 12bp motif with a simplified 6bp motif
       482 out of 1,243,954 ( 0%)  replaced 9bp motif with a simplified 1bp motif
       434 out of 1,243,954 ( 0%)  replaced 13bp motif with a simplified 1bp motif
       356 out of 1,243,954 ( 0%)  replaced 8bp motif with a simplified 1bp motif
       197 out of 1,243,954 ( 0%)  replaced 8bp motif with a simplified 2bp motif
       177 out of 1,243,954 ( 0%)  replaced 14bp motif with a simplified 1bp motif
       170 out of 1,243,954 ( 0%)  replaced 14bp motif with a simplified 7bp motif
       105 out of 1,243,954 ( 0%)  replaced 10bp motif with a simplified 2bp motif
        95 out of 1,243,954 ( 0%)  replaced 16bp motif with a simplified 8bp motif
        91 out of 1,243,954 ( 0%)  replaced 15bp motif with a simplified 1bp motif
        73 out of 1,243,954 ( 0%)  replaced 12bp motif with a simplified 2bp motif
        58 out of 1,243,954 ( 0%)  replaced 15bp motif with a simplified 5bp motif
        56 out of 1,243,954 ( 0%)  replaced 16bp motif with a simplified 4bp motif
        53 out of 1,243,954 ( 0%)  replaced 16bp motif with a simplified 1bp motif
        51 out of 1,243,954 ( 0%)  replaced 9bp motif with a simplified 3bp motif
        47 out of 1,243,954 ( 0%)  replaced 14bp motif with a simplified 2bp motif
        25 out of 1,243,954 ( 0%)  replaced 12bp motif with a simplified 3bp motif
        24 out of 1,243,954 ( 0%)  replaced 17bp motif with a simplified 1bp motif
        23 out of 1,243,954 ( 0%)  replaced 16bp motif with a simplified 2bp motif
        23 out of 1,243,954 ( 0%)  replaced 18bp motif with a simplified 9bp motif
        19 out of 1,243,954 ( 0%)  replaced 18bp motif with a simplified 1bp motif
        13 out of 1,243,954 ( 0%)  replaced 18bp motif with a simplified 2bp motif
        11 out of 1,243,954 ( 0%)  replaced 20bp motif with a simplified 4bp motif
         7 out of 1,243,954 ( 0%)  replaced 19bp motif with a simplified 1bp motif
         7 out of 1,243,954 ( 0%)  replaced 15bp motif with a simplified 3bp motif
         7 out of 1,243,954 ( 0%)  replaced 18bp motif with a simplified 6bp motif
         6 out of 1,243,954 ( 0%)  replaced 20bp motif with a simplified 5bp motif
         5 out of 1,243,954 ( 0%)  replaced 20bp motif with a simplified 1bp motif
         4 out of 1,243,954 ( 0%)  replaced 20bp motif with a simplified 10bp motif
         3 out of 1,243,954 ( 0%)  replaced 21bp motif with a simplified 1bp motif
         3 out of 1,243,954 ( 0%)  replaced 20bp motif with a simplified 2bp motif
         2 out of 1,243,954 ( 0%)  replaced 30bp motif with a simplified 2bp motif
         2 out of 1,243,954 ( 0%)  replaced 22bp motif with a simplified 2bp motif
         2 out of 1,243,954 ( 0%)  replaced 22bp motif with a simplified 11bp motif
         2 out of 1,243,954 ( 0%)  replaced 24bp motif with a simplified 2bp motif
         2 out of 1,243,954 ( 0%)  replaced 28bp motif with a simplified 4bp motif
         2 out of 1,243,954 ( 0%)  replaced 21bp motif with a simplified 7bp motif
         1 out of 1,243,954 ( 0%)  replaced 52bp motif with a simplified 26bp motif
         1 out of 1,243,954 ( 0%)  replaced 58bp motif with a simplified 29bp motif
         1 out of 1,243,954 ( 0%)  replaced 24bp motif with a simplified 4bp motif
         1 out of 1,243,954 ( 0%)  replaced 36bp motif with a simplified 18bp motif
         1 out of 1,243,954 ( 0%)  replaced 48bp motif with a simplified 24bp motif
         1 out of 1,243,954 ( 0%)  replaced 42bp motif with a simplified 21bp motif
         1 out of 1,243,954 ( 0%)  replaced 30bp motif with a simplified 6bp motif
         1 out of 1,243,954 ( 0%)  replaced 129bp motif with a simplified 43bp motif
         1 out of 1,243,954 ( 0%)  replaced 21bp motif with a simplified 3bp motif
         1 out of 1,243,954 ( 0%)  replaced 26bp motif with a simplified 1bp motif
         1 out of 1,243,954 ( 0%)  replaced 22bp motif with a simplified 1bp motif
         1 out of 1,243,954 ( 0%)  replaced 24bp motif with a simplified 1bp motif
         1 out of 1,243,954 ( 0%)  replaced 23bp motif with a simplified 1bp motif
         1 out of 1,243,954 ( 0%)  replaced 56bp motif with a simplified 28bp motif
         1 out of 1,243,954 ( 0%)  replaced 64bp motif with a simplified 32bp motif
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz

Stats for vamos_catalog.v2.1.filtered.json.gz:
    1,243,954 total loci
   94,952,055 base pairs spanned by all loci (3.075% of the genome)
            0 out of  1,243,954 (  0.0%) loci define adjacent repeats
    1,243,954 total repeat intervals
      452,937 out of  1,243,954 ( 36.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
      200,283 out of  1,243,954 ( 16.1%) repeat intervals are homopolymers
            0 out of  1,243,954 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-667bp
   Locus size range: 1-9977bp
   Num repeats range: 0-7186x repeats

   Max locus size =   9,977bp           @ chr10:18563565-18573542 (ATTCC)
   Min fraction pure bases   =  0.00    @ chrY:57215630-57215892 (CGGCGCGCCTCTCTGCGCCTGCGCCGGCG)
   Min fraction pure repeats =  0.00    @ chrY:57215630-57215892 (CGGCGCGCCTCTCTGCGCCTGCGCCGGCG)

          chrX:     56,535 out of  1,243,954 (  4.5%) repeat intervals
          chrY:     10,282 out of  1,243,954 (  0.8%) repeat intervals
          chrM:          0 out of  1,243,954 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,243,954 (  0.0%) repeat intervals

Motif size distribution:
          1bp:    200,283 out of  1,243,954 ( 16.1%) repeat intervals
          2bp:    219,819 out of  1,243,954 ( 17.7%) repeat intervals
          3bp:     82,179 out of  1,243,954 (  6.6%) repeat intervals
          4bp:    172,790 out of  1,243,954 ( 13.9%) repeat intervals
          5bp:     95,968 out of  1,243,954 (  7.7%) repeat intervals
          6bp:     87,357 out of  1,243,954 (  7.0%) repeat intervals
       7-24bp:    275,758 out of  1,243,954 ( 22.2%) repeat intervals
        25+bp:    109,800 out of  1,243,954 (  8.8%) repeat intervals

Num repeats in reference:
           1x:     58,497 out of  1,243,954 (  4.7%) repeat intervals
           2x:    188,504 out of  1,243,954 ( 15.2%) repeat intervals
           3x:     44,261 out of  1,243,954 (  3.6%) repeat intervals
           4x:     30,702 out of  1,243,954 (  2.5%) repeat intervals
           5x:     73,330 out of  1,243,954 (  5.9%) repeat intervals
           6x:     78,951 out of  1,243,954 (  6.3%) repeat intervals
           7x:     62,776 out of  1,243,954 (  5.0%) repeat intervals
           8x:     52,995 out of  1,243,954 (  4.3%) repeat intervals
           9x:     44,258 out of  1,243,954 (  3.6%) repeat intervals
       10-15x:    169,652 out of  1,243,954 ( 13.6%) repeat intervals
       16-25x:    214,728 out of  1,243,954 ( 17.3%) repeat intervals
       26-35x:    110,428 out of  1,243,954 (  8.9%) repeat intervals
       36-50x:     58,004 out of  1,243,954 (  4.7%) repeat intervals
         51+x:     55,568 out of  1,243,954 (  4.5%) repeat intervals

Fraction pure bases distribution:
          0.0:     39,816 out of  1,243,954 (  3.2%) repeat intervals
          0.1:     63,659 out of  1,243,954 (  5.1%) repeat intervals
          0.2:     90,712 out of  1,243,954 (  7.3%) repeat intervals
          0.3:     89,903 out of  1,243,954 (  7.2%) repeat intervals
          0.4:     72,993 out of  1,243,954 (  5.9%) repeat intervals
          0.5:    238,418 out of  1,243,954 ( 19.2%) repeat intervals
          0.6:     97,908 out of  1,243,954 (  7.9%) repeat intervals
          0.7:     73,126 out of  1,243,954 (  5.9%) repeat intervals
          0.8:    113,944 out of  1,243,954 (  9.2%) repeat intervals
          0.9:     82,639 out of  1,243,954 (  6.6%) repeat intervals
          1.0:    280,836 out of  1,243,954 ( 22.6%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      1 bp to   7,186 bp  (median:   26 bp) based on    200,283 loci. Mean base purity: 0.93, mean repeat purity: 0.93.  
     2bp motifs: locus size range:      1 bp to   8,605 bp  (median:   44 bp) based on    219,819 loci. Mean base purity: 0.56, mean repeat purity: 0.76.  
     3bp motifs: locus size range:      1 bp to   8,233 bp  (median:   34 bp) based on     82,179 loci. Mean base purity: 0.59, mean repeat purity: 0.66.  
     4bp motifs: locus size range:      1 bp to   7,719 bp  (median:   39 bp) based on    172,790 loci. Mean base purity: 0.59, mean repeat purity: 0.60.  
     5bp motifs: locus size range:      1 bp to   9,977 bp  (median:   38 bp) based on     95,968 loci. Mean base purity: 0.60, mean repeat purity: 0.49.  
     6bp motifs: locus size range:      1 bp to   6,553 bp  (median:   42 bp) based on     87,357 loci. Mean base purity: 0.53, mean repeat purity: 0.34.  
     7bp motifs: locus size range:      1 bp to   4,089 bp  (median:   44 bp) based on     48,866 loci. Mean base purity: 0.51, mean repeat purity: 0.29.  
     8bp motifs: locus size range:      1 bp to   3,180 bp  (median:   44 bp) based on     15,618 loci. Mean base purity: 0.51, mean repeat purity: 0.35.  
     9bp motifs: locus size range:      1 bp to   4,179 bp  (median:   41 bp) based on      7,668 loci. Mean base purity: 0.56, mean repeat purity: 0.43.  
    10bp motifs: locus size range:      1 bp to   5,217 bp  (median:   37 bp) based on      8,471 loci. Mean base purity: 0.58, mean repeat purity: 0.52.  
Wrote 1 rows to vamos_catalog.v2.1.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --output-prefix vamos_catalog_v2.1  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --verbose  --write-merge-stats-tsv  --write-bed-files-with-new-loci  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
Added 4,863,043 out of 4,863,043 (100.0%) records from simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz to the output catalog
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/1_to_1000bp_motifs/vamos_catalog.v2.1.filtered.json.gz
Added 604,206 out of 1,243,954 ( 48.6%) records from vamos_catalog.v2.1.filtered.json.gz to the output catalog
    Discarded 411,234 out of 1,243,954 ( 33.1%) records since they overlapped an existing locus by at least 66.0% and had the exact same LocusStructure
    Discarded 228,514 out of 1,243,954 ( 18.4%) records since they overlapped an existing locus by at least 66.0% and had the same canonical motif
Wrote 604,206 unique loci from vamos_catalog.v2.1.filtered.json.gz to vamos_catalog.v2.1.filtered.unique_loci.bed.gz
Writing combined catalog to vamos_catalog_v2.1.json.gz
Done writing 5,467,249 output records to vamos_catalog_v2.1.json.gz
Source of loci in output catalog:
   4,863,043 out of 5,467,249 (88.9%) simple_repeat_catalog_v1.hg38.1_to_1000bp_motifs.EH.with_annotations.json.gz
     604,206 out of 5,467,249 (11.1%) vamos_catalog.v2.1.filtered.json.gz
Motif sizes:
   1,583,278 out of 5,467,249 (29.0%) 1bp
   1,443,878 out of 5,467,249 (26.4%) 3bp
   1,001,545 out of 5,467,249 (18.3%) 2bp
     643,543 out of 5,467,249 (11.8%) 4bp
     430,599 out of 5,467,249 ( 7.9%) 7+bp
     234,688 out of 5,467,249 ( 4.3%) 5bp
     129,718 out of 5,467,249 ( 2.4%) 6bp
Chromsomes:
   5,152,323 out of 5,467,249 (94.2%) are on autosomes
     270,404 out of 5,467,249 ( 4.9%) are on X
      44,508 out of 5,467,249 ( 0.8%) are on Y
          14 out of 5,467,249 ( 0.0%) are on M
Wrote 2 rows to vamos_catalog_v2.1.merge_stats.tsv
Done with comparisons. Took 0h, 25m, 31s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
mkdir -p 2_to_1000bp_motifs
cd 2_to_1000bp_motifs
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Wrote 82 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        82 out of 83 (99%)  passed all filters
         1 out of 83 ( 1%)  motif size(s) < 2
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
           82 total loci
        3,745 base pairs spanned by all loci (0.000% of the genome)
            0 out of         82 (  0.0%) loci define adjacent repeats
           82 total repeat intervals
           81 out of         82 ( 98.8%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of         82 (  0.0%) repeat intervals are homopolymers
            0 out of         82 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         82 ( 13.4%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-27bp
   Locus size range: 6-150bp
   Num repeats range: 1-50x repeats

   Max locus size =     150bp           @ chr13:102161574-102161724 (AAG)
   Min fraction pure bases   =  0.60    @ chr8:118366812-118366918 (AAAAT)
   Min fraction pure repeats =  0.00    @ chr13:99985448-99985493 (GCN)

          chrX:         11 out of         82 ( 13.4%) repeat intervals
          chrY:          0 out of         82 (  0.0%) repeat intervals
          chrM:          0 out of         82 (  0.0%) repeat intervals
   alt contigs:          0 out of         82 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of         82 (  0.0%) repeat intervals
          2bp:          1 out of         82 (  1.2%) repeat intervals
          3bp:         60 out of         82 ( 73.2%) repeat intervals
          4bp:          2 out of         82 (  2.4%) repeat intervals
          5bp:         10 out of         82 ( 12.2%) repeat intervals
          6bp:          4 out of         82 (  4.9%) repeat intervals
       7-24bp:          4 out of         82 (  4.9%) repeat intervals
        25+bp:          1 out of         82 (  1.2%) repeat intervals

Num repeats in reference:
           1x:          1 out of         82 (  1.2%) repeat intervals
           2x:          3 out of         82 (  3.7%) repeat intervals
           3x:          3 out of         82 (  3.7%) repeat intervals
           4x:          4 out of         82 (  4.9%) repeat intervals
           5x:          2 out of         82 (  2.4%) repeat intervals
           6x:          2 out of         82 (  2.4%) repeat intervals
           7x:          5 out of         82 (  6.1%) repeat intervals
           8x:          5 out of         82 (  6.1%) repeat intervals
           9x:          2 out of         82 (  2.4%) repeat intervals
       10-15x:         31 out of         82 ( 37.8%) repeat intervals
       16-25x:         20 out of         82 ( 24.4%) repeat intervals
       26-35x:          2 out of         82 (  2.4%) repeat intervals
       36-50x:          2 out of         82 (  2.4%) repeat intervals
         51+x:          0 out of         82 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         82 ( 13.4%) repeat intervals
          0.1:          0 out of         82 (  0.0%) repeat intervals
          0.2:          0 out of         82 (  0.0%) repeat intervals
          0.3:          0 out of         82 (  0.0%) repeat intervals
          0.4:          0 out of         82 (  0.0%) repeat intervals
          0.5:          1 out of         82 (  1.2%) repeat intervals
          0.6:          0 out of         82 (  0.0%) repeat intervals
          0.7:          2 out of         82 (  2.4%) repeat intervals
          0.8:          8 out of         82 (  9.8%) repeat intervals
          0.9:          8 out of         82 (  9.8%) repeat intervals
          1.0:         52 out of         82 ( 63.4%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      6 bp to     150 bp  (median:   39 bp) based on         60 loci. Mean base purity: 0.93, mean repeat purity: 0.78.  
     4bp motifs: locus size range:     40 bp to      80 bp  (median:   60 bp) based on          2 loci. Mean base purity: 0.98, mean repeat purity: 0.93.  
     5bp motifs: locus size range:     35 bp to     106 bp  (median:   67 bp) based on         10 loci. Mean base purity: 0.96, mean repeat purity: 0.98.  
     6bp motifs: locus size range:     12 bp to      24 bp  (median:   18 bp) based on          4 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     20 bp to      20 bp  (median:   20 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    12bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    20bp motifs: locus size range:     80 bp to      80 bp  (median:   80 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    24bp motifs: locus size range:     96 bp to      96 bp  (median:   96 bp) based on          1 loci. Mean base purity: 0.96, mean repeat purity: 0.50.  
    27bp motifs: locus size range:     27 bp to      27 bp  (median:   27 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 173,921 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   173,921 out of 174,286 (100%)  passed all filters
       365 out of 174,286 ( 0%)  motif size(s) < 2

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
      173,921 total loci
    4,615,544 base pairs spanned by all loci (0.149% of the genome)
            0 out of    173,921 (  0.0%) loci define adjacent repeats
      173,921 total repeat intervals
      173,897 out of    173,921 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    173,921 (  0.0%) repeat intervals are homopolymers
            0 out of    173,921 (  0.0%) repeat intervals overlap each other by at least two motif lengths
            1 out of    173,921 (  0.0%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-24bp
   Locus size range: 4-532bp
   Num repeats range: 2-133x repeats

   Max locus size =     532bp           @ chr7:138621782-138622314 (TATC)
   Min fraction pure bases   =  0.43    @ chr3:112804380-112804514 (TCT)
   Min fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)

          chrX:      8,555 out of    173,921 (  4.9%) repeat intervals
          chrY:          0 out of    173,921 (  0.0%) repeat intervals
          chrM:          0 out of    173,921 (  0.0%) repeat intervals
   alt contigs:          0 out of    173,921 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    173,921 (  0.0%) repeat intervals
          2bp:     98,531 out of    173,921 ( 56.7%) repeat intervals
          3bp:     14,442 out of    173,921 (  8.3%) repeat intervals
          4bp:     43,263 out of    173,921 ( 24.9%) repeat intervals
          5bp:     12,551 out of    173,921 (  7.2%) repeat intervals
          6bp:      3,931 out of    173,921 (  2.3%) repeat intervals
       7-24bp:      1,203 out of    173,921 (  0.7%) repeat intervals
        25+bp:          0 out of    173,921 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of    173,921 (  0.0%) repeat intervals
           2x:      8,780 out of    173,921 (  5.0%) repeat intervals
           3x:      6,543 out of    173,921 (  3.8%) repeat intervals
           4x:      8,878 out of    173,921 (  5.1%) repeat intervals
           5x:     11,884 out of    173,921 (  6.8%) repeat intervals
           6x:     13,897 out of    173,921 (  8.0%) repeat intervals
           7x:     14,915 out of    173,921 (  8.6%) repeat intervals
           8x:     13,898 out of    173,921 (  8.0%) repeat intervals
           9x:     12,532 out of    173,921 (  7.2%) repeat intervals
       10-15x:     49,892 out of    173,921 ( 28.7%) repeat intervals
       16-25x:     31,022 out of    173,921 ( 17.8%) repeat intervals
       26-35x:      1,651 out of    173,921 (  0.9%) repeat intervals
       36-50x:         23 out of    173,921 (  0.0%) repeat intervals
         51+x:          6 out of    173,921 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of    173,921 (  0.0%) repeat intervals
          0.1:          0 out of    173,921 (  0.0%) repeat intervals
          0.2:          0 out of    173,921 (  0.0%) repeat intervals
          0.3:          0 out of    173,921 (  0.0%) repeat intervals
          0.4:          0 out of    173,921 (  0.0%) repeat intervals
          0.5:          0 out of    173,921 (  0.0%) repeat intervals
          0.6:         25 out of    173,921 (  0.0%) repeat intervals
          0.7:        566 out of    173,921 (  0.3%) repeat intervals
          0.8:      4,113 out of    173,921 (  2.4%) repeat intervals
          0.9:      3,179 out of    173,921 (  1.8%) repeat intervals
          1.0:    166,037 out of    173,921 ( 95.5%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:      4 bp to      82 bp  (median:   24 bp) based on     98,531 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      6 bp to     240 bp  (median:   27 bp) based on     14,442 loci. Mean base purity: 0.99, mean repeat purity: 0.98.  
     4bp motifs: locus size range:      8 bp to     532 bp  (median:   24 bp) based on     43,263 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     5bp motifs: locus size range:     10 bp to     220 bp  (median:   25 bp) based on     12,551 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     6bp motifs: locus size range:     12 bp to     106 bp  (median:   24 bp) based on      3,931 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     7bp motifs: locus size range:     14 bp to      70 bp  (median:   14 bp) based on        630 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     16 bp to      72 bp  (median:   16 bp) based on        428 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     18 bp to      90 bp  (median:   27 bp) based on         34 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
    10bp motifs: locus size range:     20 bp to      60 bp  (median:   30 bp) based on         15 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
    11bp motifs: locus size range:     22 bp to      44 bp  (median:   33 bp) based on          5 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 3,220,714 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 3,220,714 out of 4,558,281 (71%)  passed all filters
 1,337,567 out of 4,558,281 (29%)  motif size(s) < 2
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    3,220,714 total loci
   44,504,438 base pairs spanned by all loci (1.441% of the genome)
            0 out of  3,220,714 (  0.0%) loci define adjacent repeats
    3,220,714 total repeat intervals
    1,461,484 out of  3,220,714 ( 45.4%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,220,714 (  0.0%) repeat intervals are homopolymers
            0 out of  3,220,714 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 2-833bp
   Locus size range: 9-2523bp
   Num repeats range: 3-300x repeats

   Max locus size =   2,523bp           @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  1.00    @ chrY:56887882-56887891 (TGA)
   Min fraction pure repeats =  1.00    @ chrY:56887882-56887891 (TGA)

          chrX:    168,815 out of  3,220,714 (  5.2%) repeat intervals
          chrY:     29,829 out of  3,220,714 (  0.9%) repeat intervals
          chrM:         14 out of  3,220,714 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,220,714 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,220,714 (  0.0%) repeat intervals
          2bp:    967,389 out of  3,220,714 ( 30.0%) repeat intervals
          3bp:  1,418,341 out of  3,220,714 ( 44.0%) repeat intervals
          4bp:    569,907 out of  3,220,714 ( 17.7%) repeat intervals
          5bp:    172,187 out of  3,220,714 (  5.3%) repeat intervals
          6bp:     52,023 out of  3,220,714 (  1.6%) repeat intervals
       7-24bp:     31,185 out of  3,220,714 (  1.0%) repeat intervals
        25+bp:      9,682 out of  3,220,714 (  0.3%) repeat intervals

Num repeats in reference:
           1x:          0 out of  3,220,714 (  0.0%) repeat intervals
           2x:          0 out of  3,220,714 (  0.0%) repeat intervals
           3x:  1,787,359 out of  3,220,714 ( 55.5%) repeat intervals
           4x:    641,281 out of  3,220,714 ( 19.9%) repeat intervals
           5x:    353,723 out of  3,220,714 ( 11.0%) repeat intervals
           6x:    148,753 out of  3,220,714 (  4.6%) repeat intervals
           7x:     76,841 out of  3,220,714 (  2.4%) repeat intervals
           8x:     43,343 out of  3,220,714 (  1.3%) repeat intervals
           9x:     28,678 out of  3,220,714 (  0.9%) repeat intervals
       10-15x:     88,663 out of  3,220,714 (  2.8%) repeat intervals
       16-25x:     48,612 out of  3,220,714 (  1.5%) repeat intervals
       26-35x:      3,317 out of  3,220,714 (  0.1%) repeat intervals
       36-50x:        105 out of  3,220,714 (  0.0%) repeat intervals
         51+x:         39 out of  3,220,714 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.1:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.2:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.3:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.4:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.5:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.6:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.7:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.8:          0 out of  3,220,714 (  0.0%) repeat intervals
          0.9:          0 out of  3,220,714 (  0.0%) repeat intervals
          1.0:  3,220,714 out of  3,220,714 (100.0%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:      9 bp to     600 bp  (median:   10 bp) based on    967,389 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      9 bp to     632 bp  (median:    9 bp) based on  1,418,341 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     4bp motifs: locus size range:     12 bp to     533 bp  (median:   15 bp) based on    569,907 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     5bp motifs: locus size range:     15 bp to     341 bp  (median:   18 bp) based on    172,187 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     6bp motifs: locus size range:     18 bp to   1,103 bp  (median:   21 bp) based on     52,023 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     7bp motifs: locus size range:     21 bp to     151 bp  (median:   23 bp) based on     13,079 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     24 bp to     149 bp  (median:   26 bp) based on      5,531 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     27 bp to     116 bp  (median:   29 bp) based on      2,284 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     30 bp to     111 bp  (median:   34 bp) based on      1,693 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    11bp motifs: locus size range:     33 bp to     118 bp  (median:   36 bp) based on        715 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               2
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Wrote 536,850 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Filter stats:
 1,937,805 total input rows
 1,400,735 out of 1,937,805 (72%)  motif size(s) < 2
   536,850 out of 1,937,805 (28%)  passed all filters
       220 out of 1,937,805 ( 0%)  row reference sequence has invalid bases

Modification stats:
     4,879 out of 1,937,805 ( 0%)  replaced 4bp motif with a simplified 2bp motif
       235 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 2bp motif
        79 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        69 out of 1,937,805 ( 0%)  replaced 8bp motif with a simplified 4bp motif
         4 out of 1,937,805 ( 0%)  replaced 9bp motif with a simplified 3bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 2bp motif
         2 out of 1,937,805 ( 0%)  replaced 12bp motif with a simplified 4bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         1 out of 1,937,805 ( 0%)  replaced 15bp motif with a simplified 5bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Stats for merged_expansion_hunter_catalog.78_samples.filtered.json.gz:
      536,850 total loci
   13,171,928 base pairs spanned by all loci (0.427% of the genome)
            0 out of    536,850 (  0.0%) loci define adjacent repeats
      536,850 total repeat intervals
      536,850 out of    536,850 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    536,850 (  0.0%) repeat intervals are homopolymers
       20,219 out of    536,850 (  3.8%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr5:111798773-111798789, chr18:74579181-74579231, chr11:121789491-121789523, chr5:104502108-104502168, chr5:4597779-4597795, chr2:129783270-129783314, chr1:30832655-30832675, chr18:47703782-47703802, chr2:84808129-84808173, chr1:168749614-168749626

Ranges:
   Motif size range: 2-833bp
   Locus size range: 2-2499bp
   Num repeats range: 1-300x repeats

   Max locus size =   2,499bp           @ chrX:71520430-71522929 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  0.68    @ chr20:22538965-22539037 (CCT)
   Min fraction pure repeats =  0.03    @ chr11:133140745-133140859 (GAG)

          chrX:     24,952 out of    536,850 (  4.6%) repeat intervals
          chrY:      1,894 out of    536,850 (  0.4%) repeat intervals
          chrM:          0 out of    536,850 (  0.0%) repeat intervals
   alt contigs:          0 out of    536,850 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    536,850 (  0.0%) repeat intervals
          2bp:    249,968 out of    536,850 ( 46.6%) repeat intervals
          3bp:     68,910 out of    536,850 ( 12.8%) repeat intervals
          4bp:    131,029 out of    536,850 ( 24.4%) repeat intervals
          5bp:     35,605 out of    536,850 (  6.6%) repeat intervals
          6bp:     14,601 out of    536,850 (  2.7%) repeat intervals
       7-24bp:     24,757 out of    536,850 (  4.6%) repeat intervals
        25+bp:     11,980 out of    536,850 (  2.2%) repeat intervals

Num repeats in reference:
           1x:      8,646 out of    536,850 (  1.6%) repeat intervals
           2x:     32,677 out of    536,850 (  6.1%) repeat intervals
           3x:     72,138 out of    536,850 ( 13.4%) repeat intervals
           4x:     57,050 out of    536,850 ( 10.6%) repeat intervals
           5x:     65,403 out of    536,850 ( 12.2%) repeat intervals
           6x:     55,041 out of    536,850 ( 10.3%) repeat intervals
           7x:     43,287 out of    536,850 (  8.1%) repeat intervals
           8x:     33,574 out of    536,850 (  6.3%) repeat intervals
           9x:     25,686 out of    536,850 (  4.8%) repeat intervals
       10-15x:     88,492 out of    536,850 ( 16.5%) repeat intervals
       16-25x:     50,178 out of    536,850 (  9.3%) repeat intervals
       26-35x:      4,135 out of    536,850 (  0.8%) repeat intervals
       36-50x:        383 out of    536,850 (  0.1%) repeat intervals
         51+x:        160 out of    536,850 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        200 out of    536,850 (  0.0%) repeat intervals
          0.1:      1,212 out of    536,850 (  0.2%) repeat intervals
          0.2:      1,939 out of    536,850 (  0.4%) repeat intervals
          0.3:      1,955 out of    536,850 (  0.4%) repeat intervals
          0.4:      1,402 out of    536,850 (  0.3%) repeat intervals
          0.5:      6,214 out of    536,850 (  1.2%) repeat intervals
          0.6:     12,675 out of    536,850 (  2.4%) repeat intervals
          0.7:      5,833 out of    536,850 (  1.1%) repeat intervals
          0.8:      7,232 out of    536,850 (  1.3%) repeat intervals
          0.9:      5,886 out of    536,850 (  1.1%) repeat intervals
          1.0:    492,302 out of    536,850 ( 91.7%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:      2 bp to     600 bp  (median:   18 bp) based on    249,968 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      3 bp to     561 bp  (median:   12 bp) based on     68,910 loci. Mean base purity: 0.98, mean repeat purity: 0.95.  
     4bp motifs: locus size range:      4 bp to     472 bp  (median:   20 bp) based on    131,029 loci. Mean base purity: 0.99, mean repeat purity: 0.94.  
     5bp motifs: locus size range:      5 bp to     400 bp  (median:   20 bp) based on     35,605 loci. Mean base purity: 1.00, mean repeat purity: 0.98.  
     6bp motifs: locus size range:      6 bp to     498 bp  (median:   18 bp) based on     14,601 loci. Mean base purity: 0.99, mean repeat purity: 0.93.  
     7bp motifs: locus size range:      7 bp to     546 bp  (median:   21 bp) based on      4,996 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
     8bp motifs: locus size range:      8 bp to     312 bp  (median:   24 bp) based on      3,579 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
     9bp motifs: locus size range:      9 bp to     243 bp  (median:   27 bp) based on      1,880 loci. Mean base purity: 0.99, mean repeat purity: 0.95.  
    10bp motifs: locus size range:     10 bp to     260 bp  (median:   30 bp) based on      1,886 loci. Mean base purity: 0.99, mean repeat purity: 0.93.  
    11bp motifs: locus size range:     11 bp to     143 bp  (median:   33 bp) based on        871 loci. Mean base purity: 0.99, mean repeat purity: 0.94.  
Wrote 1 rows to merged_expansion_hunter_catalog.78_samples.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --write-merge-stats-tsv  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
Added 82 out of 82 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 173,879 out of 173,921 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 173,879 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 3,053,992 out of 3,220,714 ( 94.8%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 3,053,992 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 67,769 out of 536,850 ( 12.6%) records from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to the output catalog
Wrote 67,769 unique loci from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to merged_expansion_hunter_catalog.78_samples.filtered.unique_loci.bed.gz
Done writing 3,295,722 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.merged.json.gz
Wrote 4 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.merged.merge_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 2  --max-motif-size 1000  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.merged.json.gz
Wrote 3,295,706 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
python3 << EOF
import gzip, ijson, json

f = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz", "rt")
out = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.json.gz", "wt")
out.write("[")
for record in ijson.items(f, "item", use_float=True): 
	out.write(json.dumps({ 
  k: v for k, v in record.items() if k not in {"LocusId", "ReferenceRegion", "VariantType", "LocusStructure"} 
	}, indent=4))
out.write("]")
EOF

cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/merged_expansion_hunter_catalog.78_samples.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-catalog-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz  --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz  --output-variation-clusters-bed-path variation_clusters_v1.hg38.TRGT.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Found 727,553 out of 3,147,421 (23.1%) locus IDs in the input catalog were in variation clusters
Found 2,419,868 out of 2,724,345 (88.8%) variation clusters did not change the original locus boundaries by 5 bases or more
Wrote 307,659 out of 2,724,345 (11.3%) variation clusters to variation_clusters_v1.hg38.TRGT.bed.gz
Found 307,659 out of 2,724,345 (11.3%) variation clusters that differed from locus definitions in the input catalog /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
3,261,125 out of 3,295,706 (99.0%) loci from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz are not in variation clusters
Wrote 3,295,706 out of 3,295,706 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote 3,295,706 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote 3,295,706 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.TRGT.bed
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/validate_catalog.py --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
Done. Catalog passed validation.
tar czf simple_repeat_catalog_v1.hg38.subset.all_loci_except_homopolymers.tar.gz -C /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.bed.gz simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.bed.gz.tbi simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.json.gz simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.TRGT.bed simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.LongTR.bed simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.HipSTR.bed simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.GangSTR.bed
cp simple_repeat_catalog_v1.hg38.subset.all_loci_except_homopolymers.tar.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz

Stats for simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.json.gz:
    3,295,706 total loci
   45,882,286 base pairs spanned by all loci (1.486% of the genome)
            0 out of  3,295,706 (  0.0%) loci define adjacent repeats
    3,295,706 total repeat intervals
    1,642,780 out of  3,295,706 ( 49.8%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,295,706 (  0.0%) repeat intervals are homopolymers
       18,340 out of  3,295,706 (  0.6%) repeat intervals overlap each other by at least two motif lengths
           11 out of  3,295,706 (  0.0%) repeat intervals have non-ACGT motifs
Examples of overlapping repeats: chr3:131586726-131586770, chr15:88554458-88554512, chr8:40473237-40473307, chr19:9967477-9967495, chr2:151176803-151176827, chr20:31224638-31224663, chr22:34811319-34811351, chr9:33745493-33745510, chr14:82676050-82676078, chr10:7556080-7556099

Ranges:
   Motif size range: 2-833bp
   Locus size range: 2-2523bp
   Num repeats range: 1-300x repeats

   Max locus size =   2,523bp           @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  0.43    @ chr3:112804380-112804514 (TCT)
   Min fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)
   Min overall mappability   =  0.00    @ chrY:56887882-56887891 (TGA)

          chrX:    171,530 out of  3,295,706 (  5.2%) repeat intervals
          chrY:     29,937 out of  3,295,706 (  0.9%) repeat intervals
          chrM:         14 out of  3,295,706 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,295,706 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,295,706 (  0.0%) repeat intervals
          2bp:    978,973 out of  3,295,706 ( 29.7%) repeat intervals
          3bp:  1,432,118 out of  3,295,706 ( 43.5%) repeat intervals
          4bp:    590,787 out of  3,295,706 ( 17.9%) repeat intervals
          5bp:    177,422 out of  3,295,706 (  5.4%) repeat intervals
          6bp:     56,731 out of  3,295,706 (  1.7%) repeat intervals
       7-24bp:     43,996 out of  3,295,706 (  1.3%) repeat intervals
        25+bp:     15,679 out of  3,295,706 (  0.5%) repeat intervals

Num repeats in reference:
           1x:      8,506 out of  3,295,706 (  0.3%) repeat intervals
           2x:     38,240 out of  3,295,706 (  1.2%) repeat intervals
           3x:  1,798,367 out of  3,295,706 ( 54.6%) repeat intervals
           4x:    649,390 out of  3,295,706 ( 19.7%) repeat intervals
           5x:    355,178 out of  3,295,706 ( 10.8%) repeat intervals
           6x:    149,713 out of  3,295,706 (  4.5%) repeat intervals
           7x:     77,418 out of  3,295,706 (  2.3%) repeat intervals
           8x:     44,168 out of  3,295,706 (  1.3%) repeat intervals
           9x:     29,523 out of  3,295,706 (  0.9%) repeat intervals
       10-15x:     91,685 out of  3,295,706 (  2.8%) repeat intervals
       16-25x:     49,800 out of  3,295,706 (  1.5%) repeat intervals
       26-35x:      3,470 out of  3,295,706 (  0.1%) repeat intervals
       36-50x:        165 out of  3,295,706 (  0.0%) repeat intervals
         51+x:         83 out of  3,295,706 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        211 out of  3,295,706 (  0.0%) repeat intervals
          0.1:      1,200 out of  3,295,706 (  0.0%) repeat intervals
          0.2:      1,842 out of  3,295,706 (  0.1%) repeat intervals
          0.3:      1,711 out of  3,295,706 (  0.1%) repeat intervals
          0.4:      1,112 out of  3,295,706 (  0.0%) repeat intervals
          0.5:      5,536 out of  3,295,706 (  0.2%) repeat intervals
          0.6:     11,194 out of  3,295,706 (  0.3%) repeat intervals
          0.7:      3,902 out of  3,295,706 (  0.1%) repeat intervals
          0.8:      5,041 out of  3,295,706 (  0.2%) repeat intervals
          0.9:      3,181 out of  3,295,706 (  0.1%) repeat intervals
          1.0:  3,260,776 out of  3,295,706 ( 98.9%) repeat intervals

Mappability distribution:
          0.0:    115,341 out of  3,295,706 (  3.5%) loci
          0.1:    141,457 out of  3,295,706 (  4.3%) loci
          0.2:    163,653 out of  3,295,706 (  5.0%) loci
          0.3:    151,480 out of  3,295,706 (  4.6%) loci
          0.4:    209,584 out of  3,295,706 (  6.4%) loci
          0.5:    293,458 out of  3,295,706 (  8.9%) loci
          0.6:    223,591 out of  3,295,706 (  6.8%) loci
          0.7:    213,960 out of  3,295,706 (  6.5%) loci
          0.8:    257,793 out of  3,295,706 (  7.8%) loci
          0.9:    483,179 out of  3,295,706 ( 14.7%) loci
          1.0:  1,042,210 out of  3,295,706 ( 31.6%) loci

Locus sizes at each motif size:
     2bp motifs: locus size range:      2 bp to     600 bp  (median:   10 bp) based on    978,973 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.76
     3bp motifs: locus size range:      3 bp to     632 bp  (median:    9 bp) based on  1,432,118 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.75
     4bp motifs: locus size range:      4 bp to     533 bp  (median:   14 bp) based on    590,787 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.68
     5bp motifs: locus size range:      5 bp to     400 bp  (median:   18 bp) based on    177,422 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.61
     6bp motifs: locus size range:      6 bp to   1,103 bp  (median:   20 bp) based on     56,731 loci. Mean base purity: 1.00, mean repeat purity: 0.98.  Mean mappability: 0.62
     7bp motifs: locus size range:      7 bp to     151 bp  (median:   22 bp) based on     15,083 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.58
     8bp motifs: locus size range:      8 bp to     312 bp  (median:   25 bp) based on      7,107 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.57
     9bp motifs: locus size range:      9 bp to     153 bp  (median:   28 bp) based on      3,231 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  Mean mappability: 0.51
    10bp motifs: locus size range:     10 bp to     150 bp  (median:   31 bp) based on      2,713 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.50
    11bp motifs: locus size range:     11 bp to     121 bp  (median:   33 bp) based on      1,226 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.55
Wrote 1 rows to simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs.EH.with_annotations.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.2_to_1000bp_motifs catalog. Took 1h, 18m, 5s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
mkdir -p homopolymers
cd homopolymers
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Wrote 1 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        82 out of 83 (99%)  motif size(s) > 1
         1 out of 83 ( 1%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
            1 total loci
           25 base pairs spanned by all loci (0.000% of the genome)
            0 out of          1 (  0.0%) loci define adjacent repeats
            1 total repeat intervals
            1 out of          1 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            1 out of          1 (100.0%) repeat intervals are homopolymers
            0 out of          1 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 25-25bp
   Num repeats range: 25-25x repeats

   Max locus size =      25bp           @ chr9:69037261-69037286 (A)
   Min fraction pure bases   =  0.92    @ chr9:69037261-69037286 (A)
   Min fraction pure repeats =  0.92    @ chr9:69037261-69037286 (A)

          chrX:          0 out of          1 (  0.0%) repeat intervals
          chrY:          0 out of          1 (  0.0%) repeat intervals
          chrM:          0 out of          1 (  0.0%) repeat intervals
   alt contigs:          0 out of          1 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          1 out of          1 (100.0%) repeat intervals
          2bp:          0 out of          1 (  0.0%) repeat intervals
          3bp:          0 out of          1 (  0.0%) repeat intervals
          4bp:          0 out of          1 (  0.0%) repeat intervals
          5bp:          0 out of          1 (  0.0%) repeat intervals
          6bp:          0 out of          1 (  0.0%) repeat intervals
       7-24bp:          0 out of          1 (  0.0%) repeat intervals
        25+bp:          0 out of          1 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of          1 (  0.0%) repeat intervals
           2x:          0 out of          1 (  0.0%) repeat intervals
           3x:          0 out of          1 (  0.0%) repeat intervals
           4x:          0 out of          1 (  0.0%) repeat intervals
           5x:          0 out of          1 (  0.0%) repeat intervals
           6x:          0 out of          1 (  0.0%) repeat intervals
           7x:          0 out of          1 (  0.0%) repeat intervals
           8x:          0 out of          1 (  0.0%) repeat intervals
           9x:          0 out of          1 (  0.0%) repeat intervals
       10-15x:          0 out of          1 (  0.0%) repeat intervals
       16-25x:          1 out of          1 (100.0%) repeat intervals
       26-35x:          0 out of          1 (  0.0%) repeat intervals
       36-50x:          0 out of          1 (  0.0%) repeat intervals
         51+x:          0 out of          1 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of          1 (  0.0%) repeat intervals
          0.1:          0 out of          1 (  0.0%) repeat intervals
          0.2:          0 out of          1 (  0.0%) repeat intervals
          0.3:          0 out of          1 (  0.0%) repeat intervals
          0.4:          0 out of          1 (  0.0%) repeat intervals
          0.5:          0 out of          1 (  0.0%) repeat intervals
          0.6:          0 out of          1 (  0.0%) repeat intervals
          0.7:          0 out of          1 (  0.0%) repeat intervals
          0.8:          0 out of          1 (  0.0%) repeat intervals
          0.9:          1 out of          1 (100.0%) repeat intervals
          1.0:          0 out of          1 (  0.0%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:     25 bp to      25 bp  (median:   25 bp) based on          1 loci. Mean base purity: 0.92, mean repeat purity: 0.92.  
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 365 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   173,921 out of 174,286 (100%)  motif size(s) > 1
       365 out of 174,286 ( 0%)  passed all filters

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
          365 total loci
        7,487 base pairs spanned by all loci (0.000% of the genome)
            0 out of        365 (  0.0%) loci define adjacent repeats
          365 total repeat intervals
          365 out of        365 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
          365 out of        365 (100.0%) repeat intervals are homopolymers
            0 out of        365 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 4-36bp
   Num repeats range: 4-36x repeats

   Max locus size =      36bp           @ chr7:11459665-11459701 (T)
   Min fraction pure bases   =  0.97    @ chr2:132591257-132591287 (A)
   Min fraction pure repeats =  0.97    @ chr2:132591257-132591287 (A)

          chrX:          6 out of        365 (  1.6%) repeat intervals
          chrY:          0 out of        365 (  0.0%) repeat intervals
          chrM:          0 out of        365 (  0.0%) repeat intervals
   alt contigs:          0 out of        365 (  0.0%) repeat intervals

Motif size distribution:
          1bp:        365 out of        365 (100.0%) repeat intervals
          2bp:          0 out of        365 (  0.0%) repeat intervals
          3bp:          0 out of        365 (  0.0%) repeat intervals
          4bp:          0 out of        365 (  0.0%) repeat intervals
          5bp:          0 out of        365 (  0.0%) repeat intervals
          6bp:          0 out of        365 (  0.0%) repeat intervals
       7-24bp:          0 out of        365 (  0.0%) repeat intervals
        25+bp:          0 out of        365 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of        365 (  0.0%) repeat intervals
           2x:          0 out of        365 (  0.0%) repeat intervals
           3x:          0 out of        365 (  0.0%) repeat intervals
           4x:          4 out of        365 (  1.1%) repeat intervals
           5x:          0 out of        365 (  0.0%) repeat intervals
           6x:          3 out of        365 (  0.8%) repeat intervals
           7x:          0 out of        365 (  0.0%) repeat intervals
           8x:          4 out of        365 (  1.1%) repeat intervals
           9x:          0 out of        365 (  0.0%) repeat intervals
       10-15x:         60 out of        365 ( 16.4%) repeat intervals
       16-25x:        215 out of        365 ( 58.9%) repeat intervals
       26-35x:         78 out of        365 ( 21.4%) repeat intervals
       36-50x:          1 out of        365 (  0.3%) repeat intervals
         51+x:          0 out of        365 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of        365 (  0.0%) repeat intervals
          0.1:          0 out of        365 (  0.0%) repeat intervals
          0.2:          0 out of        365 (  0.0%) repeat intervals
          0.3:          0 out of        365 (  0.0%) repeat intervals
          0.4:          0 out of        365 (  0.0%) repeat intervals
          0.5:          0 out of        365 (  0.0%) repeat intervals
          0.6:          0 out of        365 (  0.0%) repeat intervals
          0.7:          0 out of        365 (  0.0%) repeat intervals
          0.8:          0 out of        365 (  0.0%) repeat intervals
          0.9:          1 out of        365 (  0.3%) repeat intervals
          1.0:        364 out of        365 ( 99.7%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      4 bp to      36 bp  (median:   22 bp) based on        365 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 1,337,567 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 3,220,714 out of 4,558,281 (71%)  motif size(s) > 1
 1,337,567 out of 4,558,281 (29%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    1,337,567 total loci
   17,999,599 base pairs spanned by all loci (0.583% of the genome)
            0 out of  1,337,567 (  0.0%) loci define adjacent repeats
    1,337,567 total repeat intervals
    1,337,567 out of  1,337,567 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,337,567 out of  1,337,567 (100.0%) repeat intervals are homopolymers
            0 out of  1,337,567 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 9-90bp
   Num repeats range: 9-90x repeats

   Max locus size =      90bp           @ chr12:66057592-66057682 (T)
   Min fraction pure bases   =  1.00    @ chrY:56886790-56886799 (T)
   Min fraction pure repeats =  1.00    @ chrY:56886790-56886799 (T)

          chrX:     64,162 out of  1,337,567 (  4.8%) repeat intervals
          chrY:      9,038 out of  1,337,567 (  0.7%) repeat intervals
          chrM:          0 out of  1,337,567 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,337,567 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,337,567 out of  1,337,567 (100.0%) repeat intervals
          2bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          3bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          4bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          5bp:          0 out of  1,337,567 (  0.0%) repeat intervals
          6bp:          0 out of  1,337,567 (  0.0%) repeat intervals
       7-24bp:          0 out of  1,337,567 (  0.0%) repeat intervals
        25+bp:          0 out of  1,337,567 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of  1,337,567 (  0.0%) repeat intervals
           2x:          0 out of  1,337,567 (  0.0%) repeat intervals
           3x:          0 out of  1,337,567 (  0.0%) repeat intervals
           4x:          0 out of  1,337,567 (  0.0%) repeat intervals
           5x:          0 out of  1,337,567 (  0.0%) repeat intervals
           6x:          0 out of  1,337,567 (  0.0%) repeat intervals
           7x:          0 out of  1,337,567 (  0.0%) repeat intervals
           8x:          0 out of  1,337,567 (  0.0%) repeat intervals
           9x:    323,473 out of  1,337,567 ( 24.2%) repeat intervals
       10-15x:    667,371 out of  1,337,567 ( 49.9%) repeat intervals
       16-25x:    299,023 out of  1,337,567 ( 22.4%) repeat intervals
       26-35x:     42,007 out of  1,337,567 (  3.1%) repeat intervals
       36-50x:      5,445 out of  1,337,567 (  0.4%) repeat intervals
         51+x:        248 out of  1,337,567 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.1:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.2:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.3:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.4:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.5:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.6:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.7:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.8:          0 out of  1,337,567 (  0.0%) repeat intervals
          0.9:          0 out of  1,337,567 (  0.0%) repeat intervals
          1.0:  1,337,567 out of  1,337,567 (100.0%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      9 bp to      90 bp  (median:   12 bp) based on  1,337,567 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/merged_expansion_hunter_catalog.78_samples.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
   min_motif_size =               1
   max_motif_size =               1
   min_interval_size_bp =         1
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Wrote 1,400,310 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Filter stats:
 1,937,805 total input rows
 1,400,310 out of 1,937,805 (72%)  passed all filters
   537,070 out of 1,937,805 (28%)  motif size(s) > 1
       425 out of 1,937,805 ( 0%)  row reference sequence has invalid bases

Modification stats:
     4,879 out of 1,937,805 ( 0%)  replaced 4bp motif with a simplified 2bp motif
       235 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 2bp motif
        79 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        69 out of 1,937,805 ( 0%)  replaced 8bp motif with a simplified 4bp motif
         4 out of 1,937,805 ( 0%)  replaced 9bp motif with a simplified 3bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 2bp motif
         2 out of 1,937,805 ( 0%)  replaced 12bp motif with a simplified 4bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         1 out of 1,937,805 ( 0%)  replaced 15bp motif with a simplified 5bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Stats for merged_expansion_hunter_catalog.78_samples.filtered.json.gz:
    1,400,310 total loci
   18,179,008 base pairs spanned by all loci (0.589% of the genome)
            0 out of  1,400,310 (  0.0%) loci define adjacent repeats
    1,400,310 total repeat intervals
    1,400,310 out of  1,400,310 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,400,310 out of  1,400,310 (100.0%) repeat intervals are homopolymers
           61 out of  1,400,310 (  0.0%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr12:111626062-111626085, chr4:123590407-123590433, chr13:81168236-81168247, chr4:123590395-123590419, chr11:46647271-46647292, chr7:90300644-90300665, chr13:73505495-73505515, chr8:40237227-40237254, chr1:36229412-36229436, chr9:21439849-21439867

Ranges:
   Motif size range: 1-1bp
   Locus size range: 1-90bp
   Num repeats range: 1-90x repeats

   Max locus size =      90bp           @ chr12:66057592-66057682 (T)
   Min fraction pure bases   =  0.90    @ chr15:90108217-90108227 (T)
   Min fraction pure repeats =  0.90    @ chr15:90108217-90108227 (T)

          chrX:     58,712 out of  1,400,310 (  4.2%) repeat intervals
          chrY:      3,861 out of  1,400,310 (  0.3%) repeat intervals
          chrM:          0 out of  1,400,310 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,400,310 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,400,310 out of  1,400,310 (100.0%) repeat intervals
          2bp:          0 out of  1,400,310 (  0.0%) repeat intervals
          3bp:          0 out of  1,400,310 (  0.0%) repeat intervals
          4bp:          0 out of  1,400,310 (  0.0%) repeat intervals
          5bp:          0 out of  1,400,310 (  0.0%) repeat intervals
          6bp:          0 out of  1,400,310 (  0.0%) repeat intervals
       7-24bp:          0 out of  1,400,310 (  0.0%) repeat intervals
        25+bp:          0 out of  1,400,310 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      1,938 out of  1,400,310 (  0.1%) repeat intervals
           2x:        682 out of  1,400,310 (  0.0%) repeat intervals
           3x:        822 out of  1,400,310 (  0.1%) repeat intervals
           4x:      1,003 out of  1,400,310 (  0.1%) repeat intervals
           5x:      1,347 out of  1,400,310 (  0.1%) repeat intervals
           6x:      2,177 out of  1,400,310 (  0.2%) repeat intervals
           7x:      8,345 out of  1,400,310 (  0.6%) repeat intervals
           8x:    213,304 out of  1,400,310 ( 15.2%) repeat intervals
           9x:    214,379 out of  1,400,310 ( 15.3%) repeat intervals
       10-15x:    612,144 out of  1,400,310 ( 43.7%) repeat intervals
       16-25x:    296,421 out of  1,400,310 ( 21.2%) repeat intervals
       26-35x:     41,952 out of  1,400,310 (  3.0%) repeat intervals
       36-50x:      5,542 out of  1,400,310 (  0.4%) repeat intervals
         51+x:        254 out of  1,400,310 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.1:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.2:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.3:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.4:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.5:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.6:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.7:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.8:          0 out of  1,400,310 (  0.0%) repeat intervals
          0.9:      2,232 out of  1,400,310 (  0.2%) repeat intervals
          1.0:  1,398,078 out of  1,400,310 ( 99.8%) repeat intervals

Locus sizes at each motif size:
     1bp motifs: locus size range:      1 bp to      90 bp  (median:   11 bp) based on  1,400,310 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to merged_expansion_hunter_catalog.78_samples.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --write-merge-stats-tsv  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
Added 1 out of 1 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 365 out of 365 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 365 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 1,337,209 out of 1,337,567 (100.0%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 1,337,209 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 229,763 out of 1,400,310 ( 16.4%) records from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to the output catalog
Wrote 229,763 unique loci from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to merged_expansion_hunter_catalog.78_samples.filtered.unique_loci.bed.gz
Done writing 1,567,338 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.merged.json.gz
Wrote 4 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.merged.merge_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 1  --max-motif-size 1  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.merged.json.gz
Wrote 1,567,337 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
python3 << EOF
import gzip, ijson, json

f = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz", "rt")
out = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.json.gz", "wt")
out.write("[")
for record in ijson.items(f, "item", use_float=True): 
	out.write(json.dumps({ 
  k: v for k, v in record.items() if k not in {"LocusId", "ReferenceRegion", "VariantType", "LocusStructure"} 
	}, indent=4))
out.write("]")
EOF

cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/merged_expansion_hunter_catalog.78_samples.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
Wrote 1,567,337 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
Wrote 1,567,337 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.TRGT.bed
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/validate_catalog.py --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
Done. Catalog passed validation.
tar czf simple_repeat_catalog_v1.hg38.subset.only_homopolymer_loci.tar.gz -C /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers simple_repeat_catalog_v1.hg38.homopolymers.bed.gz simple_repeat_catalog_v1.hg38.homopolymers.bed.gz.tbi simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz simple_repeat_catalog_v1.hg38.homopolymers.EH.json.gz simple_repeat_catalog_v1.hg38.homopolymers.TRGT.bed simple_repeat_catalog_v1.hg38.homopolymers.LongTR.bed simple_repeat_catalog_v1.hg38.homopolymers.HipSTR.bed simple_repeat_catalog_v1.hg38.homopolymers.GangSTR.bed
cp simple_repeat_catalog_v1.hg38.subset.only_homopolymer_loci.tar.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz

Stats for simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.json.gz:
    1,567,337 total loci
   19,795,843 base pairs spanned by all loci (0.641% of the genome)
            0 out of  1,567,337 (  0.0%) loci define adjacent repeats
    1,567,337 total repeat intervals
    1,567,337 out of  1,567,337 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
    1,567,337 out of  1,567,337 (100.0%) repeat intervals are homopolymers
            0 out of  1,567,337 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 1-1bp
   Locus size range: 1-90bp
   Num repeats range: 1-90x repeats

   Max locus size =      90bp           @ chr12:66057592-66057682 (T)
   Min fraction pure bases   =  0.90    @ chrX:132535976-132535986 (A)
   Min fraction pure repeats =  0.90    @ chrX:132535976-132535986 (A)
   Min overall mappability   =  0.00    @ chrY:26345156-26345198 (A)

          chrX:     72,662 out of  1,567,337 (  4.6%) repeat intervals
          chrY:      9,320 out of  1,567,337 (  0.6%) repeat intervals
          chrM:          0 out of  1,567,337 (  0.0%) repeat intervals
   alt contigs:          0 out of  1,567,337 (  0.0%) repeat intervals

Motif size distribution:
          1bp:  1,567,337 out of  1,567,337 (100.0%) repeat intervals
          2bp:          0 out of  1,567,337 (  0.0%) repeat intervals
          3bp:          0 out of  1,567,337 (  0.0%) repeat intervals
          4bp:          0 out of  1,567,337 (  0.0%) repeat intervals
          5bp:          0 out of  1,567,337 (  0.0%) repeat intervals
          6bp:          0 out of  1,567,337 (  0.0%) repeat intervals
       7-24bp:          0 out of  1,567,337 (  0.0%) repeat intervals
        25+bp:          0 out of  1,567,337 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      1,938 out of  1,567,337 (  0.1%) repeat intervals
           2x:        682 out of  1,567,337 (  0.0%) repeat intervals
           3x:        822 out of  1,567,337 (  0.1%) repeat intervals
           4x:      1,007 out of  1,567,337 (  0.1%) repeat intervals
           5x:      1,347 out of  1,567,337 (  0.1%) repeat intervals
           6x:      2,180 out of  1,567,337 (  0.1%) repeat intervals
           7x:      8,343 out of  1,567,337 (  0.5%) repeat intervals
           8x:    213,307 out of  1,567,337 ( 13.6%) repeat intervals
           9x:    323,470 out of  1,567,337 ( 20.6%) repeat intervals
       10-15x:    667,503 out of  1,567,337 ( 42.6%) repeat intervals
       16-25x:    299,037 out of  1,567,337 ( 19.1%) repeat intervals
       26-35x:     42,008 out of  1,567,337 (  2.7%) repeat intervals
       36-50x:      5,445 out of  1,567,337 (  0.3%) repeat intervals
         51+x:        248 out of  1,567,337 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.1:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.2:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.3:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.4:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.5:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.6:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.7:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.8:          0 out of  1,567,337 (  0.0%) repeat intervals
          0.9:        149 out of  1,567,337 (  0.0%) repeat intervals
          1.0:  1,567,188 out of  1,567,337 (100.0%) repeat intervals

Mappability distribution:
          0.0:     38,938 out of  1,567,337 (  2.5%) loci
          0.1:     73,014 out of  1,567,337 (  4.7%) loci
          0.2:     83,224 out of  1,567,337 (  5.3%) loci
          0.3:     85,376 out of  1,567,337 (  5.4%) loci
          0.4:    181,805 out of  1,567,337 ( 11.6%) loci
          0.5:    268,181 out of  1,567,337 ( 17.1%) loci
          0.6:    128,682 out of  1,567,337 (  8.2%) loci
          0.7:     92,248 out of  1,567,337 (  5.9%) loci
          0.8:     79,922 out of  1,567,337 (  5.1%) loci
          0.9:    142,869 out of  1,567,337 (  9.1%) loci
          1.0:    393,078 out of  1,567,337 ( 25.1%) loci

Locus sizes at each motif size:
     1bp motifs: locus size range:      1 bp to      90 bp  (median:   11 bp) based on  1,567,337 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.66
Wrote 1 rows to simple_repeat_catalog_v1.hg38.homopolymers.EH.with_annotations.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/homopolymers/simple_repeat_catalog_v1.hg38.homopolymers catalog. Took 1h, 44m, 50s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
mkdir -p 2_to_6bp_motifs
cd 2_to_6bp_motifs
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Wrote 77 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        77 out of 83 (93%)  passed all filters
         5 out of 83 ( 6%)  motif size(s) > 6
         1 out of 83 ( 1%)  motif size(s) < 2
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
           77 total loci
        3,486 base pairs spanned by all loci (0.000% of the genome)
            0 out of         77 (  0.0%) loci define adjacent repeats
           77 total repeat intervals
           76 out of         77 ( 98.7%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of         77 (  0.0%) repeat intervals are homopolymers
            0 out of         77 (  0.0%) repeat intervals overlap each other by at least two motif lengths
           11 out of         77 ( 14.3%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-6bp
   Locus size range: 6-150bp
   Num repeats range: 2-50x repeats

   Max locus size =     150bp           @ chr13:102161574-102161724 (AAG)
   Min fraction pure bases   =  0.60    @ chr8:118366812-118366918 (AAAAT)
   Min fraction pure repeats =  0.00    @ chr13:99985448-99985493 (GCN)

          chrX:         11 out of         77 ( 14.3%) repeat intervals
          chrY:          0 out of         77 (  0.0%) repeat intervals
          chrM:          0 out of         77 (  0.0%) repeat intervals
   alt contigs:          0 out of         77 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of         77 (  0.0%) repeat intervals
          2bp:          1 out of         77 (  1.3%) repeat intervals
          3bp:         60 out of         77 ( 77.9%) repeat intervals
          4bp:          2 out of         77 (  2.6%) repeat intervals
          5bp:         10 out of         77 ( 13.0%) repeat intervals
          6bp:          4 out of         77 (  5.2%) repeat intervals
       7-24bp:          0 out of         77 (  0.0%) repeat intervals
        25+bp:          0 out of         77 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of         77 (  0.0%) repeat intervals
           2x:          2 out of         77 (  2.6%) repeat intervals
           3x:          2 out of         77 (  2.6%) repeat intervals
           4x:          2 out of         77 (  2.6%) repeat intervals
           5x:          2 out of         77 (  2.6%) repeat intervals
           6x:          2 out of         77 (  2.6%) repeat intervals
           7x:          5 out of         77 (  6.5%) repeat intervals
           8x:          5 out of         77 (  6.5%) repeat intervals
           9x:          2 out of         77 (  2.6%) repeat intervals
       10-15x:         31 out of         77 ( 40.3%) repeat intervals
       16-25x:         20 out of         77 ( 26.0%) repeat intervals
       26-35x:          2 out of         77 (  2.6%) repeat intervals
       36-50x:          2 out of         77 (  2.6%) repeat intervals
         51+x:          0 out of         77 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:         11 out of         77 ( 14.3%) repeat intervals
          0.1:          0 out of         77 (  0.0%) repeat intervals
          0.2:          0 out of         77 (  0.0%) repeat intervals
          0.3:          0 out of         77 (  0.0%) repeat intervals
          0.4:          0 out of         77 (  0.0%) repeat intervals
          0.5:          0 out of         77 (  0.0%) repeat intervals
          0.6:          0 out of         77 (  0.0%) repeat intervals
          0.7:          2 out of         77 (  2.6%) repeat intervals
          0.8:          8 out of         77 ( 10.4%) repeat intervals
          0.9:          8 out of         77 ( 10.4%) repeat intervals
          1.0:         48 out of         77 ( 62.3%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      6 bp to     150 bp  (median:   39 bp) based on         60 loci. Mean base purity: 0.93, mean repeat purity: 0.78.  
     4bp motifs: locus size range:     40 bp to      80 bp  (median:   60 bp) based on          2 loci. Mean base purity: 0.98, mean repeat purity: 0.93.  
     5bp motifs: locus size range:     35 bp to     106 bp  (median:   67 bp) based on         10 loci. Mean base purity: 0.96, mean repeat purity: 0.98.  
     6bp motifs: locus size range:     12 bp to      24 bp  (median:   18 bp) based on          4 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 172,718 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   172,718 out of 174,286 (99%)  passed all filters
     1,203 out of 174,286 ( 1%)  motif size(s) > 6
       365 out of 174,286 ( 0%)  motif size(s) < 2

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
      172,718 total loci
    4,587,342 base pairs spanned by all loci (0.149% of the genome)
            0 out of    172,718 (  0.0%) loci define adjacent repeats
      172,718 total repeat intervals
      172,694 out of    172,718 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    172,718 (  0.0%) repeat intervals are homopolymers
            0 out of    172,718 (  0.0%) repeat intervals overlap each other by at least two motif lengths
            1 out of    172,718 (  0.0%) repeat intervals have non-ACGT motifs

Ranges:
   Motif size range: 2-6bp
   Locus size range: 4-532bp
   Num repeats range: 2-133x repeats

   Max locus size =     532bp           @ chr7:138621782-138622314 (TATC)
   Min fraction pure bases   =  0.43    @ chr3:112804380-112804514 (TCT)
   Min fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)

          chrX:      8,520 out of    172,718 (  4.9%) repeat intervals
          chrY:          0 out of    172,718 (  0.0%) repeat intervals
          chrM:          0 out of    172,718 (  0.0%) repeat intervals
   alt contigs:          0 out of    172,718 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    172,718 (  0.0%) repeat intervals
          2bp:     98,531 out of    172,718 ( 57.0%) repeat intervals
          3bp:     14,442 out of    172,718 (  8.4%) repeat intervals
          4bp:     43,263 out of    172,718 ( 25.0%) repeat intervals
          5bp:     12,551 out of    172,718 (  7.3%) repeat intervals
          6bp:      3,931 out of    172,718 (  2.3%) repeat intervals
       7-24bp:          0 out of    172,718 (  0.0%) repeat intervals
        25+bp:          0 out of    172,718 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of    172,718 (  0.0%) repeat intervals
           2x:      8,153 out of    172,718 (  4.7%) repeat intervals
           3x:      6,210 out of    172,718 (  3.6%) repeat intervals
           4x:      8,731 out of    172,718 (  5.1%) repeat intervals
           5x:     11,825 out of    172,718 (  6.8%) repeat intervals
           6x:     13,874 out of    172,718 (  8.0%) repeat intervals
           7x:     14,907 out of    172,718 (  8.6%) repeat intervals
           8x:     13,896 out of    172,718 (  8.0%) repeat intervals
           9x:     12,530 out of    172,718 (  7.3%) repeat intervals
       10-15x:     49,890 out of    172,718 ( 28.9%) repeat intervals
       16-25x:     31,022 out of    172,718 ( 18.0%) repeat intervals
       26-35x:      1,651 out of    172,718 (  1.0%) repeat intervals
       36-50x:         23 out of    172,718 (  0.0%) repeat intervals
         51+x:          6 out of    172,718 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of    172,718 (  0.0%) repeat intervals
          0.1:          0 out of    172,718 (  0.0%) repeat intervals
          0.2:          0 out of    172,718 (  0.0%) repeat intervals
          0.3:          0 out of    172,718 (  0.0%) repeat intervals
          0.4:          0 out of    172,718 (  0.0%) repeat intervals
          0.5:          0 out of    172,718 (  0.0%) repeat intervals
          0.6:         25 out of    172,718 (  0.0%) repeat intervals
          0.7:        555 out of    172,718 (  0.3%) repeat intervals
          0.8:      4,096 out of    172,718 (  2.4%) repeat intervals
          0.9:      3,178 out of    172,718 (  1.8%) repeat intervals
          1.0:    164,863 out of    172,718 ( 95.5%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:      4 bp to      82 bp  (median:   24 bp) based on     98,531 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      6 bp to     240 bp  (median:   27 bp) based on     14,442 loci. Mean base purity: 0.99, mean repeat purity: 0.98.  
     4bp motifs: locus size range:      8 bp to     532 bp  (median:   24 bp) based on     43,263 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     5bp motifs: locus size range:     10 bp to     220 bp  (median:   25 bp) based on     12,551 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
     6bp motifs: locus size range:     12 bp to     106 bp  (median:   24 bp) based on      3,931 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 3,179,847 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 3,179,847 out of 4,558,281 (70%)  passed all filters
 1,337,567 out of 4,558,281 (29%)  motif size(s) < 2
    40,867 out of 4,558,281 ( 1%)  motif size(s) > 6
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
    3,179,847 total loci
   41,615,061 base pairs spanned by all loci (1.348% of the genome)
            0 out of  3,179,847 (  0.0%) loci define adjacent repeats
    3,179,847 total repeat intervals
    1,453,291 out of  3,179,847 ( 45.7%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,179,847 (  0.0%) repeat intervals are homopolymers
            0 out of  3,179,847 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 2-6bp
   Locus size range: 9-1103bp
   Num repeats range: 3-300x repeats

   Max locus size =   1,103bp           @ chr5:10478-11581 (CCTAAC)
   Min fraction pure bases   =  1.00    @ chrY:56887882-56887891 (TGA)
   Min fraction pure repeats =  1.00    @ chrY:56887882-56887891 (TGA)

          chrX:    166,273 out of  3,179,847 (  5.2%) repeat intervals
          chrY:     29,581 out of  3,179,847 (  0.9%) repeat intervals
          chrM:         14 out of  3,179,847 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,179,847 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,179,847 (  0.0%) repeat intervals
          2bp:    967,389 out of  3,179,847 ( 30.4%) repeat intervals
          3bp:  1,418,341 out of  3,179,847 ( 44.6%) repeat intervals
          4bp:    569,907 out of  3,179,847 ( 17.9%) repeat intervals
          5bp:    172,187 out of  3,179,847 (  5.4%) repeat intervals
          6bp:     52,023 out of  3,179,847 (  1.6%) repeat intervals
       7-24bp:          0 out of  3,179,847 (  0.0%) repeat intervals
        25+bp:          0 out of  3,179,847 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of  3,179,847 (  0.0%) repeat intervals
           2x:          0 out of  3,179,847 (  0.0%) repeat intervals
           3x:  1,755,512 out of  3,179,847 ( 55.2%) repeat intervals
           4x:    636,383 out of  3,179,847 ( 20.0%) repeat intervals
           5x:    352,003 out of  3,179,847 ( 11.1%) repeat intervals
           6x:    147,914 out of  3,179,847 (  4.7%) repeat intervals
           7x:     76,379 out of  3,179,847 (  2.4%) repeat intervals
           8x:     43,044 out of  3,179,847 (  1.4%) repeat intervals
           9x:     28,490 out of  3,179,847 (  0.9%) repeat intervals
       10-15x:     88,185 out of  3,179,847 (  2.8%) repeat intervals
       16-25x:     48,491 out of  3,179,847 (  1.5%) repeat intervals
       26-35x:      3,305 out of  3,179,847 (  0.1%) repeat intervals
       36-50x:        103 out of  3,179,847 (  0.0%) repeat intervals
         51+x:         38 out of  3,179,847 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.1:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.2:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.3:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.4:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.5:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.6:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.7:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.8:          0 out of  3,179,847 (  0.0%) repeat intervals
          0.9:          0 out of  3,179,847 (  0.0%) repeat intervals
          1.0:  3,179,847 out of  3,179,847 (100.0%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:      9 bp to     600 bp  (median:   10 bp) based on    967,389 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      9 bp to     632 bp  (median:    9 bp) based on  1,418,341 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     4bp motifs: locus size range:     12 bp to     533 bp  (median:   15 bp) based on    569,907 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     5bp motifs: locus size range:     15 bp to     341 bp  (median:   18 bp) based on    172,187 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     6bp motifs: locus size range:     18 bp to   1,103 bp  (median:   21 bp) based on     52,023 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
   min_interval_size_bp =         1
   min_motif_size =               2
   max_motif_size =               6
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Wrote 500,113 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Filter stats:
 1,937,805 total input rows
 1,400,735 out of 1,937,805 (72%)  motif size(s) < 2
   500,113 out of 1,937,805 (26%)  passed all filters
    36,761 out of 1,937,805 ( 2%)  motif size(s) > 6
       196 out of 1,937,805 ( 0%)  row reference sequence has invalid bases

Modification stats:
     4,879 out of 1,937,805 ( 0%)  replaced 4bp motif with a simplified 2bp motif
       235 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 2bp motif
        79 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        69 out of 1,937,805 ( 0%)  replaced 8bp motif with a simplified 4bp motif
         4 out of 1,937,805 ( 0%)  replaced 9bp motif with a simplified 3bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 2bp motif
         2 out of 1,937,805 ( 0%)  replaced 12bp motif with a simplified 4bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         1 out of 1,937,805 ( 0%)  replaced 15bp motif with a simplified 5bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Stats for merged_expansion_hunter_catalog.78_samples.filtered.json.gz:
      500,113 total loci
   10,848,462 base pairs spanned by all loci (0.351% of the genome)
            0 out of    500,113 (  0.0%) loci define adjacent repeats
      500,113 total repeat intervals
      500,113 out of    500,113 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of    500,113 (  0.0%) repeat intervals are homopolymers
       17,712 out of    500,113 (  3.5%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr12:98221098-98221142, chr2:135117450-135117474, chr11:9583762-9583806, chr19:55734526-55734546, chr2:105489136-105489148, chr21:35072360-35072420, chr3:26636916-26636972, chrX:146085161-146085205, chr9:105228097-105228117, chr7:20988629-20988647

Ranges:
   Motif size range: 2-6bp
   Locus size range: 2-600bp
   Num repeats range: 1-300x repeats

   Max locus size =     600bp           @ chr3:144799028-144799628 (AT)
   Min fraction pure bases   =  0.68    @ chr20:22538965-22539037 (CCT)
   Min fraction pure repeats =  0.03    @ chr11:133140745-133140859 (GAG)

          chrX:     23,344 out of    500,113 (  4.7%) repeat intervals
          chrY:      1,842 out of    500,113 (  0.4%) repeat intervals
          chrM:          0 out of    500,113 (  0.0%) repeat intervals
   alt contigs:          0 out of    500,113 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of    500,113 (  0.0%) repeat intervals
          2bp:    249,968 out of    500,113 ( 50.0%) repeat intervals
          3bp:     68,910 out of    500,113 ( 13.8%) repeat intervals
          4bp:    131,029 out of    500,113 ( 26.2%) repeat intervals
          5bp:     35,605 out of    500,113 (  7.1%) repeat intervals
          6bp:     14,601 out of    500,113 (  2.9%) repeat intervals
       7-24bp:          0 out of    500,113 (  0.0%) repeat intervals
        25+bp:          0 out of    500,113 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      5,155 out of    500,113 (  1.0%) repeat intervals
           2x:     19,885 out of    500,113 (  4.0%) repeat intervals
           3x:     59,257 out of    500,113 ( 11.8%) repeat intervals
           4x:     53,333 out of    500,113 ( 10.7%) repeat intervals
           5x:     63,861 out of    500,113 ( 12.8%) repeat intervals
           6x:     54,273 out of    500,113 ( 10.9%) repeat intervals
           7x:     42,854 out of    500,113 (  8.6%) repeat intervals
           8x:     33,275 out of    500,113 (  6.7%) repeat intervals
           9x:     25,495 out of    500,113 (  5.1%) repeat intervals
       10-15x:     88,015 out of    500,113 ( 17.6%) repeat intervals
       16-25x:     50,054 out of    500,113 ( 10.0%) repeat intervals
       26-35x:      4,118 out of    500,113 (  0.8%) repeat intervals
       36-50x:        379 out of    500,113 (  0.1%) repeat intervals
         51+x:        159 out of    500,113 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        199 out of    500,113 (  0.0%) repeat intervals
          0.1:      1,200 out of    500,113 (  0.2%) repeat intervals
          0.2:      1,882 out of    500,113 (  0.4%) repeat intervals
          0.3:      1,842 out of    500,113 (  0.4%) repeat intervals
          0.4:      1,320 out of    500,113 (  0.3%) repeat intervals
          0.5:      5,455 out of    500,113 (  1.1%) repeat intervals
          0.6:     11,202 out of    500,113 (  2.2%) repeat intervals
          0.7:      5,351 out of    500,113 (  1.1%) repeat intervals
          0.8:      7,046 out of    500,113 (  1.4%) repeat intervals
          0.9:      5,875 out of    500,113 (  1.2%) repeat intervals
          1.0:    458,741 out of    500,113 ( 91.7%) repeat intervals

Locus sizes at each motif size:
     2bp motifs: locus size range:      2 bp to     600 bp  (median:   18 bp) based on    249,968 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     3bp motifs: locus size range:      3 bp to     561 bp  (median:   12 bp) based on     68,910 loci. Mean base purity: 0.98, mean repeat purity: 0.95.  
     4bp motifs: locus size range:      4 bp to     472 bp  (median:   20 bp) based on    131,029 loci. Mean base purity: 0.99, mean repeat purity: 0.94.  
     5bp motifs: locus size range:      5 bp to     400 bp  (median:   20 bp) based on     35,605 loci. Mean base purity: 1.00, mean repeat purity: 0.98.  
     6bp motifs: locus size range:      6 bp to     498 bp  (median:   18 bp) based on     14,601 loci. Mean base purity: 0.99, mean repeat purity: 0.93.  
Wrote 1 rows to merged_expansion_hunter_catalog.78_samples.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --write-merge-stats-tsv  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
Added 77 out of 77 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 172,677 out of 172,718 (100.0%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 172,677 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 3,013,699 out of 3,179,847 ( 94.8%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 3,013,699 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 49,593 out of 500,113 (  9.9%) records from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to the output catalog
Wrote 49,593 unique loci from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to merged_expansion_hunter_catalog.78_samples.filtered.unique_loci.bed.gz
Done writing 3,236,046 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.merged.json.gz
Wrote 4 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.merged.merge_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 2  --max-motif-size 6  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.merged.json.gz
Wrote 3,236,031 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
python3 << EOF
import gzip, ijson, json

f = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz", "rt")
out = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.json.gz", "wt")
out.write("[")
for record in ijson.items(f, "item", use_float=True): 
	out.write(json.dumps({ 
  k: v for k, v in record.items() if k not in {"LocusId", "ReferenceRegion", "VariantType", "LocusStructure"} 
	}, indent=4))
out.write("]")
EOF

cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/merged_expansion_hunter_catalog.78_samples.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-catalog-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.with_variation_clusters.json.gz  --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz  --output-variation-clusters-bed-path variation_clusters_v1.hg38.TRGT.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Found 727,553 out of 3,147,421 (23.1%) locus IDs in the input catalog were in variation clusters
Found 2,419,868 out of 2,724,345 (88.8%) variation clusters did not change the original locus boundaries by 5 bases or more
Wrote 307,659 out of 2,724,345 (11.3%) variation clusters to variation_clusters_v1.hg38.TRGT.bed.gz
Found 307,659 out of 2,724,345 (11.3%) variation clusters that differed from locus definitions in the input catalog /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
3,212,348 out of 3,236,031 (99.3%) loci from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz are not in variation clusters
Wrote 3,236,031 out of 3,236,031 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Wrote 3,236,031 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Wrote 3,236,031 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.TRGT.bed
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/validate_catalog.py --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
Done. Catalog passed validation.
tar czf simple_repeat_catalog_v1.hg38.subset.only_loci_with_2_to_6bp_motifs.tar.gz -C /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.bed.gz simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.bed.gz.tbi simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.json.gz simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.TRGT.bed simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.LongTR.bed simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.HipSTR.bed simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.GangSTR.bed
cp simple_repeat_catalog_v1.hg38.subset.only_loci_with_2_to_6bp_motifs.tar.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz

Stats for simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.json.gz:
    3,236,031 total loci
   42,203,131 base pairs spanned by all loci (1.367% of the genome)
            0 out of  3,236,031 (  0.0%) loci define adjacent repeats
    3,236,031 total repeat intervals
    1,615,301 out of  3,236,031 ( 49.9%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of  3,236,031 (  0.0%) repeat intervals are homopolymers
       15,830 out of  3,236,031 (  0.5%) repeat intervals overlap each other by at least two motif lengths
           11 out of  3,236,031 (  0.0%) repeat intervals have non-ACGT motifs
Examples of overlapping repeats: chr3:182263271-182263339, chr17:38946879-38946895, chr22:19160997-19161006, chr19:17463795-17463914, chr8:31230127-31230215, chr17:71462177-71462197, chr17:21650340-21650352, chr6:165097263-165097281, chr8:142255515-142255535, chr1:72795571-72795607

Ranges:
   Motif size range: 2-6bp
   Locus size range: 2-1103bp
   Num repeats range: 1-300x repeats

   Max locus size =   1,103bp           @ chr5:10478-11581 (CCTAAC)
   Min fraction pure bases   =  0.43    @ chr3:112804380-112804514 (TCT)
   Min fraction pure repeats =  0.00    @ chr4:41745972-41746032 (GCN)
   Min overall mappability   =  0.00    @ chrY:56887882-56887891 (TGA)

          chrX:    168,210 out of  3,236,031 (  5.2%) repeat intervals
          chrY:     29,669 out of  3,236,031 (  0.9%) repeat intervals
          chrM:         14 out of  3,236,031 (  0.0%) repeat intervals
   alt contigs:          0 out of  3,236,031 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of  3,236,031 (  0.0%) repeat intervals
          2bp:    978,973 out of  3,236,031 ( 30.3%) repeat intervals
          3bp:  1,432,118 out of  3,236,031 ( 44.3%) repeat intervals
          4bp:    590,787 out of  3,236,031 ( 18.3%) repeat intervals
          5bp:    177,422 out of  3,236,031 (  5.5%) repeat intervals
          6bp:     56,731 out of  3,236,031 (  1.8%) repeat intervals
       7-24bp:          0 out of  3,236,031 (  0.0%) repeat intervals
        25+bp:          0 out of  3,236,031 (  0.0%) repeat intervals

Num repeats in reference:
           1x:      5,022 out of  3,236,031 (  0.2%) repeat intervals
           2x:     25,164 out of  3,236,031 (  0.8%) repeat intervals
           3x:  1,765,314 out of  3,236,031 ( 54.6%) repeat intervals
           4x:    644,005 out of  3,236,031 ( 19.9%) repeat intervals
           5x:    353,215 out of  3,236,031 ( 10.9%) repeat intervals
           6x:    148,767 out of  3,236,031 (  4.6%) repeat intervals
           7x:     76,898 out of  3,236,031 (  2.4%) repeat intervals
           8x:     43,826 out of  3,236,031 (  1.4%) repeat intervals
           9x:     29,306 out of  3,236,031 (  0.9%) repeat intervals
       10-15x:     91,148 out of  3,236,031 (  2.8%) repeat intervals
       16-25x:     49,665 out of  3,236,031 (  1.5%) repeat intervals
       26-35x:      3,457 out of  3,236,031 (  0.1%) repeat intervals
       36-50x:        162 out of  3,236,031 (  0.0%) repeat intervals
         51+x:         82 out of  3,236,031 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:        210 out of  3,236,031 (  0.0%) repeat intervals
          0.1:      1,188 out of  3,236,031 (  0.0%) repeat intervals
          0.2:      1,785 out of  3,236,031 (  0.1%) repeat intervals
          0.3:      1,601 out of  3,236,031 (  0.0%) repeat intervals
          0.4:      1,032 out of  3,236,031 (  0.0%) repeat intervals
          0.5:      4,803 out of  3,236,031 (  0.1%) repeat intervals
          0.6:      9,833 out of  3,236,031 (  0.3%) repeat intervals
          0.7:      3,542 out of  3,236,031 (  0.1%) repeat intervals
          0.8:      4,986 out of  3,236,031 (  0.2%) repeat intervals
          0.9:      3,180 out of  3,236,031 (  0.1%) repeat intervals
          1.0:  3,203,871 out of  3,236,031 ( 99.0%) repeat intervals

Mappability distribution:
          0.0:    109,884 out of  3,236,031 (  3.4%) loci
          0.1:    136,329 out of  3,236,031 (  4.2%) loci
          0.2:    158,148 out of  3,236,031 (  4.9%) loci
          0.3:    145,505 out of  3,236,031 (  4.5%) loci
          0.4:    202,285 out of  3,236,031 (  6.3%) loci
          0.5:    285,950 out of  3,236,031 (  8.8%) loci
          0.6:    218,517 out of  3,236,031 (  6.8%) loci
          0.7:    209,762 out of  3,236,031 (  6.5%) loci
          0.8:    253,699 out of  3,236,031 (  7.8%) loci
          0.9:    478,258 out of  3,236,031 ( 14.8%) loci
          1.0:  1,037,694 out of  3,236,031 ( 32.1%) loci

Locus sizes at each motif size:
     2bp motifs: locus size range:      2 bp to     600 bp  (median:   10 bp) based on    978,973 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.76
     3bp motifs: locus size range:      3 bp to     632 bp  (median:    9 bp) based on  1,432,118 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.75
     4bp motifs: locus size range:      4 bp to     533 bp  (median:   14 bp) based on    590,787 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.68
     5bp motifs: locus size range:      5 bp to     400 bp  (median:   18 bp) based on    177,422 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  Mean mappability: 0.61
     6bp motifs: locus size range:      6 bp to   1,103 bp  (median:   20 bp) based on     56,731 loci. Mean base purity: 1.00, mean repeat purity: 0.98.  Mean mappability: 0.62
Wrote 1 rows to simple_repeat_catalog_v1.hg38.2_to_6bp_motifs.EH.with_annotations.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/2_to_6bp_motifs/simple_repeat_catalog_v1.hg38.2_to_6bp_motifs catalog. Took 2h, 36m, 28s
========================================================================================================================================================================================================
cd /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21
mkdir -p 7_to_1000bp_motifs
cd 7_to_1000bp_motifs
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
Wrote 5 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Filter stats:
        83 total input rows
        78 out of 83 (94%)  motif size(s) < 7
         5 out of 83 ( 6%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz

Stats for variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz:
            5 total loci
          259 base pairs spanned by all loci (0.000% of the genome)
            0 out of          5 (  0.0%) loci define adjacent repeats
            5 total repeat intervals
            5 out of          5 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of          5 (  0.0%) repeat intervals are homopolymers
            0 out of          5 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 10-27bp
   Locus size range: 20-96bp
   Num repeats range: 1-4x repeats

   Max locus size =      96bp           @ chr20:4699397-4699493 (CCTCATGGTGGTGGCTGGGGGCAG)
   Min fraction pure bases   =  0.96    @ chr20:4699397-4699493 (CCTCATGGTGGTGGCTGGGGGCAG)
   Min fraction pure repeats =  0.50    @ chr20:4699397-4699493 (CCTCATGGTGGTGGCTGGGGGCAG)

          chrX:          0 out of          5 (  0.0%) repeat intervals
          chrY:          0 out of          5 (  0.0%) repeat intervals
          chrM:          0 out of          5 (  0.0%) repeat intervals
   alt contigs:          0 out of          5 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of          5 (  0.0%) repeat intervals
          2bp:          0 out of          5 (  0.0%) repeat intervals
          3bp:          0 out of          5 (  0.0%) repeat intervals
          4bp:          0 out of          5 (  0.0%) repeat intervals
          5bp:          0 out of          5 (  0.0%) repeat intervals
          6bp:          0 out of          5 (  0.0%) repeat intervals
       7-24bp:          4 out of          5 ( 80.0%) repeat intervals
        25+bp:          1 out of          5 ( 20.0%) repeat intervals

Num repeats in reference:
           1x:          1 out of          5 ( 20.0%) repeat intervals
           2x:          1 out of          5 ( 20.0%) repeat intervals
           3x:          1 out of          5 ( 20.0%) repeat intervals
           4x:          2 out of          5 ( 40.0%) repeat intervals
           5x:          0 out of          5 (  0.0%) repeat intervals
           6x:          0 out of          5 (  0.0%) repeat intervals
           7x:          0 out of          5 (  0.0%) repeat intervals
           8x:          0 out of          5 (  0.0%) repeat intervals
           9x:          0 out of          5 (  0.0%) repeat intervals
       10-15x:          0 out of          5 (  0.0%) repeat intervals
       16-25x:          0 out of          5 (  0.0%) repeat intervals
       26-35x:          0 out of          5 (  0.0%) repeat intervals
       36-50x:          0 out of          5 (  0.0%) repeat intervals
         51+x:          0 out of          5 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of          5 (  0.0%) repeat intervals
          0.1:          0 out of          5 (  0.0%) repeat intervals
          0.2:          0 out of          5 (  0.0%) repeat intervals
          0.3:          0 out of          5 (  0.0%) repeat intervals
          0.4:          0 out of          5 (  0.0%) repeat intervals
          0.5:          1 out of          5 ( 20.0%) repeat intervals
          0.6:          0 out of          5 (  0.0%) repeat intervals
          0.7:          0 out of          5 (  0.0%) repeat intervals
          0.8:          0 out of          5 (  0.0%) repeat intervals
          0.9:          0 out of          5 (  0.0%) repeat intervals
          1.0:          4 out of          5 ( 80.0%) repeat intervals

Locus sizes at each motif size:
    10bp motifs: locus size range:     20 bp to      20 bp  (median:   20 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    12bp motifs: locus size range:     36 bp to      36 bp  (median:   36 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    20bp motifs: locus size range:     80 bp to      80 bp  (median:   80 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    24bp motifs: locus size range:     96 bp to      96 bp  (median:   96 bp) based on          1 loci. Mean base purity: 0.96, mean repeat purity: 0.50.  
    27bp motifs: locus size range:     27 bp to      27 bp  (median:   27 bp) based on          1 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to variant_catalog_without_offtargets.GRCh38.split.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
WARNING: skipping line with invalid motif: chr3	63912684	63912714	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	63912714	63912726	(GCA)*(GCC)+	.
WARNING: skipping line with invalid motif: chr3	129172576	129172656	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172656	129172696	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr3	129172696	129172732	(CAGG)*(CAGA)*(CA)*	.
WARNING: skipping line with invalid motif: chr4	3074876	3074933	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	3074939	3074966	(CAG)*CAACAG(CCG)*	.
WARNING: skipping line with invalid motif: chr4	39348424	39348479	(AARRG)*	.
WARNING: skipping line with invalid motif: chr9	69037261	69037286	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr9	69037286	69037304	(A)*(GAA)*	.
WARNING: skipping line with invalid motif: chr13	70139353	70139383	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr13	70139383	70139428	(CTA)*(CTG)*	.
WARNING: skipping line with invalid motif: chr20	2652733	2652757	(GGCCTG)*(CGCCTG)*	.
WARNING: skipping line with invalid motif: chr20	2652757	2652775	(GGCCTG)*(CGCCTG)*	.
Wrote 1,203 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Filter stats:
   174,286 total input rows
   173,083 out of 174,286 (99%)  motif size(s) < 7
     1,203 out of 174,286 ( 1%)  passed all filters

Modification stats:
       349 out of 174,286 ( 0%)  replaced 2bp motif with a simplified 1bp motif
         8 out of 174,286 ( 0%)  replaced 3bp motif with a simplified 1bp motif
         6 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 1bp motif
         4 out of 174,286 ( 0%)  replaced 4bp motif with a simplified 2bp motif
         2 out of 174,286 ( 0%)  replaced 5bp motif with a simplified 1bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/illumina_variant_catalog.sorted.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz

Stats for illumina_variant_catalog.sorted.filtered.json.gz:
        1,203 total loci
       28,202 base pairs spanned by all loci (0.001% of the genome)
            0 out of      1,203 (  0.0%) loci define adjacent repeats
        1,203 total repeat intervals
        1,203 out of      1,203 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of      1,203 (  0.0%) repeat intervals are homopolymers
            0 out of      1,203 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 7-24bp
   Locus size range: 14-96bp
   Num repeats range: 2-10x repeats

   Max locus size =      96bp           @ chr18:72692161-72692257 (TGGGAGGGGTGCGCGC)
   Min fraction pure bases   =  0.96    @ chr9:134945691-134945740 (AGGGCAG)
   Min fraction pure repeats =  0.71    @ chr12:588162-588225 (GGGACGGAA)

          chrX:         35 out of      1,203 (  2.9%) repeat intervals
          chrY:          0 out of      1,203 (  0.0%) repeat intervals
          chrM:          0 out of      1,203 (  0.0%) repeat intervals
   alt contigs:          0 out of      1,203 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of      1,203 (  0.0%) repeat intervals
          2bp:          0 out of      1,203 (  0.0%) repeat intervals
          3bp:          0 out of      1,203 (  0.0%) repeat intervals
          4bp:          0 out of      1,203 (  0.0%) repeat intervals
          5bp:          0 out of      1,203 (  0.0%) repeat intervals
          6bp:          0 out of      1,203 (  0.0%) repeat intervals
       7-24bp:      1,203 out of      1,203 (100.0%) repeat intervals
        25+bp:          0 out of      1,203 (  0.0%) repeat intervals

Num repeats in reference:
           1x:          0 out of      1,203 (  0.0%) repeat intervals
           2x:        627 out of      1,203 ( 52.1%) repeat intervals
           3x:        333 out of      1,203 ( 27.7%) repeat intervals
           4x:        147 out of      1,203 ( 12.2%) repeat intervals
           5x:         59 out of      1,203 (  4.9%) repeat intervals
           6x:         23 out of      1,203 (  1.9%) repeat intervals
           7x:          8 out of      1,203 (  0.7%) repeat intervals
           8x:          2 out of      1,203 (  0.2%) repeat intervals
           9x:          2 out of      1,203 (  0.2%) repeat intervals
       10-15x:          2 out of      1,203 (  0.2%) repeat intervals
       16-25x:          0 out of      1,203 (  0.0%) repeat intervals
       26-35x:          0 out of      1,203 (  0.0%) repeat intervals
       36-50x:          0 out of      1,203 (  0.0%) repeat intervals
         51+x:          0 out of      1,203 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of      1,203 (  0.0%) repeat intervals
          0.1:          0 out of      1,203 (  0.0%) repeat intervals
          0.2:          0 out of      1,203 (  0.0%) repeat intervals
          0.3:          0 out of      1,203 (  0.0%) repeat intervals
          0.4:          0 out of      1,203 (  0.0%) repeat intervals
          0.5:          0 out of      1,203 (  0.0%) repeat intervals
          0.6:          0 out of      1,203 (  0.0%) repeat intervals
          0.7:         11 out of      1,203 (  0.9%) repeat intervals
          0.8:         17 out of      1,203 (  1.4%) repeat intervals
          0.9:          1 out of      1,203 (  0.1%) repeat intervals
          1.0:      1,174 out of      1,203 ( 97.6%) repeat intervals

Locus sizes at each motif size:
     7bp motifs: locus size range:     14 bp to      70 bp  (median:   14 bp) based on        630 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     16 bp to      72 bp  (median:   16 bp) based on        428 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     18 bp to      90 bp  (median:   27 bp) based on         34 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
    10bp motifs: locus size range:     20 bp to      60 bp  (median:   30 bp) based on         15 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
    11bp motifs: locus size range:     22 bp to      44 bp  (median:   33 bp) based on          5 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    12bp motifs: locus size range:     24 bp to      72 bp  (median:   36 bp) based on         17 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  
    13bp motifs: locus size range:     26 bp to      78 bp  (median:   39 bp) based on         10 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    14bp motifs: locus size range:     28 bp to      84 bp  (median:   56 bp) based on          5 loci. Mean base purity: 1.00, mean repeat purity: 0.95.  
    15bp motifs: locus size range:     30 bp to      90 bp  (median:   60 bp) based on         12 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    16bp motifs: locus size range:     32 bp to      96 bp  (median:   64 bp) based on          7 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
Wrote 1 rows to illumina_variant_catalog.sorted.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
Wrote 40,867 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Filter stats:
 4,558,281 total input rows
 4,517,414 out of 4,558,281 (99%)  motif size(s) < 7
    40,867 out of 4,558,281 ( 1%)  passed all filters
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.bed.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz

Stats for hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz:
       40,867 total loci
    2,889,377 base pairs spanned by all loci (0.094% of the genome)
            0 out of     40,867 (  0.0%) loci define adjacent repeats
       40,867 total repeat intervals
        8,193 out of     40,867 ( 20.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of     40,867 (  0.0%) repeat intervals are homopolymers
            0 out of     40,867 (  0.0%) repeat intervals overlap each other by at least two motif lengths

Ranges:
   Motif size range: 7-833bp
   Locus size range: 21-2523bp
   Num repeats range: 3-70x repeats

   Max locus size =   2,523bp           @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  1.00    @ chrY:56858432-56858475 (GAAAGAAG)
   Min fraction pure repeats =  1.00    @ chrY:56858432-56858475 (GAAAGAAG)

          chrX:      2,542 out of     40,867 (  6.2%) repeat intervals
          chrY:        248 out of     40,867 (  0.6%) repeat intervals
          chrM:          0 out of     40,867 (  0.0%) repeat intervals
   alt contigs:          0 out of     40,867 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of     40,867 (  0.0%) repeat intervals
          2bp:          0 out of     40,867 (  0.0%) repeat intervals
          3bp:          0 out of     40,867 (  0.0%) repeat intervals
          4bp:          0 out of     40,867 (  0.0%) repeat intervals
          5bp:          0 out of     40,867 (  0.0%) repeat intervals
          6bp:          0 out of     40,867 (  0.0%) repeat intervals
       7-24bp:     31,185 out of     40,867 ( 76.3%) repeat intervals
        25+bp:      9,682 out of     40,867 ( 23.7%) repeat intervals

Num repeats in reference:
           1x:          0 out of     40,867 (  0.0%) repeat intervals
           2x:          0 out of     40,867 (  0.0%) repeat intervals
           3x:     31,847 out of     40,867 ( 77.9%) repeat intervals
           4x:      4,898 out of     40,867 ( 12.0%) repeat intervals
           5x:      1,720 out of     40,867 (  4.2%) repeat intervals
           6x:        839 out of     40,867 (  2.1%) repeat intervals
           7x:        462 out of     40,867 (  1.1%) repeat intervals
           8x:        299 out of     40,867 (  0.7%) repeat intervals
           9x:        188 out of     40,867 (  0.5%) repeat intervals
       10-15x:        478 out of     40,867 (  1.2%) repeat intervals
       16-25x:        121 out of     40,867 (  0.3%) repeat intervals
       26-35x:         12 out of     40,867 (  0.0%) repeat intervals
       36-50x:          2 out of     40,867 (  0.0%) repeat intervals
         51+x:          1 out of     40,867 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          0 out of     40,867 (  0.0%) repeat intervals
          0.1:          0 out of     40,867 (  0.0%) repeat intervals
          0.2:          0 out of     40,867 (  0.0%) repeat intervals
          0.3:          0 out of     40,867 (  0.0%) repeat intervals
          0.4:          0 out of     40,867 (  0.0%) repeat intervals
          0.5:          0 out of     40,867 (  0.0%) repeat intervals
          0.6:          0 out of     40,867 (  0.0%) repeat intervals
          0.7:          0 out of     40,867 (  0.0%) repeat intervals
          0.8:          0 out of     40,867 (  0.0%) repeat intervals
          0.9:          0 out of     40,867 (  0.0%) repeat intervals
          1.0:     40,867 out of     40,867 (100.0%) repeat intervals

Locus sizes at each motif size:
     7bp motifs: locus size range:     21 bp to     151 bp  (median:   23 bp) based on     13,079 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     8bp motifs: locus size range:     24 bp to     149 bp  (median:   26 bp) based on      5,531 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
     9bp motifs: locus size range:     27 bp to     116 bp  (median:   29 bp) based on      2,284 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    10bp motifs: locus size range:     30 bp to     111 bp  (median:   34 bp) based on      1,693 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    11bp motifs: locus size range:     33 bp to     118 bp  (median:   36 bp) based on        715 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    12bp motifs: locus size range:     36 bp to     179 bp  (median:   42 bp) based on      1,174 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    13bp motifs: locus size range:     39 bp to     358 bp  (median:   43 bp) based on        492 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    14bp motifs: locus size range:     42 bp to     234 bp  (median:   48 bp) based on        554 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    15bp motifs: locus size range:     45 bp to     331 bp  (median:   52 bp) based on        677 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
    16bp motifs: locus size range:     48 bp to     400 bp  (median:   56 bp) based on        714 loci. Mean base purity: 1.00, mean repeat purity: 1.00.  
Wrote 1 rows to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.catalog_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --verbose  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --skip-gene-annotations  --skip-mappability-annotations  --skip-disease-loci-annotations  --discard-loci-with-non-ACGT-bases-in-reference  --discard-loci-with-non-ACGTN-bases-in-motif  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Args:
   reference_fasta =              /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa
   output_path =                  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
   variant_catalog_json_or_bed =  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
   min_interval_size_bp =         1
   max_motif_size =               1000
   min_motif_size =               7
   output_tsv =                   False
   output_bed =                   False
   output_stats =                 False
   show_progress_bar =            False
   add_gene_region_to_locus_id =  False
   add_canonical_motif_to_locus_id =  False
   only_known_disease_associated_loci =  False
   exclude_known_disease_associated_loci =  False
   only_known_disease_associated_motifs =  False
   discard_overlapping_intervals_with_similar_motifs =  False
   discard_loci_with_non_ACGT_bases_in_motif =  False
   discard_loci_with_non_ACGTN_bases_in_reference =  False
   dont_simplify_motifs =         False
   verbose =                      True
   skip_gene_annotations =        True
   skip_disease_loci_annotations =  True
   skip_mappability_annotations =  True
   discard_loci_with_non_ACGTN_bases_in_motif =  True
   discard_loci_with_non_ACGT_bases_in_reference =  True
   mappability_track_bigwig =     gs://tgg-viewer/ref/GRCh38/mappability/GRCh38_no_alt_analysis_set_GCA_000001405.15-k36_m2.bw
   known_disease_associated_loci =  ~/code/str-analysis/str_analysis/variant_catalogs/variant_catalog_without_offtargets.GRCh38.json
   genes_gtf =                    ~/code/str-truth-set/ref/other/MANE.v1.0.ensembl_genomic.sorted.gtf.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
Wrote 36,737 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Filter stats:
 1,937,805 total input rows
 1,901,044 out of 1,937,805 (98%)  motif size(s) < 7
    36,737 out of 1,937,805 ( 2%)  passed all filters
        24 out of 1,937,805 ( 0%)  row reference sequence has invalid bases

Modification stats:
     4,879 out of 1,937,805 ( 0%)  replaced 4bp motif with a simplified 2bp motif
       235 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 2bp motif
        79 out of 1,937,805 ( 0%)  replaced 6bp motif with a simplified 3bp motif
        69 out of 1,937,805 ( 0%)  replaced 8bp motif with a simplified 4bp motif
         4 out of 1,937,805 ( 0%)  replaced 9bp motif with a simplified 3bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 2bp motif
         2 out of 1,937,805 ( 0%)  replaced 12bp motif with a simplified 4bp motif
         2 out of 1,937,805 ( 0%)  replaced 10bp motif with a simplified 5bp motif
         1 out of 1,937,805 ( 0%)  replaced 15bp motif with a simplified 5bp motif
Stats for /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/merged_expansion_hunter_catalog.78_samples.json.gz
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz

Stats for merged_expansion_hunter_catalog.78_samples.filtered.json.gz:
       36,737 total loci
    2,323,466 base pairs spanned by all loci (0.075% of the genome)
            0 out of     36,737 (  0.0%) loci define adjacent repeats
       36,737 total repeat intervals
       36,737 out of     36,737 (100.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of     36,737 (  0.0%) repeat intervals are homopolymers
        1,023 out of     36,737 (  2.8%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr2:164160666-164160732, chr6:168850262-168850334, chr15:89663571-89663671, chr2:108551606-108551646, chr21:42653531-42653552, chr11:2938455-2938515, chr2:217093032-217093072, chr9:134848821-134848893, chr7:35044440-35044540, chr13:111440584-111440632

Ranges:
   Motif size range: 7-833bp
   Locus size range: 7-2499bp
   Num repeats range: 1-78x repeats

   Max locus size =   2,499bp           @ chrX:71520430-71522929 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  0.89    @ chr9:137355633-137355668 (AAGGAGA)
   Min fraction pure repeats =  0.08    @ chr11:126065050-126065258 (TAGTATTAAGAGGTGG)

          chrX:      1,608 out of     36,737 (  4.4%) repeat intervals
          chrY:         52 out of     36,737 (  0.1%) repeat intervals
          chrM:          0 out of     36,737 (  0.0%) repeat intervals
   alt contigs:          0 out of     36,737 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of     36,737 (  0.0%) repeat intervals
          2bp:          0 out of     36,737 (  0.0%) repeat intervals
          3bp:          0 out of     36,737 (  0.0%) repeat intervals
          4bp:          0 out of     36,737 (  0.0%) repeat intervals
          5bp:          0 out of     36,737 (  0.0%) repeat intervals
          6bp:          0 out of     36,737 (  0.0%) repeat intervals
       7-24bp:     24,757 out of     36,737 ( 67.4%) repeat intervals
        25+bp:     11,980 out of     36,737 ( 32.6%) repeat intervals

Num repeats in reference:
           1x:      3,491 out of     36,737 (  9.5%) repeat intervals
           2x:     12,792 out of     36,737 ( 34.8%) repeat intervals
           3x:     12,881 out of     36,737 ( 35.1%) repeat intervals
           4x:      3,717 out of     36,737 ( 10.1%) repeat intervals
           5x:      1,542 out of     36,737 (  4.2%) repeat intervals
           6x:        768 out of     36,737 (  2.1%) repeat intervals
           7x:        433 out of     36,737 (  1.2%) repeat intervals
           8x:        299 out of     36,737 (  0.8%) repeat intervals
           9x:        191 out of     36,737 (  0.5%) repeat intervals
       10-15x:        477 out of     36,737 (  1.3%) repeat intervals
       16-25x:        124 out of     36,737 (  0.3%) repeat intervals
       26-35x:         17 out of     36,737 (  0.0%) repeat intervals
       36-50x:          4 out of     36,737 (  0.0%) repeat intervals
         51+x:          1 out of     36,737 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of     36,737 (  0.0%) repeat intervals
          0.1:         12 out of     36,737 (  0.0%) repeat intervals
          0.2:         57 out of     36,737 (  0.2%) repeat intervals
          0.3:        113 out of     36,737 (  0.3%) repeat intervals
          0.4:         82 out of     36,737 (  0.2%) repeat intervals
          0.5:        759 out of     36,737 (  2.1%) repeat intervals
          0.6:      1,473 out of     36,737 (  4.0%) repeat intervals
          0.7:        482 out of     36,737 (  1.3%) repeat intervals
          0.8:        186 out of     36,737 (  0.5%) repeat intervals
          0.9:         11 out of     36,737 (  0.0%) repeat intervals
          1.0:     33,561 out of     36,737 ( 91.4%) repeat intervals

Locus sizes at each motif size:
     7bp motifs: locus size range:      7 bp to     546 bp  (median:   21 bp) based on      4,996 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
     8bp motifs: locus size range:      8 bp to     312 bp  (median:   24 bp) based on      3,579 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  
     9bp motifs: locus size range:      9 bp to     243 bp  (median:   27 bp) based on      1,880 loci. Mean base purity: 0.99, mean repeat purity: 0.95.  
    10bp motifs: locus size range:     10 bp to     260 bp  (median:   30 bp) based on      1,886 loci. Mean base purity: 0.99, mean repeat purity: 0.93.  
    11bp motifs: locus size range:     11 bp to     143 bp  (median:   33 bp) based on        871 loci. Mean base purity: 0.99, mean repeat purity: 0.94.  
    12bp motifs: locus size range:     12 bp to     252 bp  (median:   36 bp) based on      1,435 loci. Mean base purity: 0.99, mean repeat purity: 0.94.  
    13bp motifs: locus size range:     13 bp to     351 bp  (median:   39 bp) based on        598 loci. Mean base purity: 1.00, mean repeat purity: 0.94.  
    14bp motifs: locus size range:     14 bp to     392 bp  (median:   42 bp) based on        790 loci. Mean base purity: 0.99, mean repeat purity: 0.92.  
    15bp motifs: locus size range:     15 bp to     240 bp  (median:   45 bp) based on        865 loci. Mean base purity: 1.00, mean repeat purity: 0.94.  
    16bp motifs: locus size range:     16 bp to     400 bp  (median:   48 bp) based on        988 loci. Mean base purity: 1.00, mean repeat purity: 0.95.  
Wrote 1 rows to merged_expansion_hunter_catalog.78_samples.filtered.catalog_stats.tsv
python3 -u -m str_analysis.merge_loci  --add-source-field  --output-format JSON  --overlapping-loci-action keep-first  --write-merge-stats-tsv  --write-bed-files-with-new-loci  --output-prefix /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.merged  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/illumina_variant_catalog.sorted.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/merged_expansion_hunter_catalog.78_samples.filtered.json.gz
Added 5 out of 5 (100.0%) records from variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz to the output catalog
Added 1,202 out of 1,203 ( 99.9%) records from illumina_variant_catalog.sorted.filtered.json.gz to the output catalog
Wrote 1,202 unique loci from illumina_variant_catalog.sorted.filtered.json.gz to illumina_variant_catalog.sorted.filtered.unique_loci.bed.gz
Added 40,293 out of 40,867 ( 98.6%) records from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to the output catalog
Wrote 40,293 unique loci from hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz to hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.unique_loci.bed.gz
Added 18,176 out of 36,737 ( 49.5%) records from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to the output catalog
Wrote 18,176 unique loci from merged_expansion_hunter_catalog.78_samples.filtered.json.gz to merged_expansion_hunter_catalog.78_samples.filtered.unique_loci.bed.gz
Done writing 59,676 output records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.merged.json.gz
Wrote 4 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.merged.merge_stats.tsv
python3 -u -m str_analysis.annotate_and_filter_str_catalog  --reference-fasta /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --genes-gtf /Users/weisburd/code/tandem-repeat-catalogs/gencode.v46.basic.annotation.gtf.gz  --gene-models-source gencode  --min-motif-size 7  --max-motif-size 1000  --min-interval-size-bp 1  --discard-overlapping-intervals-with-similar-motifs  --output-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.merged.json.gz
Wrote 59,675 records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
python3 << EOF
import gzip, ijson, json

f = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz", "rt")
out = gzip.open("/Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.json.gz", "wt")
out.write("[")
for record in ijson.items(f, "item", use_float=True): 
	out.write(json.dumps({ 
  k: v for k, v in record.items() if k not in {"LocusId", "ReferenceRegion", "VariantType", "LocusStructure"} 
	}, indent=4))
out.write("]")
EOF

cp /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  temp.json.gz
	gunzip -c temp.json.gz | sed 's/variant_catalog_without_offtargets.GRCh38.split.filtered.json.gz/known disease-associated loci/' | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/illumina_variant_catalog.sorted.filtered.json.gz/Illumina catalog of 174k polymorphic loci/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/hg38_repeats.motifs_1_to_1000bp.repeats_3x_and_spans_9bp.filtered.json.gz/perfect repeats in hg38/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	gunzip -c temp.json.gz | sed 's/merged_expansion_hunter_catalog.78_samples.filtered.json.gz/polymorphic TR loci in HPRC assemblies/'  | gzip -c - > temp2.json.gz && mv temp2.json.gz temp.json.gz
	mv temp.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/add_variation_cluster_annotations_to_catalog.py  --verbose  --output-catalog-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz  --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz  --output-variation-clusters-bed-path variation_clusters_v1.hg38.TRGT.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/vcs_merged.bed.gz
Found 727,553 out of 3,147,421 (23.1%) locus IDs in the input catalog were in variation clusters
Found 2,419,868 out of 2,724,345 (88.8%) variation clusters did not change the original locus boundaries by 5 bases or more
Wrote 307,659 out of 2,724,345 (11.3%) variation clusters to variation_clusters_v1.hg38.TRGT.bed.gz
Found 307,659 out of 2,724,345 (11.3%) variation clusters that differed from locus definitions in the input catalog /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
48,777 out of 59,675 (81.7%) loci from /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz are not in variation clusters
Wrote 59,675 out of 59,675 (100.0%) records to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz
mv /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.with_variation_clusters.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_bed --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.bed.gz
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote 59,675 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.bed.gz
Added /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.bed.gz.tbi index
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_trgt_catalog --split-adjacent-repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.TRGT.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote 59,675 rows to /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.TRGT.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_longtr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.LongTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.LongTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_hipstr_format  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.HipSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.HipSTR.bed
python3 -m str_analysis.convert_expansion_hunter_variant_catalog_to_gangstr_spec  /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz  --output-file /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.GangSTR.bed
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Wrote out /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.GangSTR.bed
trgt validate --genome /Users/weisburd/code/tandem-repeat-catalogs/hg38.fa  --repeats /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.TRGT.bed
python3 /Users/weisburd/code/tandem-repeat-catalogs/scripts/validate_catalog.py --known-pathogenic-loci-json-path /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/variant_catalog_without_offtargets.GRCh38.split.json.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
Done. Catalog passed validation.
tar czf simple_repeat_catalog_v1.hg38.subset.only_loci_with_7_to_1000bp_motifs.tar.gz -C /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.bed.gz simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.bed.gz.tbi simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.json.gz simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.TRGT.bed simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.LongTR.bed simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.HipSTR.bed simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.GangSTR.bed
cp simple_repeat_catalog_v1.hg38.subset.only_loci_with_7_to_1000bp_motifs.tar.gz /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/release_draft_2024-08-21
python3 -m str_analysis.compute_catalog_stats --verbose /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz
--------------------------------------------------
Parsing /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz

Stats for simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.json.gz:
       59,675 total loci
    3,679,155 base pairs spanned by all loci (0.119% of the genome)
            0 out of     59,675 (  0.0%) loci define adjacent repeats
       59,675 total repeat intervals
       27,479 out of     59,675 ( 46.0%) repeat interval size is an integer multiple of the motif size (aka. trimmed)
            0 out of     59,675 (  0.0%) repeat intervals are homopolymers
          980 out of     59,675 (  1.6%) repeat intervals overlap each other by at least two motif lengths
Examples of overlapping repeats: chr13:112210052-112210205, chr12:123908064-123908197, chr12:114576491-114576526, chr3:15164180-15164236, chr4:183851840-183851948, chr5:79137371-79137441, chr12:127787796-127787820, chrX:151072779-151072810, chr5:92343249-92343390, chr7:2622525-2622576

Ranges:
   Motif size range: 7-833bp
   Locus size range: 7-2523bp
   Num repeats range: 1-70x repeats

   Max locus size =   2,523bp           @ chrX:71520430-71522953 (CCAGCACTTTGGGAGGCCGAGGCAGGCTGATCACTAGGTCAGGAGTTCAAGACCAGCCTGGCCAACATGGTGAAACCCCCGTCTCTACTAAAAATACAAAAATTACCTGGGTGTGGGGGTGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGGGGAGGCAGGAGAATTGCCTGAACCTGAGAGGCAGAGGCTGCAGTGAGCTGAGATTGTGCCACTGCACTCCAGCCTGGGCGACAGAGTGAGACTCAGTCTCAAAACAAAAAAAAAAAAAGATTTTAGTAACTTTTATCCTGTTTTAATAATACTGACTCAGAAACTATAATGTGTACTTTATAATTTACTTCCTAGATGACACTTGATTTTCTTCAAGAGCAAGATAGCTGCCCTGTGCAGTTGGTCTCCTTGAAAACTATTTTAGTTCTATCATAATTTCCTGTGATAAATATTTTGACCTTCTAAAATTTCAGAATATTGCACCAAGTAGAAAGAAAATAGGTTTTTTCTCTTTTCTTCTTCTTCCTTTTTTTTTTCTGAGAAAGAGGGAATGAGAACTTTAGTGTTCTTTCAATAGCGTTCTTATTTGTAGAAATGCATAATAGTGTCCTAGTAAGGCTTGACAATAACTCTGGTCTTCATCATATTTTGTGATAAAACTTTTGATTTAAAAAAACCTCTGATCTATTTATCATGGCAAATGGATAGAGCTTTCCTGCCTGTTTTCTTTCTTTTCTTTTTTCTTTCTTTCCTTTTTTTTCCTTTGAGCTTAGATTTTTAGAAGCACATATTTAAAAATCAGGTATAAGACTGGATGCAGTGGCTCACGCCTGTAATC)
   Min fraction pure bases   =  0.89    @ chr14:102057705-102057761 (AACACCC)
   Min fraction pure repeats =  0.08    @ chr11:126065050-126065258 (TAGTATTAAGAGGTGG)
   Min overall mappability   =  0.00    @ chrY:3795356-3795382 (CATATATA)

          chrX:      3,320 out of     59,675 (  5.6%) repeat intervals
          chrY:        268 out of     59,675 (  0.4%) repeat intervals
          chrM:          0 out of     59,675 (  0.0%) repeat intervals
   alt contigs:          0 out of     59,675 (  0.0%) repeat intervals

Motif size distribution:
          1bp:          0 out of     59,675 (  0.0%) repeat intervals
          2bp:          0 out of     59,675 (  0.0%) repeat intervals
          3bp:          0 out of     59,675 (  0.0%) repeat intervals
          4bp:          0 out of     59,675 (  0.0%) repeat intervals
          5bp:          0 out of     59,675 (  0.0%) repeat intervals
          6bp:          0 out of     59,675 (  0.0%) repeat intervals
       7-24bp:     43,996 out of     59,675 ( 73.7%) repeat intervals
        25+bp:     15,679 out of     59,675 ( 26.3%) repeat intervals

Num repeats in reference:
           1x:      3,484 out of     59,675 (  5.8%) repeat intervals
           2x:     13,076 out of     59,675 ( 21.9%) repeat intervals
           3x:     33,053 out of     59,675 ( 55.4%) repeat intervals
           4x:      5,385 out of     59,675 (  9.0%) repeat intervals
           5x:      1,963 out of     59,675 (  3.3%) repeat intervals
           6x:        946 out of     59,675 (  1.6%) repeat intervals
           7x:        520 out of     59,675 (  0.9%) repeat intervals
           8x:        342 out of     59,675 (  0.6%) repeat intervals
           9x:        217 out of     59,675 (  0.4%) repeat intervals
       10-15x:        537 out of     59,675 (  0.9%) repeat intervals
       16-25x:        135 out of     59,675 (  0.2%) repeat intervals
       26-35x:         13 out of     59,675 (  0.0%) repeat intervals
       36-50x:          3 out of     59,675 (  0.0%) repeat intervals
         51+x:          1 out of     59,675 (  0.0%) repeat intervals

Fraction pure bases distribution:
          0.0:          1 out of     59,675 (  0.0%) repeat intervals
          0.1:         12 out of     59,675 (  0.0%) repeat intervals
          0.2:         57 out of     59,675 (  0.1%) repeat intervals
          0.3:        110 out of     59,675 (  0.2%) repeat intervals
          0.4:         80 out of     59,675 (  0.1%) repeat intervals
          0.5:        733 out of     59,675 (  1.2%) repeat intervals
          0.6:      1,361 out of     59,675 (  2.3%) repeat intervals
          0.7:        360 out of     59,675 (  0.6%) repeat intervals
          0.8:         55 out of     59,675 (  0.1%) repeat intervals
          0.9:          1 out of     59,675 (  0.0%) repeat intervals
          1.0:     56,905 out of     59,675 ( 95.4%) repeat intervals

Mappability distribution:
          0.0:      5,457 out of     59,675 (  9.1%) loci
          0.1:      5,128 out of     59,675 (  8.6%) loci
          0.2:      5,505 out of     59,675 (  9.2%) loci
          0.3:      5,975 out of     59,675 ( 10.0%) loci
          0.4:      7,299 out of     59,675 ( 12.2%) loci
          0.5:      7,508 out of     59,675 ( 12.6%) loci
          0.6:      5,074 out of     59,675 (  8.5%) loci
          0.7:      4,198 out of     59,675 (  7.0%) loci
          0.8:      4,094 out of     59,675 (  6.9%) loci
          0.9:      4,921 out of     59,675 (  8.2%) loci
          1.0:      4,516 out of     59,675 (  7.6%) loci

Locus sizes at each motif size:
     7bp motifs: locus size range:      7 bp to     151 bp  (median:   22 bp) based on     15,083 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.58
     8bp motifs: locus size range:      8 bp to     312 bp  (median:   25 bp) based on      7,107 loci. Mean base purity: 1.00, mean repeat purity: 0.99.  Mean mappability: 0.57
     9bp motifs: locus size range:      9 bp to     153 bp  (median:   28 bp) based on      3,231 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  Mean mappability: 0.51
    10bp motifs: locus size range:     10 bp to     150 bp  (median:   31 bp) based on      2,713 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.50
    11bp motifs: locus size range:     11 bp to     121 bp  (median:   33 bp) based on      1,226 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.55
    12bp motifs: locus size range:     12 bp to     252 bp  (median:   37 bp) based on      1,965 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.49
    13bp motifs: locus size range:     13 bp to     358 bp  (median:   40 bp) based on        839 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.48
    14bp motifs: locus size range:     14 bp to     234 bp  (median:   43 bp) based on      1,045 loci. Mean base purity: 1.00, mean repeat purity: 0.94.  Mean mappability: 0.51
    15bp motifs: locus size range:     15 bp to     331 bp  (median:   46 bp) based on      1,152 loci. Mean base purity: 1.00, mean repeat purity: 0.96.  Mean mappability: 0.50
    16bp motifs: locus size range:     16 bp to     400 bp  (median:   50 bp) based on      1,269 loci. Mean base purity: 1.00, mean repeat purity: 0.97.  Mean mappability: 0.56
Wrote 1 rows to simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs.EH.with_annotations.catalog_stats.tsv
Done generating /Users/weisburd/code/tandem-repeat-catalogs/results__2024-08-21/7_to_1000bp_motifs/simple_repeat_catalog_v1.hg38.7_to_1000bp_motifs catalog. Took 2h, 41m, 27s
